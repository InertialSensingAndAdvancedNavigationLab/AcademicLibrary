## **Unscented Kalman Filtering on Manifolds for AUV Navigation -** **Experimental Results**

Stephen T. Krauss [1] and Daniel J. Stilwell [1]



_**Abstract**_ **— In this work, we present an aided inertial naviga-**
**tion system for an autonomous underwater vehicle (AUV) using**
**an unscented Kalman filter on manifolds (UKF-M). The inertial**
**navigation estimate is aided by a Doppler velocity log (DVL),**
**depth sensor, acoustic range and, while on the surface, GPS. The**
**sensor model for each navigation sensor on the AUV is explicitly**
**described, including compensation for lever arm offsets between**
**the IMU and each sensor. Additionally, an outlier rejection step**
**is proposed to reject measurement outliers that would degrade**
**navigation performance. The UKF-M for AUV navigation is**
**implemented for real-time navigation on the Virginia Tech 690**
**AUV and validated in the field. Finally, by post-processing the**
**navigation sensor data, we show experimentally that the UKF-**
**M is able to converge to the correct heading in the presence of**
**arbitrarily large initial heading error.**


I. I NTRODUCTION


For an autonomous underwater vehicle (AUV) without
access to GPS signals while under water, inertial navigation
is one of the main sources of localization information.

The basic premise behind inertial navigation is that a vehicle equipped with an inertial measurement unit (IMU)
can integrate measurements of angular velocity and linear
acceleration into estimates of attitude, velocity, and position.
However, it is well known that integration of small sensor
errors over time causes a buildup of error in the inertial
navigation estimates [1]. In order to correct the buildup of
error, a Kalman filter is commonly used to combine IMU
measurements with measurements from other sensors on

an AUV, such as a Doppler velocity log (DVL) and depth
sensor. While the extended Kalman filter (EKF) is one of the
most commonly used filters, other works have demonstrated
advantages to using other variants of the Kalman filter, such
as the unscented Kalman filter (UKF).
In this work, we expand upon the work done in [2], where
the authors propose the use of an unscented Kalman filter on
manifolds (UKF-M) for AUV navigation. First, we explicitly
describe the sensor models used in the measurement update
step of the UKF-M and include compensation for lever arm
effects caused by the mounting locations of the sensors on
the AUV. Next, we propose UKF-M retraction and inverse
retraction functions that allow position standard deviation to
be reported in meters instead of radians. Additionally, we
introduce a measurement validation algorithm to the UKFM measurement update step in order to reject measurement
outliers that would otherwise affect navigation accuracy.
Finally, we validate a real-time implementation of the filter in


1 Bradley Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University, Blacksburg, VA, USA
_{_ stkrauss, stilwell _}_ @vt.edu



the field using the Virginia Tech 690 AUV, shown in Figure
1, with a mission consisting of surface calibration maneuvers
and a survey pattern. Post processing of the dataset is used
to demonstrate the ability of the UKF-M to converge in
the presence of large initial heading errors. Convergence
despite large initial heading errors allows the filter to operate
without the need for a separate filter for determining initial
conditions.


Fig. 1. Virginia Tech 690 AUV aboard the Virginia Tech research vessel
in Claytor Lake, Dublin, VA, USA.


The remainder of this work is organized as follows. In
Section II, previous works related to this work are summarized. In Section III, we introduce the coordinate frames and
inertial navigation equations used in this work. In Section
IV, we present the sensor models for the navigation sensors
on the 690 AUV. In Section V, a summary of the unscented
Kalman filter on manifolds is given, and in Section VI, a
simple measurement outlier rejection algorithm for the filter’s
measurement update step is presented. Finally, in Section
VII, results from a real-time implementation of the filter
tested in the field with the Virginia Tech 690 AUV are given.


II. R ELATED W ORK


One of the most common approaches to reducing or
bounding the buildup of inertial navigation error is to incorporate measurements from other sensors through an extended
Kalman filter (EKF), such as those presented in [1], [3],

[4] and [5]. One of the disadvantages of the EKF is that
it requires linearization of the inertial navigation dynamics,
which reduces accuracy of the estimate of the state and
its covariance. Additionally, due to the linearization of the
inertial navigation equations, the EKF can be susceptible to


divergence if the initial state estimate is not close to the true
initial state.

The most common way this problem arises is through
initialization of the heading angle. In order to provide
an accurate initial heading angle to the EKF, a two-step
approach consisting of coarse alignment followed by fine
alignment is commonly used [4]. Other approaches to the
handling of large heading error with an EKF include [6],
where an EKF model that can handle large initial alignment
errors is developed. This approach still uses an EKF, which
requires linearization, and must also switch to a different
inertial navigation model when alignment error is reduced
below a certain level, much like the coarse and fine alignment
approach. In this work, use of the UKF-M allows for filter
convergence in the presence of large initial heading error
without any special modifications to the filter or system
model.

Other variations of the Kalman filter have been proposed
in the literature for nonlinear filtering, such as the unscented
Kalman filter (UKF) [7]. Instead of linearizing the state
propagation and measurement equations, the UKF uses a set
of points, named sigma points, distributed such that their
empirical mean and covariance estimate the state mean and
covariance. These sigma points are propagated through the
nonlinear equations in the prediction and update steps. In
this way, the UKF can be accurate to a higher order than
the EKF and does not require linearization of the inertial
navigation equations. Approaches to using the UKF for aided
inertial navigation system have been explored in works such
as [8], [9], and [10]. However, implementation challenges
exist when using the UKF for inertial navigation. If vehicle
roll, pitch, and heading are represented in the state vector as
Euler angles, the algorithm must compensate for the fact that
0 degrees and 360 degrees are equivalent. When propagating
sigma points through the inertial navigation equations, one or
more of the sigma points may wrap, leading to an inaccurate
representation of the state mean and covariance.
The unscented Kalman filter on manifolds (UKF-M),
proposed in [11], is a modification of the UKF that is able
to directly handle states that evolve on the manifold _SO_ (3),
such as vehicle attitude. With vehicle attitude represented by
an rotation matrix in _SO_ (3), the effect of wrapping of Euler
angles on sigma points can be avoided. In [2], the authors
present an inertial navigation algorithm for AUVs based on
the UKF-M. The authors demonstrate the ability of the filter
to accurately estimate the state covariance through MonteCarlo simulations and show that the filter can run in real
time on an AUV. In this work, we build upon the results in

[2] by using the UKF-M for inertial navigation using sensor
models with lever arm compensation and validating a the
filter in real time with data from an AUV survey mission.


III. I NERTIAL N AVIGATION E QUATIONS


We adopt the notation and navigation frame inertial navigation formulations presented in [4]. The inertial navigation
equations involve three reference frames: the Earth-centered



where **C** _[n]_ _b_ [is the rotation matrix from the body frame to]
the navigation frame, **v** _[n]_ _eb_ [is the velocity of the body frame]
relative to the ECEF frame, expressed in the navigation



Earth-fixed (ECEF) frame, the body frame, and the navigation frame.

The origin of the Earth-centered Earth-fixed (ECEF) reference frame is attached to the geometric center of the Earth.
The positive _z_ -axis of the ECEF reference frame is aligned
with the Earth’s axis of rotation and passes through the north
pole. The positive _x_ -axis passes through the intersection of
the equator and the prime-meridian. The _y_ -axis completes
a right-handed coordinate system [1]. Note that, since the
ECEF frame is fixed to the earth, it is rotating with respect
to an inertial frame [3]. Values expressed in this frame are
indicated with an _e_ .

The origin of the body frame is fixed to a point on the
AUV with the positive _x_ -axis passing through the nose of
the AUV, the positive _z_ -axis pointing down, and the _y_ -axis
completing a right-handed coordinate system. In this work,
the body frame is taken to be the IMU measurement frame.
Values expressed in the body frame are denoted with _b_ .
The navigation frame is a coordinate frame that is tangent
to the earth’s surface with an origin co-located with the origin
of the body frame. The navigation frame’s north direction
points toward true north, the down direction points toward
the earth’s center perpendicular to the tangent plane, and the
east direction points east orthogonal to the north and down
directions. Values in the navigation frame are notated with

an _n_ .


Fig. 2. Illustration of the inertial navigation reference frames at a moment
in time. The navigation frame origin is fixed to the body frame origin with
position described by its geodetic latitude ( _L_ _b_ ) and longitude ( _λ_ _b_ ).


The nonlinear kinematic equations that relate attitude,
velocity, and position of the body frame to angular velocity
and linear acceleration of the body frame are



**C** ˙ _nb_ [=] **[ C]** _[n]_ _b_ **[Ω]** _[b]_ _ib_ _[−]_ [(] **[Ω]** _[n]_ _ie_ [+] **[ Ω]** _[n]_ _en_ [)] **[C]** _[n]_ _b_
**v** ˙ _[n]_ _eb_ [=] **[ f]** _[ n]_ _ib_ [+] **[ g]** _[n]_ _b_ _[−]_ [(] **[Ω]** _[n]_ _en_ [+ 2] **[Ω]** _[n]_ _ie_ [)] **[v]** _[n]_ _eb_
**p** ˙ _b_ = **T** _[p]_ _r_ ( _n_ ) **[v]** _eb_ _[n]_



(1)


frame, and **p** _b_ is the curvilinear position of the body frame.
The navigation frame velocity and position are expressed

**v** _[n]_ _eb_ [=] � _v_ _eb,Nn_ _v_ _eb,E_ _[n]_ _v_ _eb,D_ _[n]_ � _T_

_T_ (2)
**p** _b_ = � _L_ _b_ _λ_ _b_ _h_ _b_ �


The map of a distance in a curvilinear frame (latitude,
longitude, and altitude) to a Cartesian frame (North, East,
Down) is represented by the transformation matrix



where **l** _[b]_ _bS_ [is the lever arm from the body frame to the sensor]
frame, _**ω**_ _[b]_ _eb_ [is the angular velocity of the body frame relative]
to the earth, and _∧_ is the cross product. Since _**ω**_ _[b]_ _eb_ [is not]
instrumented directly, it must be calculated from the IMU
measurement of _**ω**_ _[b]_ _ib_ [using]



_**ω**_ _[S]_ _eS_ [=] _**[ ω]**_ _[b]_ _eb_
= _**ω**_ _[b]_ _ib_ _[−]_ _**[ω]**_ _[b]_ _ie_
= _**ω**_ _[b]_ _ib_ _[−]_ **[C]** _[b]_ _n_ _**[ω]**_ _[n]_ _ie_



(7)



1 0 0
_R_ _N_ + _h_ _b_
0 1 0
( _R_ _N_ + _h_ _b_ ) cos( _L_ _b_ )
0 0 _−_ 1







(3)




**T** _[p]_
_r_ ( _n_ ) [=]









where _**ω**_ _[n]_ _ie_ [is given by (4).]
The following subsections describe the measurement
model for each navigation sensor on the Virginia Tech 690
AUV.


_A. Inertial Measurement Unit_
Measurements of angular velocity ˜ _**ω**_ _[b]_ _ib_ [and linear accelera-]
tion [˜] **f** _bib_ [of the body frame relative to the inertial frame from]
the IMU are modeled with a constant bias and sensor noise

as follows:

_**ω**_ ˜ _[b]_ _ib_ [=] _**[ ω]**_ _[b]_ _ib_ [+] **[ b]** _[g]_ [+] _**[ η]**_ _g_
˜ _b_ (8)
**f** _ib_ [=] **[ f]** _[ b]_ _ib_ [+] **[ b]** _[a]_ [+] _**[ η]**_ _a_


where **b** _g_ _,_ **b** _a_ _∈_ R [3] _[×]_ [1] are gyroscope and accelerometer bias
states, respectively, and

_**η**_ _g_ _∼N_ ( **0** _, σ_ _g_ [2] **[I]** [3] [)]

(9)
_**η**_ _a_ _∼N_ ( **0** _, σ_ _a_ [2] **[I]** [3] [)]


are gyroscope and accelerometer measurement noise. The
gyroscope and accelerometer measurement noise covariance
were measured to be
_σ_ _g_ [2] [= 8] _[.]_ [4616] _[ ×]_ [ 10] _[−]_ [10] [ rad] [2] [ s] _[−]_ [2] (10)

_σ_ _a_ [2] [= 6] _[.]_ [1549] _[ ×]_ [ 10] _[−]_ [5] [ m] [2] [ s] _[−]_ [4]


for the fiber-optic gyroscope (FOG) IMU in the 690 AUV.


_B. Doppler Velocity Log_
The DVL provides measurements ˜ **v** _[S]_ _eS_ [of the linear ve-]
locity of its sensor frame _S_ relative to the earth. Assuming
the DVL sensor frame axes are aligned with the body frame
axes, the DVL sensor frame measurement is modeled


**v** ˜ _[S]_ _eS_ [=] **[ v]** _[S]_ _eS_ [+] _**[ η]**_ _v_ (11)


The DVL sensor noise _**η**_ _v_ is modeled _**η**_ _v_ _∼N_ ( **0** _, σ_ _v_ [2] **[I]** [3] [)][ with]
_σ_ _v_ [2] [= 0] _[.]_ [0001 m] [2] [ s] _[−]_ [2] [.]


_C. Depth Sensor_

A depth sensor measures the vertical distance from the
surface of the water to the sensor frame of the depth sensor.
To get the depth of the body frame, the lever arm from the
body frame to the sensor frame of the depth sensor must be
used. The depth measured by the depth sensor, _d_ [˜], is


˜
_d_ = _h_ _sea_ _−_ _h_ _S_ + _η_ _d_ (12)


where _h_ _sea_ is the altitude of the water’s surface and _η_ _d_ is
depth sensor noise distributed as _η_ _d_ _∼N_ (0 _, σ_ _d_ [2] [)][ with] _[ σ]_ _d_ [2] [=]
7 _._ 0 _×_ 10 _[−]_ [5] m [2] for the depth sensor on the 690 AUV measured
experimentally.



The rotation rate of the earth expressed in the navigation
frame is


_**ω**_ _[n]_ _ie_ [=] � _ω_ _ie_ cos( _L_ _b_ ) 0 _−ω_ _ie_ sin( _L_ _b_ ) [�] _[T]_ (4)


where the rotation rate of the earth around its axis is _ω_ _ie_ =
7 _._ 292115 _×_ 10 _[−]_ [5] rad s _[−]_ [1] . The transport rate is



_**ω**_ _[n]_ _en_ [=] � _Rv_ _Eeb_ _[n]_ + _,E_ _h_ _b_



_T_

_v_ _eb_ _[n]_ _,N_ _−_ _v_ _eb_ _[n]_ _,E_ [tan(] _[L]_ _[b]_ [)]
_R_ _N_ + _h_ _b_ _R_ _E_ + _h_ _b_ � (5)



Integration of discrete IMU measurements into estimates of
vehicle attitude, velocity, and position require discrete-time
approximations of (1). Detailed derivations of the discretetime expressions are given in [4] and are not included here
for brevity.


IV. S ENSOR M ODELS


In this section, we present the sensor models used for each
of the navigation sensors on the 690 AUV. Without loss of
generality, the vehicle body frame is taken to be the same
as the IMU sensor frame. Each additional sensor, located at
different points across the AUV, has its own sensor frame
denoted with an _S_ in variable subscripts and superscripts.
Because the sensor frames are not co-located with the body
frame, the lever arms between the body frame and the sensor
frames must be accounted for. The lever arms for each sensor

on the 690 AUV are shown in Figure 3. The corresponding
value for each lever arm is given in Table I.


TABLE I


L EVER ARMS FROM BODY FRAME TO SENSOR FRAMES .


_x_ _bS_ ( _m_ ) _y_ _bS_ ( _m_ ) _z_ _bS_ ( _m_ )
**l** _[b]_ 0.0984 0 0.0548
_bS,DV L_

**l** _[b]_ -1.4192 -0.0254 -0.0156
_bS,Depth_

**l** _[b]_ -0.0811 0 0.1678
_bS,Range_

**l** _[b]_ -1.2934 0 -0.1926
_bS,GP S_


These lever arms are used in each sensor’s measurement

model to account for the position and velocity effects of the
offset sensor frame. The sensor frame velocity and position,
accounting for the lever arm between the body frame and
the sensor frame, are

**p** _S_ = � _L_ _S_ _λ_ _S_ _h_ _S_ � _T_ = **p** _b_ + **T** _pr_ ( _n_ ) **[C]** _b_ _[n]_ **[l]** _[b]_ _bS_

_S_ _T_ _b_ (6)
**v** _[S]_ _eS_ [=] � **v** _eS,x_ **v** _[S]_ _eS,y_ **v** _[S]_ _eS,z_ � = **v** _eb_ [+] _**[ ω]**_ _[b]_ _eb_ _[∧]_ **[l]** _[b]_ _bS_


_D. GPS Receiver_



Fig. 3. Lever arms for the navigation sensors in the 690 AUV.


the states that we wish to estimate are



The 690 AUV is equipped with an antenna mast that
includes a GPS antenna and a corresponding GPS receiver
within the vehicle. The origin of the GPS frame is centered at
the GPS antenna. The GPS position measurement is modeled
with measurement noise as


**p** ˜ _S_ = **p** _S_ + _**η**_ _p_ (13)


where _**η**_ _p_ _∼N_ ( **0** _,_ ( _σ_ _d_ [2] [[] **[T]** _[p]_ _r_ ( _n_ ) []] [2] [)][ is GPS position measure-]
ment noise with _σ_ _d_ [2] [= 6] _[.]_ [25 m] [2] [ for the GPS receiver on the]
690 AUV.


_E. Acoustic Ranging_


The 690 AUV and support vessel are both equipped with
an acoustic modem capable of one-way travel time (OWTT)
acoustic ranging. The AUV periodically receives acoustic
messages from the research vessel that contain the time-ofdeparture of the message and the research vessel transducer’s
GPS location. When this message is received by the AUV,
the time-of-arrival is recorded and the total time-of-flight is
calculated. From the time of flight and the speed of sound
in water, the range from the research vessel to the AUV can
be calculated.

The acoustic range measurement is modeled as the Euclidean distance, expressed in geodetic coordinates, between
the acoustic transducer sensor frame position, **p** _S_, and the
research vessel transducer position embedded in the acoustic

message, **p** _t_ .


_r_ ˜ = _||_ **T** _[p]_ _r_ ( _n_ ) [(] **[p]** _[t]_ _[−]_ **[p]** _[S]_ [)] _[||]_ [ +] _[ η]_ _[r]_ (14)


where the sensor frame position is calculated using (6) and
_η_ _r_ _∼N_ (0 _, σ_ _r_ [2] [)][ with] _[ σ]_ _r_ [2] [= 1] _[.]_ [0 m] [2] [.]


V. U NSCENTED K ALMAN F ILTER ON M ANIFOLDS


The unscented Kalman Filter on manifolds (UKF-M) is a
modification to the UKF that is able to estimate the mean
and covariance of a state that evolves on a Lie group [11].
This is particularly useful for estimation of vehicle attitude
which is described by the Lie group _SO_ (3). In this work,



ˆ _b_
**C** _n_ _[∈]_ _[SO]_ [(3)]

**v** ˆ _[n]_ _eb_ _[∈]_ [R] [3]

**p** ˆ _b_ _∈_ R [3]

**b** ˆ _g_ _∈_ R [3]

**b** ˆ _a_ _∈_ R [3]



(15)



which form the combined state ˆ **x** _∈_ _SO_ (3) _×_ R [12] . Implementation of the UKF-M requires a definition of a retraction
_ϕ_ that maps uncertainty in the tangent space to the manifold,
and its inverse _ϕ_ _[−]_ [1] . Following the example presented in [11]
for the mixed case where some states evolve in _SO_ (3) and
others do not, we choose the retraction






(16)




_ϕ_ ( **x** _,_ _**ξ**_ ) =



exp( _**ξ**_ 1:3 ) **C** _[n]_ _b_

 **v** _[n]_ _eb_ [+] _**[ ξ]**_ 4:6

**p** _b_ + **T** _[p]_ _r_ ( _n_ ) _**[ξ]**_ [7:9]
**b** _g_ + _**ξ**_ 10:12

 **b** _a_ + _**ξ**_ 13:15



and the corresponding inverse retraction







_ϕ_ _[−]_ [1] ( **x** _,_ ˆ **x** ) =









_n_
log( **C** [ˆ] _b_ [(] **[C]** _[n]_ _b_ [)] _[T]_ [ )]
**v** ˆ _[n]_ _eb_ _[−]_ **[v]** _[n]_ _eb_
**T** _[r]_ _p_ [(] **b** _[n]_ **b** ˆˆ [)] _ag_ (ˆ _− −_ **p** _b_ _−_ **bb** _ag_ **p** _b_ )



(17)




where exp and log are the exponential and logarithm functions on _SO_ (3) defined in [12] and _**ξ**_ _a_ : _b_ is a vector made of
the _a_ th to the _b_ th element of _**ξ**_ . The map **T** _[p]_ _r_ ( _n_ ) [of a distance]
in a Cartesian frame to a curvilinear frame, the inverse of
(3), is given by





(18)




**T** _[r]_ [(] _[n]_ [)] =
_p_



_R_ _N_ + _h_ _b_ 0 0

 0 ( _R_ _N_ + _h_ _b_ ) cos( _L_ _b_ ) 0

0 0 _−_ 1




These retraction and inverse retraction functions are the

based on those chosen in [11], with two modifications.
The first modification is the addition of the terms for the
gyroscope and accelerometer bias states. Second, the terms
in _ϕ_ and _ϕ_ _[−]_ [1] corresponding to the position state include the
transformations between curvilinear and Cartesian distance.

The addition of the transformations changes the position
covariance estimated by the filter to be in units of meters


squared with a standard deviation in meters, which is more
useful for a human operator.
The prediction step of the UKF-M is driven by the
arrival of IMU measurements of angular velocity and linear
acceleration of the body frame relative to the inertial frame.
For each measurement received from the IMU, the UKF-M
prediction step is executed where the nonlinear model _f_ is
the entire IMU measurement integration process from Section III. When measurements from the other aiding sensors
described in Section IV are received, the UKF-M update step
is executed to correct the inertial navigation state estimate.


VI. O UTLIER R EJECTION


Some sensors used for AUV navigation are susceptible
to erroneous measurement outliers that can significantly
degrade the navigation estimate if they are used to update
the filter state. Measurements involving acoustic signals are
particularly prone to these outliers due to multipath and other
effects that can cause measurement errors. Figure 4 shows
an example of DVL measurements during a portion of an
AUV mission. These outliers deviate significantly from the
mean velocity values of about 1.6 m/s for the x-axis and 0
m/s for the y- and z-axis.


Fig. 4. Outliers in DVL measurements during an AUV mission.


A simple approach to rejecting these outliers is described
in [13] and [14], which uses the measurement innovation

and a chosen threshold to decide whether the measurement

should be used. A measurement with


_|δ_ **z** _[−]_ _k_ _[|][ > T]_ _[r]_ (19)


where _δ_ **z** _[−]_ _k_ [is the measurement innovation and] _[ T]_ _[r]_ [ is the]
threshold, is rejected. The measurement innovation is already
calculated in the UKF-M update step for every measurement, requiring minimal extra computations to implement
this outlier rejection. However, a threshold must be chosen
high enough that legitimate measurements are used and low
enough that outliers are rejected. In this work, we formulate a
threshold based on the measurement covariance, **P** _yy_, which
is also calculated during the UKF-M update step:



_T_ _r_ = _M_
�



_||_ diag( **P** _yy_ ) _||_ (20)



sensitivity to outliers and probability of rejecting a legitimate

measurement.


VII. E XPERIMENTAL R ESULTS


In order to validate the UKF-M for AUV aided inertial

navigation with real data, the UKF-M presented in this work
was implemented on the Virginia Tech 690 AUV’s ROSbased vehicle control software framework in order to run in

real time. In addition, the navigation algorithm implementation also records all navigation sensor data for post-mission
analysis and post-processing. The Virginia Tech 690 AUV
and research vessel were deployed in Claytor Lake, Dublin,
Virginia, USA. The UKF-M state vector was initialized to all
zeros except for position, which was initialized to the first
GPS measurement received.

The AUV was commanded to execute a mission consisting
of a 30 minute figure-eight alignment maneuver on the
surface with access to GPS followed by a survey pattern at a
depth of 3 meters for approximately one hour with no GPS.
The survey pattern consisted of 9 swaths of one kilometer
length spaced 50 meters apart. The UKF-M estimate position,
GPS measurements, and research vessel position during the
AUV mission are pictured in Figure 5 where latitude and
longitude have been converted to NED position with origin
latitude and longitude at the mission start position.
During the AUV mission, the research vessel drifted
slowly within the survey area, broadcasting an acoustic ranging packet every 15 seconds. Approximately 45% of these
acoustic packets were received by the AUV and successfully
used for an acoustic range measurement in the UKF-M
measurement update step.


Fig. 5. Maneuvers executed by the 690 AUV at Claytor Lake consisting of
30 minutes of figure eight on the surface and 1 hour of lawnmower survey.
Dashed lines represent an acoustic range measurement from the research
vessel to the AUV.


The error between the UKF-M position estimate and the
first GPS measurement acquired upon resurfacing at the
end of the mission was approximately 6.64 meters. For a



where diag( **P** _yy_ ) is a vector of the diagonal elements of
**P** _yy_ and _M_ is a multiplier used to increase or decrease
the threshold. The tuning of _M_ presents a trade-off between


distance traveled of 9400 meters, this corresponds to an
error of 0.071% of distance traveled. It should be noted that,
while this error value indicates that the filter can achieve
high accuracy, it is not a statistical characterization of the
performance of the navigation system, which is beyond the
scope of this work.
To demonstrate the ability of the UKF-M to handle large
initial heading errors, the sensor data collected during the
mission was post-processed multiple times through the same
UKF-M with the initial heading angle set to a range of
heading angles from 0 degrees to 360 degrees in 30 degree
increments.


Fig. 6. Convergence in heading for a 360 degree range in initial heading
angles.


Figure 6 shows the UKF-M estimated heading angle over
the duration of the figure-eight surface alignment maneuver
for each initial heading angle case. In each case, the estimated heading converges to the same value over the course of
the alignment maneuver. However, Figure 6 also shows that
the initial heading angle can affect the amount of alignment
time required for heading to converge.


Fig. 7. Rejection of outliers in DVL measurements during an AUV mission.
Rejected measurements are marked with a red x.


In Figure 7, the rejection of DVL measurement outliers via the technique described in Section VI is shown.
Measurements that deviate significantly from the expected
velocity measurement are rejected, indicated by a red x on
the measurement. As a result, the vehicle velocity estimated
by the UKF-M is not affected by the outliers.


VIII. C ONCLUSION


In this work, we present an implementation of the UKF-M
for localization of an AUV with sensor measurement models

specifically accounting for sensor lever arms and IMU bias



terms. A real-time implementation of the proposed UKF-M
was validated in the field using the Virginia Tech 690 AUV.
The experimental results in Section VII demonstrate the
ability of the UKF-M to handle estimation of a combination
of states that evolve in _SO_ (3) and those that evolve in
R [3] . An additional measurement validation step added to
the filter’s measurement update step facilitates the rejection
of measurement outliers that would otherwise impact the
navigation state estimate.
Additionally, we experimentally demonstrate the ability
of the filter heading estimate to converge despite arbitrary
initial heading error. The ability to handle large initial
alignment alleviates the need for separate coarse and fine
alignment steps that are common when using an EKF for
inertial navigation. In the experiments presented in this work,
alignment is done by executing maneuvers on the surface
while the UKF-M is running. Analysis of how different sets
of sensors and maneuvers affect the speed and accuracy of
alignment is the subject of future work.


R EFERENCES


[1] D. H. Titterton and J. L. Weston, _Strapdown Inertial Navigation Tech-_
_nology (Iee Radar, Sonar, Navigation and Avionics, No 5)_ . Institution
of Engineering & Technology, 1997.

[2] T. Cantelobre, C. Chahbazian, A. Croux, and S. Bonnabel, “A realtime unscented kalman filter on manifolds for challenging AUV
navigation,” in _2020 IEEE/RSJ International Conference on Intelligent_
_Robots and Systems (IROS)_, pp. 2309–2316, 2020.

[3] J. Farrell and M. Barth, _The Global Positioning System & Inertial_
_Navigation_ . McGraw-Hill Professional, 1998.

[4] P. Groves, _Principles of GNSS, Inertial, and Multisensor Integrated_
_Navigation Systems, Second Edition_ . 2013.

[5] P. A. Miller, J. A. Farrell, Y. Zhao, and V. Djapic, “Autonomous
underwater vehicle navigation,” _IEEE Journal of Oceanic Engineering_,
vol. 35, no. 3, pp. 663–678, 2010.

[6] X. Kong, E. Nebot, and H. Durrant-Whyte, “Development of a
nonlinear psi-angle model for large misalignment errors and its
application in INS alignment and calibration,” in _Proceedings 1999_
_IEEE International Conference on Robotics and Automation (Cat._
_No.99CH36288C)_, vol. 2, pp. 1430–1435 vol.2, 1999.

[7] E. A. Wan and R. Van Der Merwe, “The unscented kalman filter for
nonlinear estimation,” in _Proceedings of the IEEE 2000 Adaptive Sys-_
_tems for Signal Processing, Communications, and Control Symposium_
_(Cat. No. 00EX373)_, pp. 153–158, Ieee, 2000.

[8] E.-H. Shin and N. El-Sheimy, “An unscented kalman filter for inmotion alignment of low-cost IMUs,” in _PLANS 2004. Position_
_Location and Navigation Symposium (IEEE Cat. No. 04CH37556)_,
pp. 273–279, IEEE, 2004.

[9] M. Barisic, A. Vasilijevic, and D. Nad, “Sigma-point unscented
kalman filter used for AUV navigation,” in _2012 20th Mediterranean_
_Conference on Control & Automation (MED)_, pp. 1365–1372, IEEE,
2012.

[10] B. Allotta, A. Caiti, R. Costanzi, F. Fanelli, D. Fenucci, E. Meli,
and A. Ridolfi, “A new AUV navigation system exploiting unscented
kalman filter,” _Ocean Engineering_, vol. 113, pp. 121–132, 2016.

[11] M. Brossard, A. Barrau, and S. Bonnabel, “A code for unscented
kalman filtering on manifolds (UKF-M),” in _2020 IEEE International_
_Conference on Robotics and Automation (ICRA)_, pp. 5701–5708,
2020.

[12] T. D. Barfoot, _State Estimation for Robotics_ . Cambridge University
Press, 2017.

[13] S. T. Krauss, D. J. Stilwell, M. L. Psiaki, and K. G. Vamvoudakis,
“Detection of a drifting acoustic transponder by an AUV,” in _Global_
_Oceans 2020: Singapore–US Gulf Coast_, pp. 1–5, IEEE, 2020.

[14] R. S. Jabari and D. J. Stilwell, “Range-based AUV navigation
expressed in geodetic coordinates,” in _OCEANS 2016 MTS/IEEE_
_Monterey_, pp. 1–8, IEEE, 2016.


