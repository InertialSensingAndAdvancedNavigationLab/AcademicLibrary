1


## UAV attitude estimation using Unscented Kalman Filter and TRIAD

Hector Garcia de Marina, _Student, IEEE,_ Fernando J. Pereda, Jose M. Giron-Sierra, _Member, IEEE,_ and
Felipe Espinosa, _Member, IEEE,_



_**Abstract**_ **— A main problem in autonomous vehicles in general,**
**and in Unmanned Aerial Vehicles (UAVs) in particular, is the**
**determination of the attitude angles. A novel method to estimate**
**these angles using off-the-shelf components is presented. This**
**paper introduces an Attitude Heading Reference System (AHRS)**
**based on the Unscented Kalman Filter (UKF) using the Three**
**Axis Attitude Determination (TRIAD) algorithm as the observa-**
**tion model. The performance of the method is assessed through**
**simulations and compared to an AHRS based on the Extended**
**Kalman Filter (EKF). The paper presents field experiment results**
**using a real fixed-wing UAV. The results show good real-time**
**performance with low computational cost in a microcontroller.**


_**Index Terms**_ **— Attitude Heading Reference System (AHRS),**
**Unscented Kalman Filter (UKF), Extended Kalman Filter (EKF),**
**Unmanned Aerial Vehicle (UAV), Three Axis Attitude Determi-**
**nation (TRIAD).**


I. I NTRODUCTION
# T HERE is growing interest in autonomous vehicles. Thesevehicles are suitable for mobile missions, specially in

vigilance, monitoring and inspection scenarios [1], [2]. Be it
ground, marine or aerial, controlling an autonomous vehicle
needs some knowledge on its attitude angles [3]–[5]. These
angles can be measured in different ways, for instance, using a conventional Inertial Navigation System (INS). Modern MicroElectroMechanical systems (MEMS) technologies
are offering light and moderate cost solutions, denoted as
Inertial Measurement Units (IMUs), which are appropriate for
lightweight Unmanned Aerial Vehicles (UAVs).
Our research group is involved in the development of
UAVs relying on experimentation through a spiral life cycle
development based on prototypes. An on-board hardware and
software have been designed for these UAVs. The hardware
includes an IMU with three-axis accelerometers, gyrometers
and magnetometers; a Global Position System (GPS) receiver
is also included. The system is light and small enough to fly
on a small fixed-wing UAV.
The first flights, using manual control, have been used to
gather signals from the sensors. We are looking at closing
autonomous control loops, which needs an accurate estimation
of the three attitude angles. The signals from the sensors
have lots of vibrations due to the mechanical nature of the

system and noise with bias due to the sensors themselves and
environmental effects. The common solution in the literature

is to use a kind of Kalman filter.
Conventional kinematic models of flying vehicles are highly
non-linear; the filter should be able to cope with these nonlinearities. A typical Kalman filter for non-linear systems is



the Extended Kalman Filter (EKF). Using our experimental
signals the performance of the EKF was not completely
satisfactory. Sometimes estimation errors are too high and
sometimes the filter may diverge. This is inappropriate for
control loops [6].
Searching for a better alternative we selected the Unscented
Kalman Filter (UKF) as a potentially better solution. While
the EKF is based on the linearization of the model through
Jacobians or Hessians, the UKF uses the non-linear model
directly; therefore the predictions should be more accurate.
The nine terms of the Direct Cosine Matrix (DCM) can
be measured by using the Three Axis Attitude Determination
(TRIAD) algorithm and data from on-board sensors: accelerometers and magnetometers. Using a quaternion formulation,
which is a conventional way to deal with the attitude of
aerial vehicles [7], the DCM terms can be easily handled.
The quaternion approach is widely used in Attitude Heading
Reference Systems (AHRSs) because it avoids the gimbal lock
problem. With respect to numerical stability, quaternions are
easier to propagate than the angles themselves.
For systematic and non-risky work, a simulation environment has been developed. The core of the simulation is the
X-Plane 9 simulator which is certified by the Federal Aviation Administration (FAA) for subsonic terrestrial flight. For
realism, perturbations in the form of high-frequency noise and
sensor latencies, are included to the data from the simulator.
For evaluating the proposed solution, a number of simulations have been run. These have been used to both validate

the solution and to compare it to the same algorithm using
the EKF. During these simulations a maximum error of
1.0 [o] is imposed on the pitch and roll attitude angles, and a
maximum error of 4.0 [o] on the yaw attitude angle. Under those
requirements, which are standard in the industry [8], the error
tolerances in the different signals are obtained through the
analysis of a large number of simulation cases. The solution
based on the UKF shows better performance.
Finally, the UKF based solution is tested on a real experiment using a fixed-wing UAV of 2 meters of wingspan. This
UAV is shown in figure 1. An in-house autopilot is used to test
the estimation algorithm presented in this paper. The results
of the solution are compared to different independent systems
with very good results.
Summarising, the first section of the paper presents some of
the state of the art of AHRSs. The following section is devoted
to the formulation of the problem, including the kinematic
model and the TRIAD algorithm. Then comes a section
describing the whole solution using the UKF and TRIAD. The


Fig. 1: UAV developed by the authors.


fifth section deals with data obtained by simulation, and the
comparison between the UKF and the EKF is presented. Then,
field experiments are presented to fully evaluate the proposed
AHRS. In the final section of the paper, some conclusions are
drawn, including some guidelines for future work.


II. B ACKGROUND AND RELATED WORK

The Unscented Transformation (UT) and the UKF were
introduced by Julier and Uhlmann [9], the algorithms were
further explained, with examples, by Wan and Merwe [10].
An extensive description of the UKF was given in [11].
Background on the EKF algorithm is given in [12]. In [13]
it was shown than the EKF can lead to unbounded estimation

errors for nonlinear systems similar to those used in this paper.
Some modern techniques, such as particle filters [14], are
expensive in computational terms. Therefore they are unsuitable for microcontrollers unless the number of particles is
reduced. However, this can lead to worse performance than
the EKF [15].
In a recent article [16] a comparison of both the EKF and
UKF is done for the particular case of flight path reconstruction for a fixed-wing UAV. This article includes an interesting
discussion of previous references that illustrate the improved
performance of the UKF over EKF estimating the attitude of
an UAV.

For real-time applications, it is important to reduce the
computational cost. Part of the research deals with different
ways of alleviating this cost. For instance, in [17] an attempt
to simplify the observation model is shown; however, it
compromises computational cost because the method involves
the inversion of several large matrices every filter iteration.
Another example is [18], which proposes to reduce the number
of vector state variables. Our proposed solution has been
implemented in a microcontroller for real-time estimation.
As highlighted by [19] it is important to base the Kalman filter on an accurate model. In our context, the models presented
in the following section are well established in the literature
and correspond with experimental results.
An extensive review of navigation systems is [20]. It covers
different algorithms including Kalman filters and the TRIAD
algorithm. The TRIAD algorithm was introduced by Shuster
and Oh in [21] to measure the DCM in a spacecraft.



2


The use of IMUs based in MEMS technology to estimate
the attitude angles in the industry has been increasing in the
recent years, like a fastening tool tracking system in [22].
A well-known problem with gyrometers is bias. Therefore,
different sensors have to be used to correct these biases. For

instance, in [23] they are corrected using three-axis accelerometers. In [24] the use of eight accelerometers in a new
configuration is proposed for measuring angular velocities in
small UAVs. Different approaches rely on magnetometers [25],
to be able to estimate yaw angle in helicopters, or in GPS

[26] to estimate the position as well the attitude in fixedwing UAVs. Alternatively, other papers propose not to use
gyrometers at all in conventional aircrafts, but several GPS
receivers instead [27].
In this paper we propose an attitude estimator using the
UKF and the TRIAD algorithm involving gyrometers, magnetometers and accelerometers. The validation of the algorithm is
done by both simulations and field experiments. Experiments
use an on-board hardware with MEMS sensors.


III. P ROBLEM FORMULATION


Although each UAV has its own coefficients and therefore
its own dynamical model, it is possible to determine Euler
angles from a kinematic model, which is independent of the
UAV’s coefficients. In this section we derive the mathematical
formulation of the AHRS problem in a UAV equipped with a
three-axis gyrometer, three-axis accelerometer and three-axis

magnetometer.


_A. AHRS kinematic model_


The Euler angles describe the aircraft body-axis orientation
in north, east, and down coordinates. That means in longitudinal, lateral and normal coordinates, with respect to the local
tangent plane to the Earth and true north. Here _θ_ is the pitch
angle, _φ_ the roll angle and _ψ_ is the yaw angle according to
Figure 2. The angular velocity vector expressed in body frame
is _P_ for the roll rate, _Q_ is the pitch rate and _R_ is the yaw
rate; and it is related to the Earth frame by the transformation
given by the kinematics equation (1).


_φ_ ˙˙ 1 tan _θ_ sin _φ_ tan _θ_ cos _φ_ _P_

   _−_   



_φ_ ˙˙

 _θ_

 _ψ_ ˙



 =







 _P_

_Q_
_R_








(1)


















1 tan _θ_ sin _φ_ tan _θ_ cos _φ_

0 cos _φ_ _−_ sin _φ_

0 cossin _θφ_ coscos _θφ_



Integrating equation (1) gives numerical instability and
could be gimbal locked. For this reason, a quaternion formulation to represent the attitude is preferred:


3
_q_ = _q_ 0 + _q_ 1 _i_ + _q_ 2 _j_ + _q_ 3 _k_ � _q_ _i_ = 1 (2)

_i_ =0


Where the quaternion norm is 1 and their components from
Euler angles are:


_q_ 0 = cos _φ_ _[′]_ cos _θ_ _[′]_ cos _ψ_ _[′]_ + sin _φ_ _[′]_ sin _θ_ _[′]_ sin _ψ_ _[′]_ (3)

_q_ 1 = sin _φ_ _[′]_ cos _θ_ _[′]_ cos _ψ_ _[′]_ _−_ cos _φ_ _[′]_ sin _θ_ _[′]_ sin _ψ_ _[′]_ (4)

_q_ 2 = cos _φ_ _[′]_ sin _θ_ _[′]_ cos _ψ_ _[′]_ + sin _φ_ _[′]_ cos _θ_ _[′]_ sin _ψ_ _[′]_ (5)

_q_ 3 = cos _φ_ _[′]_ cos _θ_ _[′]_ sin _ψ_ _[′]_ _−_ sin _φ_ _[′]_ sin _θ_ _[′]_ cos _ψ_ _[′]_ (6)


3


Another issue arises when the equation (7) is integrated.
The quaternion shall conserve its norm equals to 1, otherwise
the Euler angles are wrongly computed from the quaternion.
Although it can be normalized after every integration step,
there is a better way to do it. The quaternion norm can be
kept solving the equation (7) using the next integrating factor:





(14)




exp



 _t_

�

 _t_ 0



Ωd _t_



where







Fig. 2: Axes and coordinate definitions.



Ω= [1]

2









0 _−P_ _−Q_ _−R_
_P_ 0 _R_ _−Q_
_Q_ _−R_ 0 _P_
_R_ _Q_ _−P_ 0



 (15)



where _φ_ _[′]_ = _φ/_ 2, _θ_ _[′]_ = _θ/_ 2, and _ψ_ _[′]_ = _ψ/_ 2.
The kinematics equation (1) can be rewritten in linear form
using quaternion components:


˙
_q_ 0 0 _−P_ _−Q_ _−R_ _q_ 0

˙

     



Assuming that the angular velocities remain constant during
the interval d _t_, we can discretize the equation (7) as follows

[29]:















˙
_q_ 0

˙
_q_ 1

˙
_q_ 2

˙
_q_ 3







1

=

2









 (7)




_**[ω]**_ _[∥]_

_∥_ ∆ _**ω**_ _∥_ Ω _q_ ( _k_ ) (16)
2 �



where _∥_ ∆ _**ω**_ _∥_ = [1]



where _∥_ ∆ _**ω**_ _∥_ = 2 ~~�~~ ( _P_ ∆ _t_ ) [2] + ( _Q_ ∆ _t_ ) [2] + ( _R_ ∆ _t_ ) [2] and _I_ is the

identity matrix.



_q_ ( _k_ + 1) = _I_ cos _[∥]_ [∆] _**[ω]**_ _[∥]_
� 2




[1] 2 ~~�~~




_**[ω]**_ _[∥]_ + sin _[∥]_ [∆] _**[ω]**_ _[∥]_

2 2







2









0 _−P_ _−Q_ _−R_
_P_ 0 _R_ _−Q_
_Q_ _−R_ 0 _P_
_R_ _Q_ _−P_ 0



_q_ 0

_q_ 1

_q_ 2

_q_ 3



Additionally, it is useful to formulate the DCM using
quaternion components and the Euler angles from the DCM

terms:



DCM _≡_ _A_ = _{c_ _ij_ _}_ =
 _A_ 1 2(



(8)








2( _q_ 1 _q_ 2 _A −_ 1 _q_ 0 _q_ 3 ) 2( _q_ 1 _q_ 2 _A_ + 2 _q_ 0 _q_ 3 ) 2(2( _qq_ 12 _qq_ 33 _−_ + _qq_ 00 _qq_ 21 ))

2( _q_ 1 _q_ 3 + _q_ 0 _q_ 2 ) 2( _q_ 2 _q_ 3 _−_ _q_ 0 _q_ 1 ) _A_ 3



_C. The TRIAD algorithm_


The Three Axis Attitude Determination algorithm was introduced by Shuster and Oh [21] to determine the attitude
in a Spacecraft from a set of vector measurements. TRIAD
is a deterministic method to compute the DCM. Given the
reference unit vectors **V** **1** and **V** **2** and the corresponding
observation unit vectors **W** **1** and **W** **2**, the DCM satisfies:


_A_ **V** **1** = **W** **1** _A_ **V** **2** = **W** **2** (17)


The TRIAD algorithm determines the DCM using the
following expression


_A_ = _M_ _o_ _M_ _r_ _[T]_ (18)

_M_ _o_ = ( **o** **1** _|_ **o** **2** _|_ **o** **3** ) (19)


_M_ _r_ = ( **r** **1** _|_ **r** **2** _|_ **r** **3** ) (20)


where the observation column vectors **o** **i** and the reference
column vectors **r** **i** are given by


**o** **1** = **W** **1** (21)


**o** **2** = ( **W** **1** _×_ **W** **2** ) _/|_ **W** **1** _×_ **W** **2** _|_ (22)


**o** **3** = ( **W** **1** _×_ ( **W** **1** _×_ **W** **2** )) _/|_ **W** **1** _×_ **W** **2** _|_ (23)


**r** **1** = **V** **1** (24)


**r** **2** = ( **V** **1** _×_ **V** **2** ) _/|_ **V** **1** _×_ **V** **2** _|_ (25)


**r** **3** = ( **V** **1** _×_ ( **V** **1** _×_ **V** **2** )) _/|_ **V** **1** _×_ **V** **2** _|_ (26)


Notice that the pair ( **W** **1** _,_ **V** **1** ) has more influence on _A_ than
( **W** **2** _,_ **V** **2** ), this is because part of the information contained
in the second pair is discarded. Therefore it is convenient
to assign ( **W** **1** _,_ **V** **1** ) to the pair of greater accuracy, which
depends on the flight circumstances. Section IV-B describes
criteria to assign these pairs.



where _A_ 1 = _q_ 0 [2] [+] _[ q]_ 1 [2] _[−]_ _[q]_ 2 [2] _[−]_ _[q]_ 3 [2] [,] _[ A]_ [2] [=] _[ q]_ 0 [2] _[−]_ _[q]_ 1 [2] [+] _[ q]_ 2 [2] _[−]_ _[q]_ 3 [2] [, and]
_A_ 3 = _q_ 0 [2] _[−]_ _[q]_ 1 [2] _[−]_ _[q]_ 2 [2] [+] _[ q]_ 3 [2] [. Then,]


_θ_ = _−_ arcsin(2( _q_ 1 _q_ 3 _−_ _q_ 0 _q_ 2 )) (9)

_φ_ = atan2(2( _q_ 2 _q_ 3 + _q_ 0 _q_ 1 ) _, q_ 0 [2] _[−]_ _[q]_ 1 [2] _[−]_ _[q]_ 2 [2] [+] _[ q]_ 3 [2] [)] (10)

_ψ_ = atan2(2( _q_ 1 _q_ 2 + _q_ 0 _q_ 3 ) _, q_ 0 [2] [+] _[ q]_ 1 [2] _[−]_ _[q]_ 2 [2] _[−]_ _[q]_ 3 [2] [)] (11)


where atan2 is the four-quadrant version of the inverse tangent
function, and arcsin is the arcsine function.


_B. Gyros integration problem_

The three-axis gyrometer measures the angular velocities,
and for obtaining the Euler angles, the gyros can be integrated
using equation (7). However, even if we ignore the sensor
noise, the gyros usually have bias, making integration their
error grow in every step.
Fortunately for a MEMS gyrometer in normal conditions
(not extremal temperature or pressure variation), this bias can
be assumed to be constant [28], or very slow varying throughout the UAV mission. Therefore the bias for the gyrometer can
be modeled as:

˙ _T_
**b** = 0 with **b** = � _b_ _x_ _b_ _y_ _b_ _z_ � (12)


Denoting the angular velocity vector _**ω**_ = ( _P, Q, R_ ), if the
gyros from the sensors are _**ω**_ _s_, they can be corrected using
the bias as:


_**ω**_ = _**ω**_ _s_ _−_ **b** (13)


IV. U NSCENTED K ALMAN F ILTER DESIGN


The UKF [9] is an alternative to the EKF, providing superior
performance at similar order of computational cost. Also during the UKF implementation process, there are not Jacobians,
Hessians or other derivatives involved. In this paper, the UKF
is used both for state estimation (quaternion components) and
for parameter estimation (gyrometer’s biases).
The estimation algorithm is implemented as a two-step
_propagator/corrector_ filter. It is desirable to run each step as
many times as possible, however, the frequencies at which
they will be run will be limited by different factors. For the
propagation step, the limiting factor is the computation time;
we chose a frequency of 100 Hz. The correction step is limited,
in our case, by the GPS sample rate, that is, 1 Hz.
The algorithm is described in the diagram shown in Figure 3. The diagram depicts the two main loops, one at
100 Hz and the other at 1 Hz, these loops correspond to the
propagation and correction steps respectively. It can be noted
how the TRIAD information feeds the correction step.



4


Where _q_ _i_ are the quaternion components and _b_ _j_ are the
gyrometers’ biases. These are assumed to be Gaussian Random
Variables (GRVs). Their process model is given by equations
(16) and (12), respectively.
The basis of the UKF is the UT; which is a method for
calculating the statistics of a random variable which undergoes
a nonlinear transformation [9]. In our case, we assume that the
noise of the UAV sensors is additive (zero mean). Under this
assumption, the equations to estimate the Euler angles and the
gyrometer’s biases are the ones described in this subsection.
The computation algorithm begins with the initial conditions:


_x_ ˆ 0 = _E_ [ _x_ 0 ] (28)

_P_ 0 = _E_ [( _x_ 0 _−_ _x_ ˆ 0 )( _x_ 0 _−_ _x_ ˆ 0 ) _[T]_ ] (29)


At the start of every iteration we calculate the _sigma points_

[9] _χ_ _k−_ 1 of the quaternion components and gyro’s biases.



ˆ ˆ
_χ_ _k−_ 1 = � _x_ _k−_ 1 _x_ _k−_ 1 + _γ_ �



ˆ
_P_ _k−_ 1 _x_ _k−_ 1 _−_ _γ_ �



_P_ _k−_ 1 ~~�~~ (30)



















Where _γ_ = _√L_ + _λ_, _λ_ is a composite scaling parameter

and _L_ is the state vector dimension. _[√]_ _P_ _k_ can be computed
with the lower triangular Cholesky factorization.
The next step is to evaluate the model on the sigma points:


_χ_ _[∗]_ _k|k−_ 1 [=] _[ F]_ [[] _[χ]_ _[k][−]_ [1] _[, u]_ _[k][−]_ [1] []] (31)


Where _F_ is the process model as given by equations (16)
and (12). _u_ _k−_ 1 is the angular velocity vector _**ω**_ . The a priori
state estimation is approximated using a weighted sample

mean















_x_ ˆ _[−]_ _k_ [=]



2 _L_
� _W_ _i_ [(] _[m]_ [)] _χ_ _[∗]_ _i,k|k−_ 1 (32)


_i_ =0



Fig. 3: Algorithm block diagram.


The area surrounded by dashed lines contains the elements
involved in the TRIAD calculations. The leftmost block represents an access to the sensors to measure _[b]_ _a_ and _[b]_ _m_ which cor
respond to the accelerations and magnetic field measurements
in the body reference frame respectively. The signals are then
filtered. The GPS velocity is used to subtract the centrifugal
accelerations as explained in subsection B; which also covers
the description of the TRIAD block. On the right side of the
diagram the block denoted as _World Magnetic Model_ uses an
harmonic spherical model to obtain the magnetic field vector
at the position of the UAV. This vector is used as one of the
references in the TRIAD algorithm.
This section describes the design of the filter under the
considerations given above. Subsection A gives the equations
involved in the propagation loop whilst Subsection B deals
with those of the correction loop.


_A. Propagation equations and process model_


This subsection describes the propagation loop. The state
vector is:


_x_ ( _k_ ) = � _q_ 0 ( _k_ ) _q_ 1 ( _k_ ) _q_ 2 ( _k_ ) _q_ 3 ( _k_ ) _b_ _x_ ( _k_ ) _b_ _y_ ( _k_ ) _b_ _z_ ( _k_ ) [�] _[T]_

(27)



where


_W_ 0 [(] _[m]_ [)] = _λ/_ ( _L_ + _λ_ ) (33)

_W_ _i_ [(] _[m]_ [)] = 1 _/_ (2( _L_ + _λ_ )) (34)


and the covariance matrix is



_P_ _k_ _[−]_ [=]


where



2 _L_
� _W_ _i_ [(] _[c]_ [)] [ _χ_ _[∗]_ _i,k|k−_ 1 _[−]_ _[x]_ [ˆ] _[−]_ _k_ [][] _[χ]_ _[∗]_ _i,k|k−_ 1 _[−]_ _[x]_ [ˆ] _[−]_ _k_ []] _[T]_ [ +] _[ Q]_ [noise]


_i_ =0

(35)


_W_ 0 [(] _[c]_ [)] = _λ/_ ( _L_ + _λ_ ) + (1 _−_ _α_ [2] + _β_ ) (36)

_W_ _i_ [(] _[c]_ [)] = 1 _/_ (2( _L_ + _λ_ )) (37)



The constant _α_ determines the spread of the sigma points
around ˆ _x_ and is usually set to a small positive value (for
instance, 1 _≤_ _α ≤_ 1 _e_ _[−]_ [4] ). The constant _β_ can be used to
incorporate prior knowledge of the distribution of the state
vector: for Gaussian distributions, _β_ = 2 is optimal [10].
_Q_ noise _∈_ R [7] _[x]_ [7] is the process noise covariance:



_Q_ _q_ 0
_Q_ noise =
� 0 _Q_ _b_



(38)
�


where _Q_ _q_ _∈_ R [4] _[x]_ [4] is the noise covariance associated to the
quaternion components and _Q_ _b_ _∈_ R [3] _[x]_ [3] is the noise covariance
associated to the gyrometer biases.
The process that relates the quaternion components and
angular velocities has a continuous-time analytical solution,
as was shown in Subsection III-B. However, the discretetime equation (16) assumes that the angular velocities remain
constant during the discretization period. Hence, _Q_ _q_ should
be close, but different to zero. For the simulation and experimental results shown in this paper:


_Q_ _q_ = 1 _×_ 10 _[−]_ [6] _· I_ 4 _x_ 4 (39)


where _I_ 4 _x_ 4 is the 4x4 identity matrix.
The process noise covariance associated to the gyrometer
biases _Q_ _b_ is the 3x3 zero matrix. The rationale for this is the
same that explains equation (12) in Subsection III-B.


_B. Correction equations and observation model_


Even though the TRIAD algorithm gives the nine terms of
the DCM (see equation (8)), only four of them are needed to
calculate the Euler angles. Hence, the observation function has
been designed to measure these four terms.
To determine the pitch and roll angles, the terms are the X
and Y components of the Z earth vector expressed in the body
frame.


_b_ _Z_ _Ex_ _≡_ _c_ 13 = 2( _q_ 1 _q_ 3 _−_ _q_ 0 _q_ 2 ) (40)

_b_ _Z_ _Ey_ _≡_ _c_ 23 = 2( _q_ 2 _q_ 3 + _q_ 0 _q_ 1 ) (41)


For the yaw angle, the terms are the X and Y components
of the X body vector expressed in the Earth reference frame.


_E_ _X_ _bx_ _≡_ _c_ 11 = ( _q_ 02 [+] _[ q]_ 1 [2] _[−]_ _[q]_ 2 [2] _[−]_ _[q]_ 3 [2] [)] (42)

_E_ _X_ _by_ _≡_ _c_ 12 = 2( _q_ 1 _q_ 2 + _q_ 0 _q_ 3 ) (43)


Therefore, the observation model is given by equation (44).


_T_
_H_ ( _x_ _k_ ) = � _c_ 13 _c_ 23 _c_ 11 _c_ 12 � (44)


According to the TRIAD algorithm two vector pairs are
needed to compute the terms of the DCM. Each pair consists
of a measure or observation and a reference vector (equation (17)). In our case, these pairs are the magnetic field, and
the acceleration of the UAV.

The magnetic observation vector is the field measured at
body frame. The magnetic reference vector is the Earth’s
magnetic field using an harmonic spherical model; the geographical coordinates for this model are provided by an onboard GPS receiver.

For the acceleration pair, the observation is given by the
on-board IMU. It should be noted that the measurement given
by the accelerometers includes: linear acceleration, Coriolis
acceleration, centripetal acceleration and gravity. Coriolis acceleration is assumed to be negligible, in our experiments
it is of the order of 10 _[−]_ [4] g. The reference is the Earth’s
gravity ˆ **g** = �0 0 1 [�], normalized in North East Down
(NED) coordinates. The on-board accelerometers are affected
by mechanical vibrations and environmental perturbations,
therefore it is convenient to use a low-pass filter to reduce these



5


effects. Also, the centrifugal contribution of the acceleration
has to be subtracted:


_E_
_a_ _N_ = ˙ _U_ + _QW −_ _RV_ (45)


_E_
_a_ _E_ = ˙ _V_ + _RU −_ _PW_ (46)


_E_
_a_ _D_ = ˙ _W_ + _PV −_ _RU_ (47)


Where the speed _[b]_ **V** = � _U_ _V_ _W_ � is expressed in the
body frame of reference. In a fixed-wing UAV, during a nonacrobatic flight, both _V_ and _W_ are negligible. Therefore,
the GPS speed measurement gives _U_, which is the dominant
component of _[b]_ **V** .
As stated in section III-C it is convenient to assign
( **W** **1** _,_ **V** **1** ) to the pair of greater accuracy. During a flight, there
are times when accelerometers offer more accuracy, whereas
during others, magnetometers are more reliable. In our case,
we used the following criteria. In order of priority:

_•_ If 0 _._ 9ˆ **g** _≤|_ _[b]_ **a** _| ≤_ 1 _._ 1ˆ **g** then it can be assumed that this
is a stationary flight, hence the acceleration is the pair of
greater accuracy. In this case, **V** **1** = ˆ **g** and **W** **1** = _[b]_ **a** .

_•_ Else, if 0 _._ 7ˆ **g** _< |_ _[b]_ **a** _| <_ 0 _._ 9ˆ **g** or 1 _._ 1ˆ **g** _< |_ _[b]_ **a** _| <_
1 _._ 3ˆ **g** then it can be assumed that the plane is doing
a coordinated turn. In this case, magnetometers offer
greater accuracy. Therefore, **V** **1** = _[E]_ **m** and **W** **1** = _[b]_ **m** .

_•_ Else, if _|_ _[b]_ **m** _| >_ 1 _._ 2 _|_ _[E]_ **m** _|_ or _|_ _[b]_ **m** _| <_ 0 _._ 8 _|_ _[E]_ **m** _|_ then the
magnetic measurements are not reliable. The correction
step is skipped.

_•_ Else, if _|_ _[b]_ **a** _| >_ 1 _._ 3ˆ **g** or _|_ _[b]_ **a** _| <_ 0 _._ 7ˆ **g** then it is assumed
that the current state is acrobatic and neither the magnetic
measurements nor the acceleration measurements are

reliable enough. The correction step is skipped.
Where _[E]_ **m** is the Earth’s magnetic field vector and ˆ **g** the
Earth’s gravity acceleration. Notice how in the last two cases,
the correction step is skipped. The following only applies in
the first two cases.
The UKF begins the correction step by redrawing the sigma
points. This is done to incorporate the effect of the additive
noise [10].



ˆ ˆ
_χ_ _k|k−_ 1 = � _x_ _[−]_ _k_ _x_ _[−]_ _k_ [+] _[ γ]_ �



_P_ _k_ _[−]_ _x_ ˆ _[−]_ _k_ _[−]_ _[γ]_ �



_P_ _[−]_
_k_



(48)
�



Then the unscented transformation of the observations is

computed.


_Y_ _k|k−_ 1 = _H_ [ _χ_ _k|k−_ 1 ] (49)



_y_ ˆ _k_ _[−]_ [=]



2 _L_
� _W_ _i_ [(] _[m]_ [)] _Y_ _i,k|k−_ 1 (50)


_i_ =0



The measure and cross-covariance matrices are



_P_ ¯ _y_ _k_ ¯ _y_ _k_ [=]


_P_ _x_ _k_ _y_ _k_ =



2 _L_


ˆ

� _W_ _i_ [(] _[c]_ [)] [ _Y_ _i,k|k−_ 1 _−_ _y_ _k_ _[−]_ [][] _[Y]_ _[i,k][|][k][−]_ [1] _[ −]_ _[y]_ [ˆ] _k_ _[−]_ []] _[T]_ [ +] _[ R]_ [noise]


_i_ =0

(51)


2 _L_


ˆ

� _W_ _i_ [(] _[c]_ [)] [ _χ_ _i,k|k−_ 1 _−_ _x_ _[−]_ _k_ [][] _[Y]_ _[i,k][|][k][−]_ [1] _[ −]_ _[y]_ [ˆ] _k_ _[−]_ []] _[T]_ (52)


_i_ =0



where _R_ noise is the measurement noise covariance. The value of
_R_ noise can be derived from the nominal values of the errors of


the sensors involved. This derivation is described thoroughly
in [21].
Now the Kalman gain is computed:


_K_ _k_ = _P_ _x_ _k_ _y_ _k_ _P_ _x_ _[−]_ _k_ [1] _y_ _k_

Finally, the correction equations are (53) and (54):


_x_ ˆ _k_ = ˆ _x_ _[−]_ _k_ [+] _[ K]_ _[k]_ [(] _[y]_ _[k]_ _[ −]_ _[y]_ [ˆ] _k_ _[−]_ [)] (53)

_P_ _k_ = _P_ _k_ _[−]_ _[−K]_ _[k]_ _[P]_ _y_ [ ¯] _k_ ¯ _y_ _k_ _[K]_ _k_ _[T]_ (54)


V. S IMULATIONS RESULTS


Since real experiments might imply crashes, some previous
simulations are in order. For this, we developed a simulation
framework, which consists in three different parts. The core
of the simulation is the X-Plane 9 software. The other two

parts are: the plug-in code for X-Plane 9 and the model of
the sensors. The idea is to integrate a six-degree-of-freedom
aerodynamic model, provided by X-Plane with a realistic
model of the sensors we are using. The plug-in code is just
the glue between them.
X-Plane 9 includes different aircraft models. Its default

radio control model is very similar to our UAV, so no
modifications to it are needed. This is the model used in the
simulations of this section.

The purpose of the simulations is to study the effects of
sensor noise, bias and latencies. Therefore, the model of the
sensors focuses on these aspects:


_•_ GPS signal is delayed 1 second.

_•_ Gyrometers signal are biased and corrupted with white
noise.


_•_ Accelerometers are biased and corrupted with colored
noise, focusing in high frequencies.

_•_ Magnetometers are biased and corrupted with white
noise.

Figure 4 shows an example of how bias and noise are
added to a variable. Notice how both the magnitude of the
noise and the bias are kept constant throughout the simulation.
In particular, the example shows roll rate measurements as
simulated.

A first target of the simulations is to study the tolerances
of both estimators to bias and noise magnitude. According to
standard procedures, a maximum error of 1.0 [o] in the estimation
of pitch and roll angle, and 4.0 [o] for yaw angle are imposed. It
is assumed that with this error it is possible to do closed-loop
control. This is covered in the first part of this section. The
second part of this section assesses the performance of the
UKF using real values for the biases and noise magnitudes of

our sensors.


_A. Error tolerances and comparison of estimators_


A Monte Carlo analysis of the tolerances was made, supported by a batch of simulation experiments. Each of the
experiments specifies different values of biases and noise
magnitudes, which were drawn from a Gaussian distribution.
Two sets of results were obtained, one using the UKF and
the other using the EKF. These sets are shown in Tables I and
II respectively.



6


2


1.5


1


0.5


0

|Roll rate|Col2|
|---|---|
|True value<br>Corrupted v|alue|
|||
|||
|||
|||
|||



376.5 376.6 376.7 376.8 376.9 377 377.1

Time (s)


Fig. 4: True and corrupted roll rate used for simulations.


TABLE I: UKF tolerances: Maximum bias and random error

standard deviation.


Measurement Bias error Random error


Roll rate, P _±_ 9 _._ 98 [o] /sec _±_ 8 _._ 51 [o] /sec

Pitch rate, Q _±_ 9 _._ 98 [o] /sec _±_ 8 _._ 51 [o] /sec

Yaw rate, R _±_ 9 _._ 98 [o] /sec _±_ 5 _._ 01 [o] /sec

Accelerometers _±_ 0 _._ 3 m/s [2] _±_ 0 _._ 7 m/s [2]


Magnetometers _±_ 10 _._ 53mG _±_ 21 _._ 73mG

GPS Velocity _±_ 2 _._ 57m/s _±_ 2 _._ 45m/s


It can be noted how both algorithms are more sensitive to
errors in _R_ than they are to errors in _P_ and _Q_ . This is because
the information in the yaw angle is only provided by one
of the sensors, the magnetometer. While the information in
pitch and roll angles are provided by the accelerometer and
the magnetometer.
In general, EKF is more sensitive to biases and noises than
the UKF. In particular it is very sensitive to the bias in _R_ .
Hence, the solution based on the UKF is preferred.


_B. Simulation using real error values_


For this simulation, the real biases and noise magnitudes
were extracted from our IMU’s datasheet. Table III shows

them. It is interesting to compare these values to those from
tables I and II. It can be seen how some errors are outside of

the EKF tolerances. So EKF can not be used in our case.


TABLE II: EKF tolerances: Maximum bias and random error

standard deviation.


Measurement Bias error Random error


Roll rate, P _±_ 1 _._ 50 [o] /sec _±_ 1 _._ 50 [o] /sec

Pitch rate, Q _±_ 1 _._ 50 [o] /sec _±_ 1 _._ 50 [o] /sec

Yaw rate, R _±_ 0 _._ 50 [o] /sec _±_ 1 _._ 50 [o] /sec

Accelerometers _±_ 0 _._ 14 m/s [2] _±_ 0 _._ 32 m/s [2]


Magnetometers _±_ 5 _._ 58mG _±_ 11 _._ 43mG

GPS Velocity _±_ 2 _._ 17m/s _±_ 1 _._ 45m/s


7



TABLE III: Typical MEMS bias and random error standard
deviation.


Measurement Bias error Random error


Roll rate, P _±_ 3 _._ 00 [o] /sec _±_ 1 _._ 00 [o] /sec

Pitch rate, Q _±_ 3 _._ 00 [o] /sec _±_ 1 _._ 00 [o] /sec

Yaw rate, R _±_ 3 _._ 00 [o] /sec _±_ 1 _._ 00 [o] /sec

Accelerometers _±_ 0 _._ 05 m/s [2] _±_ 0 _._ 009 m/s [2]


Magnetometers _±_ 4 _._ 00mG _±_ 1 _._ 25mG

GPS Velocity _±_ 0 _._ 5m/s _±_ 1 _._ 5m/s


Figures 5, 6 and 7 show the behavior of the UKF algorithm
in a typical flight in a windy scenario. Solid lines depict
simulated angles while the dashed ones depict estimations
from the AHRS. It should be noted that in figure 7, the abrupt
changes near seconds 520 and 590 is due to the representation
of angles in the range _±_ 180 [o] . The agreement between the
simulated and estimated values is satisfactory.



Pitch


6


4


2


0


−2


−4


−6

|Col1|Col2|Col3|Col4|Col5|Col6|estima<br>true v|Col8|ted value<br>alue|
|---|---|---|---|---|---|---|---|---|
||||||||||
||||||||||
||||||||||
||||||||||
|`1`|`2`|`2`||`3`||||`4`|
||||||||||
||||||||||
||||||||RMSE 0.|4776 deg|
||||||||||



350 400 450 500 550 600

Time (s)


Fig. 6: Pitch angle simulated with MEMS parameters.



150





15





10


5


0


−5


−10


−15

|Col1|Col2|Col3|Col4|Roll|Col6|Col7|Col8|Col9|
|---|---|---|---|---|---|---|---|---|
||||||||estimat<br>|ed value<br>|
||||||||~~true val~~|~~ue~~|
||||||||||
|`1`|`2`|`2`|||`3`|`3`|`4`||
||||||||||
||||||||||
||||||||||
||||||||RMSE 0.54|81 deg|
||||||||||

350 400 450 500 550 600

Time (s)


Fig. 5: Roll angle simulated with MEMS parameters.


Area marked with ’1’ shows a coordinated turn to the left,
note how the yaw angle decreases. This turn leads to the
next area, marked with ’2’, which is a steady flight. The area
marked with ’3’ is a new coordinated turn to the right, note
how the yaw angle increases. The final area, marked with ’4’,
is a new steady flight; the three angles remain mostly constant.
It can be noted that the pitch angle estimation in area ’4’ has a
slight bias (of less than 0.3 [o] ), this is due to the magnetometers
biases added during the data corruption. These biases are not
compensated through the algorithm because of their negligible
effect compared to the gyrometers biases. The pitch and roll
angles experience vibrations due to different gusts of wind.
This section has shown how the simulation results give
confidence on the AHRS using the UKF. The system can be
used in field experiments. The following section covers field
experiments and the validation of the AHRS.


VI. F IELD EXPERIMENT RESULTS


The target of the research is to use the AHRS to feed a
closed-loop controller in field experiments. Aside from the



100


50


0


−50


−100


−150

|Col1|Col2|Col3|Col4|Col5|Yaw|Col7|Col8|Col9|Col10|Col11|
|---|---|---|---|---|---|---|---|---|---|---|
||estim|estim|ated valu|e|||||||
||~~true~~|~~true~~|~~value~~||||||||
||~~true~~||||||||||
||||||||||||
||||||||||||
||||||||||||
||`1`||`2`||`3`|||||`4`|
||||||||||||
||||||||||||
||RMSE 1.15|RMSE 1.15|29 deg||||||||



350 400 450 500 550 600

Time (s)


Fig. 7: Yaw angle simulated with MEMS parameters.


simulation results presented in an earlier section, an experimental validation of the system has been done.
Experiments were carried out using a small fixed-wing
UAV. An on-board autopilot hardware has been designed and
built for this UAV. Figure 8 shows a functional diagram of the
autopilot.

Two ARM7 microcontrollers are used for sensor data han
dling and navigation algorithms. Both are connected with a
UART channel. Flight data are measured by different sensors: a GPS receiver, an IMU with magnetometers, and four
pressure sensors. One of the pressure sensors is used as a
barometer for altitude measurement and the rest, one per axis,
are connected to Pitot tubes for air-speed measurement. Sensor
data are stored in an SD card for experiment analysis. The
IMU used is the ADIS16405 from Analog Devices.
The navigation microcontroller receives processed sensor
data from the other microcontroller, and sends this data over
the radio link. In future, when the control loop is closed, this
microcontroller will send the PWM signals to the actuators.
Figure 9 shows a picture of the autopilot.


Fig. 8: Functional diagram of the autopilot.


Fig. 9: Photograph of the on-board hardware next to the UAV.


The target of the experiments is to assess the accuracy of
the estimation of each of the three attitude angles. Therefore,
experiments are designed to excite the _single modes_ of the
system, that is, pure roll, pure pitch and pure yaw. However,
due to the nature of the system, it is not possible to do so
in practice; there is always some coupling between motions.
We tried to excite these modes during the experiments. In
addition, typical maneuvers such as coordinated turns were
also included. A ground station was built to receive data from
the UAV using a radio link. The flight is manually controlled
using a conventional radio control unit.
For validation purposes, data coming from independent
sensors (not used by the estimation algorithm) have been
considered. For the roll angle, a computer vision system is
used. The GPS velocity is used to validate the yaw angle.
The vision system uses a small camera attached to the UAV.
An algorithm was developed to obtain the roll angle from the
video measuring the slope of the horizon. The algorithm is
based on [30] [31] [32]. Figure 10 shows one of the frames
taken during the flight and processed by the vision system.
The results of this system have an uncertainty of _±_ 3 [o] .
Figure 11 shows a comparison between the estimated roll



8


Fig. 10: One of the frames processed by the vision system.


angle and the measurements from the vision system. The area
marked with ’1’ depicts the end of a turn to the right. Is is
followed by a steady flight in the area marked with ’2’, finally
leading to another turn to the right in the area marked with
’3’. The results of the comparison are clearly satisfactory.


Vision vs UKF roll angle



25


20


15


10


5


0


−5

|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|
|---|---|---|---|---|---|---|---|---|---|---|
|||||||~~Visio~~|~~ range~~|~~ range~~|~~ range~~|~~ range~~|
||`1`|||||UKF|estimation||`3`||
||`1`||||||||||
||||||||||||
||||||||||||
|||||||`2`|||||
||||||||||||
||||||||||||
||||||||||||
||||||||||||



2 4 6 8 10 12 14

Time (s)


Fig. 11: Roll angle comparison between vision system and
UKF estimation.


The actual experiment took place under adverse atmospheric
conditions, in particular, there were gusts of wind. So when
there is strong crosswind, the yaw angle differs from the
heading of the plane. The heading is measured using the GPS
velocity with an uncertainty of _±_ 10 [o] . It can be noted that the
GPS velocity is only used to subtract the centrifugal contribution of the accelerometers (see equation (47)) in the estimation
algorithm. Therefore, it can be taken as an independent system
for validation purposes.
Figure 12 shows a comparison of the estimation of the
yaw angle and the heading measured by the GPS. The figure
corresponds to a turn of 360 [o] . During the area marked with
’1’, the UAV faces the wind gusts. The area marked with ’2’
shows the effect of crosswind; it makes the yaw angle and the
heading diverge. In other words, the UAV does not move in



30




the direction it points to. Finally, throughout the area marked
with ’3’, the UAV has tail wind and the yaw angle closely
follows the GPS heading.


200


150


100


50


0


−50



−100





−150


−200

|Col1|Col2|Col3|Col4|Yaw|Col6|Col7|Col8|Col9|Col10|Col11|
|---|---|---|---|---|---|---|---|---|---|---|
|`1`||`2`||`3`|`3`||||||
||||||||||||
||||||||||||
||||||||||||
||||||||||||
||||||||||||
||||||||||||
|||||||GPS ra<br>UKF es|nge<br>timation||||
||||||||||||

0 5 10 15 20 25 30 35 40 45

Time (s)


Fig. 12: Yaw angle comparison between GPS system and UKF
estimation.


With the sensors we are currently using, it is not possible to
have an independent measurement of the pitch angle. However,
due to the formulation of the algorithm using quaternions, the
pitch angle is strongly coupled to the roll and yaw angles.
Therefore, it can be assumed that if both the roll and yaw
angles are correctly estimated, the pitch angle is correctly
estimated too.


VII. C ONCLUSIONS .


This paper considered the problem of attitude estimation
of an UAV in order to establish closed-loop control. The
mathematical formulation of the problem has been presented
in terms of quaternions. The on-board AHRS is based on a
MEMS IMU.

A widely used estimator is the Kalman Filter. The kinematic
model of aircraft attitude is highly non-linear, so a version of
the Kalman filter able to cope with non-linearities is needed.
Two of these versions, have been studied: the EKF and the

UKF. A common solution in the satellite attitude estimation

practice is the TRIAD algorithm and it has been used as the
observation model in the UKF framework in this paper.
Previous studies in the attitude determination field give
the same confidence to the sensors throughout the whole
UAV mission. This is unsuitable for missions that mix both

acrobatic and non-acrobatic maneuvers. Using the TRIAD
algorithm it is easy to select the most reliable sensors along
the different phases of a flight. Criteria for this selection have
been described.

A simulation framework based on XPlane 9 has been

introduced. This simulation corresponds to the characteristics
of the experimental UAV. Using simulation results, it was
found that the UKF shows better performance than the EKF.
Therefore, the UKF has been used in the final version of the
AHRS.



9


The performance of the algorithm has been assessed using
field experiments. Using independent sensors it has been
checked that the estimation algorithm gives good results. A
possible idea for future research is to include the information
from these sensors into the AHRS itself. Since the estimation

results are encouraging the next experimental work will be to
feed the estimations to a closed-loop controller.
Due to space constraints only some snapshots of the experimental results have been shown. However, the complete set
of data confirm the good quality of the estimations. This gives
confidence on the algorithm, which is easy to implement and
it can be run on an on-board microcontroller.


R EFERENCES


[1] I. Maza, F. Caballero, J. Capitan, J. M. de Dios, and A. Ollero, “Firemen
monitoring with multiple uavs for search and rescue missions,” in _Proc._
_IEEE Workshop on Security, Safety and Rescue Robotics (SSRR)_, 2010.

[2] D. T. Cole, S. Sukkaireh, and A. H. G¨oktogan, “System development
and demonstration of a uav control architecture for information gathering
missions,” _Journal of Field Robotics_, no. 26, pp. 417–440, 2006.

[3] Y. Xia, Z. Zhu, M. Fu, and S. Wang, “Attitude tracking of rigid
spacecraft with bounded disturbances,” _IEEE Transactions on Industrial_
_Electronics_, vol. 58, no. 2, pp. 647–659, 2011.

[4] B. Zheng and Y. Zhong, “Robust attitude regulation of a 3-dof helicopter
benchmark: Theory and experiments,” _IEEE Transactions on Industrial_
_Electronics_, vol. 58, no. 2, pp. 660–670, 2011.

[5] Z. Zhu, Y. Xia, and M. Fu, “Adaptive sliding mode control for attitude
stabilization with actuator saturation,” _IEEE Transactions on Industrial_
_Electronics_, vol. PP, 2011.

[6] G. Cai, B. Chen, K. Peng, M. Dong, and T. Lee, “Modeling and control
of the yaw channel of a uav helicopter,” _IEEE Transactions on Industrial_
_Electronics_, vol. 55, no. 9, pp. 3426–3434, 2008.

[7] O. Spinka, O. Holub, and Z. Hanz´alek, “Low-cost reconfigurable control [ˇ]
system for small uavs,” _IEEE Transactions on Industrial Electronics_,
vol. 58, no. 3, pp. 880–889, 2011.

[8] L. B. Stephen A. Whitmore, Mike Fife, “Development of a closed-loop
strap down attitude system for an ultrahigh altitude flight experiment,”
NASA Technical Memorandum 4775, 1997.

[9] S. J. Julier and J. K. Uhlmann, “A new extension of the kalman filter
to nonlinear systems,” in _Proc. Int. Symp. Aerospace/Defense Sensing,_
_Simul. and Controls, Orlando, FL_, 1997, pp. 182–193.

[10] E. Wan and R. van der Merwe, “The unscencted kalman filter,” in
_Kalman Filtering and Neural Networks_, S. Haykin, Ed. Wiley, 2001,
ch. 7.

[11] S. J. Julier and J. K. Uhlmann, “Unscented filtering and nonlinear
estimation,” in _Proceedings of the IEEE_, vol. 92, no. 3, 2004, pp. 401–
422.

[12] A. H. Jazwinski, _Stochastic Processes and Filtering Theory_ . Academic
Press, Inc., 1970.

[13] K. Reif, S. Gunther, E. Yaz, and R. Unbehauen, “Stochastic stability
of the discrete-time extended kalman filter,” _IEEE Transactions on_
_Automatic Control_, vol. 44, no. 4, pp. 714–728, April 1999.

[14] F. Gustafsson, F. Gunnarsson, N. Bergman, U. Forssell, J. Jansson,
R. Karlsson, and P.-J. Nordlund, “Particle filters for positioning, navigation, and tracking,” _IEEE Transactions on Signal Processing_, vol. 50,
no. 2, pp. 425–437, Feb. 2002.

[15] S. P. Won, W. W. Melek, and F. Golnaraghi, “A kalman/particle filterbased position and orientation estimation method using a position
sensor/inertial measurement unit hybrid system,” _IEEE Transactions on_
_Industrial Electronics_, vol. 57, no. 5, pp. 1787–1798, May 2010.

[16] B. O. Teixeira, L. A. Tˆorres, P. Iscold, and L. A. Aguirre, “Flight path
reconstruction - a comparison of nonlinear kalman filter and smoother
algorithms,” _Aerospace Science and Technology_, vol. In Press, Corrected
Proof, 2010.

[17] J. Marins, X. Yun, E. Bachmann, R. McGhee, and M. Zyda, “An
extended kalman filter for quaternion-based orientation estimation using
marg sensors,” in _Proc. IEEE/RSJ International Conference on Intelli-_
_gent Robots and Systems._, vol. 4, 2001, pp. 2003–2011.

[18] M. J. Hale, P. Vergez, M. J. Meerman, and Y. Hashida, “Kalman filtering
and the attitude determination and control task,” in _Proc. AIAA Space_
_Conference and Exhibit_, Sept. 2004, paper AIAA-2004-6018.


10




[19] J. Qi, J. Han, and Z. Wu, “Rotorcraft uav actuator failure estimation with
kf-based adaptive ukf algorithm,” in _American Control Conference_, June
2008, pp. 1618–1623.

[20] A. M. Hasan, K. Samsudin, A. R. Ramli, R. S. Azmir, and S. A.
Ismaeel, “A review of navigation systems (integration and algorithms),”
_Australian Journal of Basic and Applied Sciences_, vol. 3, no. 2, pp.
943–959, 2009.

[21] M. D. Shuster and S. D. Oh, “Three axis attitude determination from
vector observations,” _Journal of Guidance and Control_, vol. 4, no. 1,
pp. 70–77, Jan. 1981.

[22] S. P. Won, F. Golnaraghi, and W. W. Melek, “A fastening tool tracking
system using an imu and a position sensor with kalman filters and
a fuzzy expert system,” _IEEE Transactions on Industrial Electronics_,
vol. 56, no. 5, pp. 1782–1792, May 2009.

[23] D. Du, L. Liu, and X. Du, “A low-cost attitude estimation system for
uav application,” in _Chinese Control and Decision Conference (CCDC)_,
May 2010, pp. 4489–4492.

[24] S. Lei, H. Chang-qiang, W. Xing-wei, and W. Wen-chao, “Research on
a new eight-accelerometer configuration for attitude angle calculation of
uav,” in _Chinese Control and Decision Conference (CCDC)_, May 2010,
pp. 4119–4123.

[25] W. YongLiang, W. TianMiao, L. JianHong, W. ChaoLei, and Z. Chen,
“Attitude estimation for small helicopter using extended kalman filter,”
in _IEEE Conference on Robotics, Automation and Mechatronics_, Sept.
2008, pp. 577–581.

[26] J. S. Jang and D. Liccardo, “Small uav automation using mems,” _IEEE_
_Aerosp. Electron. Syst. Mag_, vol. 22, no. 5, pp. 30–34, May 2007.

[27] D. Gebre-Egziabher, G. Elkaim, J. Powell, and B. Parkinson, “A
gyro-free quaternion-based attitude determination system suitable for
implementation using low cost sensors,” in _IEEE Position Location and_
_Navigation Symposium_, 2000, pp. 185–192.

[28] A. E. Hadri and A. Benallegue, “Sliding mode observer to estimate both
the attitude and the gyro-bias by using low-cost sensors,” in _IEEE/RSJ_
_International Conference on Intelligent Robots and Systems (IROS)_, Oct.
2009, pp. 2867–2872.

[29] J. Vaganay, M. Aldon, and A. Fournier, “Mobile robot attitude estimation
by fusion of inertial data,” in _Proc. IEEE International Conference on_
_Robotics and Automation_, vol. 1, May 1993, pp. 277–282.

[30] J.-C. Bazin, I. Kweon, C. Demonceaux, and P. Vasseur, “Uav attitude
estimation by vanishing points in catadioptric images,” in _IEEE Inter-_
_national Conference on Robotics and Automation (ICRA)_, May 2008,
pp. 2743–2749.

[31] H.-Z. Yuan, X.-Q. Zhang, and Z.-L. Feng, “Horizon detection in foggy
aerial image,” in _International Conference on Image Analysis and Signal_
_Processing (IASP)_, Apr. 2010, pp. 191–194.

[32] G. Pereira, P. Iscold, and L. Torres, “Airplane attitude estimation using
computer vision: simple method and actual experiments,” _Electronics_
_Letters_, vol. 44, no. 22, pp. 1303–1304, Oct. 2008.


