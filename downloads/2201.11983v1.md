1


## Inertial Navigation Using an Inertial Sensor Array

H˚akan Carlsson, _Student Member, IEEE,_ Isaac Skog, _Senior Member, IEEE_
Gustaf Hendeby, _Senior Member, IEEE_ and Joakim Jald´en, _Senior Member, IEEE_



_**Abstract**_ **—We present a comprehensive framework for fusing**
**measurements from multiple and generally placed accelerometers**
**and gyroscopes to perform inertial navigation. Using the angular**
**acceleration provided by the accelerometer array, we show that**
**the numerical integration of the orientation can be done with**
**second-order accuracy, which is more accurate compared to the**
**traditional first-order accuracy that can be achieved when only**
**using the gyroscopes. Since orientation errors are the most signifi-**
**cant error source in inertial navigation, improving the orientation**
**estimation reduces the overall navigation error. The practical**
**performance benefit depends on prior knowledge of the inertial**
**sensor array, and therefore we present four different state-space**
**models using different underlying assumptions regarding the**
**orientation modeling. The models are evaluated using a Lie**
**Group Extended Kalman filter through simulations and real-**
**world experiments. We also show how individual accelerometer**
**biases are unobservable and can be replaced by a six-dimensional**
**bias term whose dimension is fixed and independent of the**
**number of accelerometers.**


_**Index Terms**_ **—Inertial navigation, Inertial sensors, Accelerom-**
**eters, Gyroscopes, Extended Kalman Filter, Lie Groups, Dis-**
**cretization, Sensor arrays.**


I. I NTRODUCTION
# I NERTIAL navigation is the process of estimating thetraveled distance and orientation of an object by time
integration of measured velocities and accelerations [1]. Due
to the integrative nature of inertial navigation, the estimated
position and orientation do inherently accumulate errors over
time. This unbounded accumulation of position and orientation
errors can only be limited by including external information
from other sensor systems that provide an absolute reference
to the environment or by including motion constraints. For
instance, such aided inertial navigation has been done using
satellite [2], video [3], radio [4], LIDAR [5], and magnetic
field data [6]. Otherwise, the position and orientation errors’
growth rate can be reduced by decreasing the measurement
errors of the inertial sensors or using additional motion information such as Zero-velocity Updates (ZUPTs) [7]. Improving
the sensor hardware [8] reduces measurement errors, but
this typically comes with increasing cost and sensor size.
Another approach to reducing the measurement error is to
fuse the measurements from a redundant amount of inertial


H. Carlsson is with the Department of Intelligent Systems, KTH, e-mail:
hakcar@kth.se
I. Skog is with the Department of Electrical Engineering, LiU, e-mail:
isaac.skog@liu.se
G. Hendeby is with the Department of Electrical Engineering, LiU, e-mail:
gustaf.hendeby@liu.se
J. Jald´en is with the Department of Intelligent Systems, KTH, e-mail:
jalden@kth.se
This work was partially supported by the Wallenberg Autonomous Systems
and Software Program (WASP), and by the Swedish Foundation for Strategic
Research (SSF) via the project ASSEMBLE.



sensors to produce a virtual sensor with higher accuracy. In
particular, small Micro-Electro-Mechanical Systems (MEMS)based inertial sensors can be cheaply fabricated [9] and are
therefore suited for the construction of such sensor arrays [10],

[11].
Fusing measurements from multiple accelerometers dispersed on a rigid body for inertial navigation has a long
history [12]–[16]. When no gyroscopes are employed, this
system is usually referred to as an Gyroscope-free Inertial
Measurement Unit (GFIMU) or an accelerometer array. Since
an accelerometer array provides information on the angular
velocity and the angular acceleration, it can in principle replace
gyroscopes for orientation estimation. Omission of gyroscopes
for inertial navigation was in particular appealing for early
MEMS-based sensors, since early MEMS-gyroscopes had
inadequate performance and high energy consumption. However, the GFIMU cannot uniquely determine the instantaneous
angular velocity and for low dynamic rotational motion, the estimation error of the angular velocity is high [17]. The angular
acceleration also has to be time-integrated to unambiguously
estimate the angular velocity [18], which imposes an extra time
integration step compared to conventional inertial navigation.
The extra integration step increases the error growth rate with
an order of magnitude [19] and for certain configurations of the
accelerometer array the resulting non-linear Ordinary Differential Equation (ODE) has been reported to be unstable [13],

[20]. Mitigation of these problems can be achieved by placing
the accelerometers in intricate configurations [14], [19], [21]–

[23]. However, these configurations may impose infeasible
geometric constraints on the system. Another approach has
been to include a gyroscope to the GFIMU [24]–[28], a type of
sensor assembly referred hereto as an inertial sensor array. To
fuse the measurements from such an inertial sensor array, an
ML estimator was presented in [17]. However, the estimator
assumed calibrated sensors and used an iterative method to

solve a non-linear optimization problem.
In this work, we present a comprehensive framework for
fusing measurements from multiple and generally placed accelerometers and gyroscopes to perform inertial navigation.
The traditional inertial navigation equations are extended to
include the angular acceleration provided by the accelerometer array. The angular acceleration admits more accurate
numerical integration of the orientation with second-order
accuracy compared to the traditional first-order accuracy that
can be achieved when only using the gyroscopes [1]. Since
orientation errors are the most significant error source in
inertial navigation, improving the orientation estimation will
reduce the overall navigation error. To practically benefit from
the angular acceleration, estimated by the accelerometer array,
requires prior knowledge of the inertial sensor array. There

fore, we propose four state-space models, a.k.a mechanization
equations, using different underlying assumptions regarding
the time propagation of the orientation state. We evaluate these
models using a Lie group Kalman filter through simulations
and experiments [1] . Using the Kalman filter, we show that the
non linear problem of fusing the measurements of multiple
accelerometers and gyroscopes can be solved by Kalman
updates instead of using an iterative optimization method [17].
Moreover, the Kalman updates are also shown to stabilize
the potentially unstable ODE when integrating the angular
velocity. Finally, we note that individual accelerometer biases
in an accelerometer array are unobservable [28]. However, we
show that the individual accelerometer biases and the joint
accelerometer covariance matrix can be replaced by a sixdimensional bias term and a six-by-six covariance matrix. The
dimensions of these new terms are fixed and independent of
the number of accelerometers.


II. I NERTIAL N AVIGATION M ODELING


This section presents the inertial navigation equations. First,
we introduce the continuous-time equations for inertial sensor
arrays to provide a rigorous derivation of the second-order
integration of the orientation enabled by the array. Second, the
continuous-time equations are discretized, and sensor models
for accelerometers and gyroscopes are presented.


_A. Continuous-time Inertial Navigation Equations_


The inertial navigation equations describe a moving body’s
time evolution relative to a frame at rest [29]. This timeevolution or motion of the body is computed from measurements given by inertial sensors attached to the body.
By convention, the moving frame and the frame at rest
are denoted as the body frame and the navigation frame,
respectively. Assuming that the body moves at such speeds that
the Coriolis acceleration can be neglected, then the continuoustime equations for inertial navigation are given by [1]


˙
_R_ _[nb]_ = _R_ _[nb]_ [ _ω_ _[b]_ _×_ ] _,_ (1a)


˙
_p_ _[n]_ = _v_ _[n]_ _,_ (1b)


˙
_v_ _[n]_ = _g_ _[n]_ + _R_ _[nb]_ _s_ _[b]_ _._ (1c)


Here _p_ _[n]_ is the body’s position in the navigation frame, _v_ _[n]_

is the velocity, _g_ _[n]_ is the local gravity [2], _ω_ _[b]_ is the angular
velocity between the navigation frame and the body frame,
and _s_ _[b]_ is the specific force at the origin of the body frame.
The superscripts _n_ and _b_ denote the navigation and body
frame, respectively, and they indicate which coordinate frame
a quantity is expressed in. The rotation matrix between these
two frames is _R_ _[nb]_, which rotates a vector from the body frame
to the navigation frame. Further, [ _a×_ ] _b_ = _a × b_ is the skewsymmetric matrix form of the cross-product. In conventional
inertial navigation, the angular velocity _ω_ _[b]_ and the specific
force _s_ _[b]_ are measured by two sensor triads consisting of three


1 Reproducible research: The data and the code used in the simulations and
[the experiments are available at https://github.com/hcarlsso/Array-IN](https://github.com/hcarlsso/Array-IN)
2 The centrifugal acceleration due to the earth’s rotation is assumed to be
included in the local gravity vector [30].



2


orthogonal gyroscope and accelerometer sensors, respectively.
Then (1) is time-integrated to yield estimates of _R_ _[nb]_, _p_ _[n]_, and
_v_ _[n]_ . The location of the accelerometer triad defines the origin
of the body frame.
Assuming the body to be rigid and have multiple accelerometer triads geometrically dispersed on it, the specific force
observed by individual accelerometer triads will differ when
the rigid body undergoes a rotational motion [29]. The specific
force at a point not located in the origin of the body frame,
will have extra acceleration terms due to the centrifugal and
Euler accelerations. These extra acceleration terms contain

information about the rotation that can extend (1). Assuming
that an accelerometer triad is located at _r_ _k_ _[b]_ [, the specific force]
at _r_ _k_ _[b]_ [can then be related to the specific force at the origin of]
the body frame _s_ _[b]_ via [17]



as shown in Appendix A. Here _I_ _N_ is the identity matrix of
size _N_ . For the inverse in (5b) to be well defined, and in
_⊤_
general for the matrix � _A_ _[⊤]_ _ω_ ˙ _A_ _[⊤]_ _s_ � in (3) to have full rank,
at least _K ≥_ 3 accelerometer triads are required with positions
that span a 2D plane [17]. With _A_ ˙ _ω_ and _A_ _s_ defined by (5)



_f_ _k_ _[b]_ [=] _[ s]_ _[b]_ [ + [] _[ω]_ _[b]_ _[×]_ []] [2] _[r]_ _k_ _[b]_
~~�~~ ~~�~~ � ~~�~~
Centrifugal
acceleration



+ [ ˙ _ω_ _[b]_ _×_ ] _r_ _k_ _[b]_
~~����~~

Euler
acceleration



_._ (2)



Here ˙ _ω_ _[b]_ is the angular acceleration of the rigid body. Since

[ ˙ _ω_ _[b]_ _×_ ] _r_ _k_ _[b]_ [=] _[ −]_ [[] _[r]_ _k_ _[b]_ _[×]_ [] ˙] _[ω]_ _[b]_ [, it is noted that (2) is linear in] _[ s]_ _[b]_

and ˙ _ω_ _[b]_ . Thus, by concatenating the measurements from _K_
accelerometer triads using (2) a differential equation for ˙ _ω_ _[b]_

and _s_ _[b]_ can be obtained as [12], [14]–[16], [19], [31]



˙ _b_
_ω_

_s_ _[b]_

�



_A_ ˙ _ω_
� = � _A_ _s_



_f_ _[b]_ _−_ _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [)] � _,_ (3)
��



where _r_ 1: _[b]_ _K_ [≜] _[{][r]_ _k_ _[b]_ _[}]_ _[K]_ _k_ =1 [,]





 _._ (4)





 _,_ and _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [)][ ≜]



 [ _ω_ _[b]_ _×_ ] [2] _r_ 1 _[b]_

...

[ _ω_ _[b]_ _×_ ] [2] _r_ _K_ _[b]_



_f_ _[b]_ ≜









_f_ 1 _[b]_

...
_f_ _K_ _[b]_







The matrices _A_ ˙ _ω_ and _A_ _s_ are functions of the accelerometer
positions _r_ _k_ _[b]_ [and are further specified in Appendix A. The]
interpretation of (3) is that the difference in the specific force
at _r_ _k_ _[b]_ [and the centrifugal acceleration can be projected onto]
two different sub-spaces containing ˙ _ω_ _[b]_ and _s_ _[b]_, respectively.
If it can be assumed that the accelerometer positions _r_ _k_ _[b]_ [are]
centered in the body frame, i.e., [�] _[K]_ _k_ =1 _[r]_ _k_ _[b]_ [= 0][, then] _[ A]_ [ ˙] _[ω]_ [ and]
_A_ _s_ become


_A_ ˙ _ω_ ≜ � _A_ 1 _· · ·_ _A_ _K_ � _,_ _A_ _s_ ≜ [1] � _I_ 3 _· · ·_ _I_ 3 � _,_ (5a)

_K_


where



� _−_ 1




[ _r_ _k_ _[b]_ _[×]_ []] _[,]_ (5b)



_A_ _k_ ≜



_K_
�
� _i_ =1



�[ _r_ _i_ _[b]_ _[×]_ []] _[⊤]_ [[] _[r]_ _i_ _[b]_ _[×]_ []]


_i_ =1


and [�] _[K]_ _k_ =1 _[r]_ _k_ _[b]_ [= 0][, it is also shown in Appendix A that the]
differential equations in (3) decouple and become



˙
_ω_ _[b]_ =



_K_
� _A_ _k_ � _f_ _k_ _[b]_ _[−]_ [[] _[ω]_ _[b]_ _[×]_ []] [2] _[r]_ _k_ _[b]_ � _,_ (6a)


_k_ =1



3


_I_ 3 _,_ det _R_ = 1 _}_ . That is, the orthogonality and determinant
constraints impose _SO_ (3) to be a 3-dimensional manifold
embedded in R [3] _[×]_ [3] . However, noting that _SO_ (3) is a matrix
Lie group, Lie theory can be employed to integrate _R_ and
discretize (1a). Instead of integrating in R [3] _[×]_ [3], the integration
is performed in the tangent space to _R_, also called the Lie
algebra, which is isomorphic to R [3] . For sufficiently small _T_
the solution to (1a) is [33]


_R_ ( _t_ + _T_ ) = _R_ ( _t_ ) exp _[∧]_ _SO_ (3) [(] _[θ]_ [(] _[T]_ [))] (9)


where exp _[∧]_ _SO_ (3) [is the matrix exponential map from][ R] [3] [ to]
_SO_ (3) [34]. Further, _θ_ ( _T_ ) is a vector found as the solution to


_θ_ ˙( _τ_ ) = Γ( _θ_ ( _τ_ )) _ω_ ( _t_ + _τ_ ) _,_ _θ_ (0) = 0 _,_ (10)


where



_s_ _[b]_ = [1]

_K_



_K_
� _f_ _k_ _[b]_ _[.]_ (6b)


_k_ =1



Hence, _s_ _[b]_ becomes independent of _ω_ _[b]_ . Equation (6b) could
equivalently been derived by taking the mean of (2) and
assuming [�] _[K]_ _k_ =1 _[r]_ _k_ _[b]_ [= 0][.]
It has been reported that for certain arrangements of the
accelerometer positions and orientations the non linear ODE
in (6a) and (3) are unstable [12], [13], [20]. Since a gyroscope
triad measures the angular velocity, a feedback law using _ω_ _[b]_

can be introduced to (6a) as



1
�� _∥θ∥_ [2] [[] _[θ][×]_ []] [2] _[.]_




_[θ][∥]_ _∥θ∥_

2 [cot] � 2



2



(11)
In the navigation literature, Γ( _θ_ ( _t_ )) is also known as the Bortz
equation [35]–[37]. The physical interpretation of (9) is that _θ_
can be considered an orientation deviation or perturbation of
_R_ ( _t_ ). The vector _θ_ can also be interpreted as a rotation vector
that rotates _R_ ( _t_ ). For _τ ∈_ [0 _, T_ ], the solution to (10) is given
by the Taylor series

_θ_ ( _T_ ) = _θ_ (0) + _θ_ [˙] (0) _T_ + _θ_ [¨] (0) _[T]_ [ 2] (12)

2 [+] _[ O]_ [(] _[T]_ [ 3] [)] _[.]_


Thus the approximate solution to the integration problem in
(10) is given by calculating the time-derivatives of _θ_ ( _τ_ ) and
Γ( _θ_ ( _τ_ )). In Appendix B, it is shown that (12) is equal to

_θ_ ( _T_ ) = _ω_ ( _t_ ) _T_ + ˙ _ω_ ( _t_ ) _[T]_ [ 2] (13)

2 [+] _[ O]_ [(] _[T]_ [ 3] [)] _[.]_


This result was also used in [38] to integrate the rotation matrix
while including the second-order term, i.e., ˙ _ω_ . Note again that
in conventional inertial navigation using an accelerometer and
gyroscope triad the second-order term would not be used due
to the absence of direct measurements of ˙ _ω_ .

The discretized propagation equations for the navigation
state are obtained by omitting the higher-order terms in the
Taylor series. With a slight abuse of notation, we define the
discrete samples as _R_ _n_ ≜ _R_ ( _t_ ) and _R_ _n_ +1 ≜ _R_ ( _t_ + _T_ ), and
the other variables similarly. The discretized equations for the
navigation state then become



Γ( _θ_ ) = _I_ 3 + [1]




[1] 1 _−_ _[∥][θ][∥]_

2 [[] _[θ][×]_ [] +] � 2



˙
_ω_ _[b]_ =



_K_
� _A_ _k_ � _f_ _k_ _[b]_ _[−]_ [[] _[ω]_ _[b]_ _[×]_ []] [2] _[r]_ _k_ _[b]_ � _−_ _Lω_ _[b]_ _,_ (7)


_k_ =1



for a matrix _L_ . The matrix _L_ can be designed as _L_ =
diag( _l_ _x_ _, l_ _y_ _, l_ _z_ ), and for sufficiently high _l_ _i_, the poles in (7)
can be placed in the left-hand plane [32]. Thus, by providing
feedback from a gyroscope triad the potentially unstable ODE
in (6a) can be stabilized.
In summary, using an accelerometer array with multiple
accelerometers triads dispersed on a rigid body, the inertial
navigation equations in (1) can be extended with (6). Since
the angular acceleration can, via (6a), be estimated only using
the accelerometer triad measurements, it is strictly speaking
not necessary to include a gyroscope triad for estimation of
the rotation matrix in (1a). However, by including information
from a gyroscope triad, the ODE is ensured to be stable.


_B. Discretized Inertial Navigation Equations_


The continuous-time equations need to be discretized before implementation. When discretizing the traditional inertial
navigation equations in (1) it is commonly assumed that the
angular velocity and the specific force are constant between
each sample instant [1]. However, since the inertial sensor
array also provides an estimate of the angular acceleration,
the discretization of the rotation matrix in (1a) can instead
be based on the assumption of constant angular acceleration.
For the angular velocity, position, and velocity, which are
expressed in Euclidean vector-spaces, the discretization can
be found by truncating the Taylor series given by


_ω_ ( _t_ + _T_ ) = _ω_ ( _t_ ) + ˙ _ω_ ( _t_ ) _T_ + _O_ ( _T_ [2] ) _,_ (8a)

_p_ ( _t_ + _T_ ) = _p_ ( _t_ ) + _v_ ( _t_ ) _T_ + ˙ _v_ ( _t_ ) _[T]_ [ 2] (8b)

2 [+] _[ O]_ [(] _[T]_ [ 3] [)] _[,]_

_v_ ( _t_ + _T_ ) = _v_ ( _t_ ) + ˙ _v_ ( _t_ ) _T_ + _O_ ( _T_ [2] ) _._ (8c)


Here the superscripts related to the different frames have been
omitted for notational brevity. Further, _t_ and _T_ denote the time
and discretization (sample) period, respectively. Moreover,
_O_ ( _T_ _[n]_ ) denotes _n_ :th and higher-order terms of _T_ . However,
integration by Taylor expansion is not possible for the rotation
matrix _R_, since it belongs to _SO_ (3) = _{R ∈_ R [3] _[×]_ [3] : _R_ _[⊤]_ _R_ =



_,_ (14a)
�



_R_ _n_ +1 = _R_ _n_ exp _[∧]_ _SO_ (3)



_T_ [2]
� _ω_ _n_ _T_ + ˙ _ω_ _n_ 2



_ω_ _n_ +1 = _ω_ _n_ + ˙ _ω_ _n_ _T,_ (14b)

_p_ _n_ +1 = _p_ _n_ + _v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2] (14c)

2 _[,]_

_v_ _n_ +1 = _v_ _n_ + ( _g_ + _R_ _n_ _s_ _n_ ) _T._ (14d)


Here, the navigation equations for the inertial sensor array
are propagated by the specific force _s_ _n_ and the angular acceleration ˙ _ω_ _n_ . Assuming that the angular velocity is constant,
that is ˙ _ω_ _n_ = 0, and removing (14b), then (14) reduces to the
conventional discretized inertial navigation equations [1].


_C. Accelerometer Sensor Model_


The accelerometer sensors are assumed to be calibrated in

terms of scale factors, misalignment, and cross-coupling [39].
Further, the _k_ :th accelerometer triad’s measurements at timeinstant _n_ are assumed to be corrupted by white noise and
a slowly time-varying bias [40]. That is, the accelerometer
measurements _y_ _k,n_ [(][a][)] [are modeled as]

_y_ _k,n_ [(][a][)] [=] _[ f]_ _[k,n]_ [ +] _[ b]_ [(] _k,n_ [a][)] [+] _[ w]_ _k,n_ [(][a][)] _[,]_ (15a)

_b_ [(] _k,n_ [a][)] +1 [=] _[ b]_ [(] _k,n_ [a][)] [+] _[ w]_ _k,n_ [(] _[b,]_ [a][)] _[,]_ (15b)

Here _b_ [(] _k,n_ [a][)] [,] _[ w]_ _k,n_ [(][a][)] [and] _[ w]_ _k_ [(] _[b,]_ [a][)] denote the accelerometer triad’s
bias, measurement noise, and driving bias noise, respectively.
The noise terms _w_ _k,n_ [(][a][)] [and] _[ w]_ _k,n_ [(] _[b,]_ [a][)] [are assumed to be zero mean,]
uncorrelated in time, uncorrelated with each others, and have
covariances _Q_ [(] _k_ [a][)] and _Q_ [(] _k_ _[b,]_ [a][)], respectively.
Since the accelerometer triads’ measurements only enter the
navigation equations through weighted sums in the terms for
the specific force _s_ _n_ and the angular acceleration ˙ _ω_ _n_ in (6), the
individual accelerometer biases _b_ [(] _k,n_ [a][)] [will not be observable. To]
see this, inserting (15a) into (3) yields

_ω_ ˙ _n_ _A_ ˙ _ω_

=

� _s_ _n_ � � _A_ _s_ �� _y_ _n_ [(][a][)] _[−]_ _[b]_ [(] _n_ [a][)] _[−]_ _[w]_ _n_ [(][a][)] _[−]_ _[h]_ [(] _[ω]_ _[n]_ _[, r]_ [1:] _[K]_ [)] � (16)



4


where the new driving bias noise terms _w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)] and _w_ _n_ [(] _[b,s]_ [)] are
introduced. The transformation in (18) will cause a correlation
between _w_ _n_ [( ˙] _[ω]_ [)] and _w_ _n_ [(] _[s]_ [)] [. The joint covariance of for] _[ w]_ _n_ [( ˙] _[ω]_ [)] and
_w_ _w_ [(] _[s]_ [)] is



_w_ ( ˙ _ω_ )
Cov
�� _w_ [(] _[s]_ [)]



= _A_ ˙ _ω_ _Q_ (a) _A_ _⊤ω_ ˙ _A_ ˙ _ω_ _Q_ [(][a][)] _A_ _[⊤]_ _s_
�� � _A_ _s_ _Q_ [(][a][)] _A_ _[⊤]_ _ω_ ˙ _A_ _s_ _Q_ [(][a][)] _A_ _[⊤]_ _s_



_._ (21)
�



The joint covariance for the new terms _w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)] and _w_ _w_ [(] _[b,s]_ [)]
can be derived analogously. From (19), we note first that
the dimension of the new bias and noise terms are 6 and

independent of _K_ . Second, it can be noted that the covariance
matrix _Q_ [(] _[a]_ [)] that is used to propagate (3) is replaced with the
covariance matrix in (21). The former has size 3 _K ×_ 3 _K_ and
the latter has size 6 _×_ 6, meaning that the same noise structure
can be represented with fewer elements.
Moreover, given the assumption of centered accelerometer
positions, i.e., [�] _r_ _k_ = 0, and assuming that _Q_ [(][a][)] = _σ_ _a_ [2] _[I]_ [3] _[K]_ [,]
then (21) simplifies to



_w_ ( ˙ _ω_ )
Cov
�� _w_ [(] _[s]_ [)]



= _σ_ _a_ [2]
��



_−_ 1
_K_
_k_ =1 [[] _[r]_ _[k]_ _[×]_ []] _[⊤]_ [[] _[r]_ _[k]_ _[×]_ []] 0 3 _,_ 3
�
��� 0 3 _,_ 3 _K_ 1 _[I]_ [3]



�



_._



_A_ ˙ _ω_
� = � _A_ _s_



_y_ _n_ [(][a][)] _[−]_ _[b]_ [(] _n_ [a][)] _[−]_ _[w]_ _n_ [(][a][)] _[−]_ _[h]_ [(] _[ω]_ _[n]_ _[, r]_ [1:] _[K]_ [)] (16)
�� �



where


≜
_y_ _n_ [(][a][)]



_y_ 1 [(][a] _,n_ [)]

...
_y_ _K,n_ [(][a][)]



(22)
In this case, the cross-correlation terms vanish. Further, it
can be observed that the covariance of _w_ [(] _[s]_ [)] is inversely
proportional to the number of accelerometer triads in the array
and independent of the geometry. This is the same result as
obtained in [17], and the covariance for the specific force is
the same as the Cram´er-Rao lower bound. Moreover, assuming
that the accelerometer triads are mounted in a planar square
grid with spacing _α_, the covariance for _w_ [( ˙] _[ω]_ [)] is inversely
proportional to _α_ [2], also a conclusion reached in [17].


_D. Gyroscope Sensor Model_


The gyroscopes sensors are, similarly to the accelerometer
sensors, assumed to be assembled in triads, and measure the
angular velocity in three orthogonal directions. Moreover, the
gyroscopes are also assumed to be calibrated in terms of
scale factors, misalignment, and cross-coupling [39]. Since
the angular velocity is identical for all points on a rigid
body [29], the measurements from multiple geometrically
dispersed gyroscope triads can be fused to create an equivalent
virtual gyroscope triad [41]. Hence, for the purpose of this
work, it can without loss of generality be assumed that there
is only one gyroscope triad in the inertial sensor array. The
measurements _y_ _n_ [(][g][)] from the equivalent virtual gyroscope triad
can be modeled as


_y_ _n_ [(][g][)] = _ω_ _n_ + _b_ [(] _n_ [g][)] [+] _[ w]_ _n_ [(][g][)] _[,]_ (23a)

_b_ [(] _n_ [g] +1 [)] [=] _[ b]_ _n_ [(][g][)] [+] _[ w]_ _n_ [(] _[b,]_ [g][)] _._ (23b)


Here _b_ [(][g][)], _w_ [(][g][)] and _w_ [(] _[b,]_ [g][)] are the gyroscope triad’s bias,
measurement noise, and driving bias noise, respectively. The
noise terms _w_ _n_ [(][g][)] and _w_ [(] _[b,]_ [g][)], are assumed to be zero mean,
uncorrelated in time, and have covariances _Q_ [(][g][)] and _Q_ [(] _[b,]_ [g][)],
respectively.





 _._ (17)



_w_ 1 [(][a] _,n_ [)]



...
_w_ [(][a][)]

 _K,n_





_,_ _w_ _n_ [(][a][)] [≜]




_b_ [(] 1 [a] _,n_ [)]



...
_b_ [(][a][)]

 _K,n_











_,_ _b_ [(] _n_ [a][)] [≜]




From (16), it is observed that _s_ _n_ and ˙ _ω_ _n_ depend on the
vectors _b_ [(][a][)] and _w_ _n_ [(][a][)] only through the projection matrix
� _A_ _[⊤]_ _ω_ ˙ _A_ _[⊤]_ _s_ � _⊤_ _∈_ R 6 _×_ 3 _K_ defined in (5). The projection matrix
has full rank when _K ≥_ 3 and when the accelerometer
triads span a 2D plane [17]. If the full rank assumption is
fulfilled, the vectors _b_ [(][a][)] _∈_ R [3] _[K]_ and _w_ _n_ [(][a][)] _[∈]_ [R] [3] _[K]_ [ are projected]
to the lower dimensional subspace R [6], meaning that there
exists 3 _K −_ 6 dimensional subspaces of _b_ [(][a][)] and _w_ _n_ [(][a][)] that are
unobservable. The dimension of the state-vector can thus be

reduced to decrease the computational complexity and this also
solves the problem of unobservable bias terms for individual
accelerometers [28]. Similarly, the noise vector _w_ _n_ [(] _[a]_ [)] can be
reduced. Define the new bias terms _b_ [( ˙] _[ω]_ [)] and _b_ [(] _[s]_ [)] and the new
noise terms _w_ [( ˙] _[ω]_ [)] and _w_ [(] _[s]_ [)] as
� _bb_ _n_ [( ˙][(] _n_ _[ω][s]_ [)][)] � ≜ _−_ � _AA_ ˙ _ωs_ � _b_ [(] _n_ [a][)] _[,]_ � _ww_ _n_ [( ˙] _n_ [(] _[ω][s]_ [)][)] � ≜ _−_ � _AA_ ˙ _ωs_ � _w_ _n_ [(][a][)] _[.]_ (18)



�



�



≜ _−_ _A_ ˙ _ω_
� _A_ _s_



_b_ [(] _n_ [a][)] _[,]_
�



_w_ _n_ [( ˙] _[ω]_ [)]
_w_ _n_ [(] _[s]_ [)]
�



≜ _−_ _A_ ˙ _ω_
� _A_ _s_



_w_ _n_ [(][a][)] _[.]_ (18)
�



Then (16) can be rewritten as

_ω_ ˙ _n_ _A_ ˙ _ω_
� _s_ _n_ � = � _A_ _s_ �� _y_ _n_ [(][a][)] _[−]_ _[h]_ [(] _[ω]_



�



_A_ ˙ _ω_
� = � _A_ _s_



_y_ _n_ [(][a][)] _[−]_ _[h]_ [(] _[ω]_ _[n]_ _[, r]_ [1:] _[K]_ [)] +
�� �



_b_ [( ˙] _n_ _[ω]_ [)]
_b_ [(] _n_ _[s]_ [)]
� �



+



_w_ _n_ [( ˙] _[ω]_ [)]
_w_ _n_ [(] _[s]_ [)]
�



_,_



(19)
where the function _h_ is given in (3). The propagation equation
for the new bias terms are


_b_ [( ˙] _n_ _[ω]_ +1 [)] [=] _[ b]_ _n_ [( ˙] _[ω]_ [)] + _w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)] _,_ (20a)

_b_ [(] _n_ _[s]_ +1 [)] [=] _[ b]_ _n_ [(] _[s]_ [)] [+] _[ w]_ _n_ [(] _[b,s]_ [)] _,_ (20b)


III. I NERTIAL S ENSOR A RRAY N AVIGATION E QUATIONS


This section presents the discretized inertial navigation
equations and the sensor models combined into different statespace models. The models are constructed based on specific
assumptions on the prior knowledge of the inertial sensor
array. This section is concluded with a discussion on the
advantages and disadvantages of the different models.


_A. State-Space Models_


In the inertial sensor array, both the accelerometer array
measurements and the gyroscope measurements can be used to
estimate the angular velocity. The accelerometer array achieves
this through time-integration of the angular acceleration, and
the gyroscopes measure it directly. Since orientation estimation
is an essential part of the inertial navigation process that
amounts to time-integration of the angular velocity, we can
either choose to use the accelerometer array, the gyroscope,
or fuse both to estimate the orientation. Here, we present
four different discrete state-space models shown in Fig. 1 of
how to perform inertial navigation with an accelerometer array
and a gyroscope triad, using different underlying assumptions
regarding the time propagation of the orientation state.
In the first state-space model in (24), we incorporate all
available information from both the accelerometer array and
the gyroscope triad by collecting (14), (19), (20), and (23). In
this model, the accelerometer array measurements are used to
compute the angular acceleration, which propagates both the
angular velocity and the rotation matrix using a 1st order and a
2nd order term, respectively. This is analogous to the specific
force propagating the velocity and the position in (14d) and
(14c). Thanks to the 2nd order term, the model is 2nd order
accurate in the numerical integration of the rotation matrix.
This model in (24) is from heron referred to as the _2nd order_
_accelerometer array_ model.
If the accelerometer array is not sufficiently calibrated in
terms of accelerometer positions, scale factors, misalignment,
or cross-coupling, the estimation error of the angular acceleration might be prohibitively high. There are two ways of
reducing the impact of a high estimation error in the angular
acceleration in this case. First, the rotation matrix could be
propagated only using a first-order term, which could be
more accurate even though the numerical integration is now
only 1st order accurate. This model is denoted the _1st order_
_accelerometer array_ model and is shown in (25). The second
option is to omit the propagation of the angular velocity
while keeping the 2nd order term for the rotation matrix.
This is possible since the angular acceleration in (6a) can be
computed with the angular velocity given by the gyroscope
measurements instead. The integration of the rotation matrix
is thus 2nd order accurate, and this model is denoted as the
_2nd order gyroscope_ model and is shown in (26). Here it is
noted that the angular acceleration bias _b_ [( ˙] _[ω]_ [)] is not propagated,
since that would include two bias terms for the propagation of
_R_ _n_ in (26a), and would thus not be observable. But we could
have also omitted the gyroscope bias _b_ [(] _n_ [g][)] and kept _b_ [( ˙] _n_ _[ω]_ [)] [.]
Moreover, the standard inertial navigation assumption could
also be used, that is, the rotation matrix is propagated only



5


using a 1st order term which is given by the gyroscopes. This
model is denoted as the _1st order gyroscope_ model and is
shown in (27). The only difference between this model and the
standard inertial navigation equations is that the specific force
is now calculated using the mean value of the accelerometer

measurements.


_B. Discussion on State-Space Models_


The main difference between the accelerometer array and
gyroscope state-space models is whether the angular velocity
is propagated or not in the navigation equations. In the
accelerometer array models, the accelerometer array measurements are the sole input to the inertial navigation process
and used both for calculating the translational and rotational
changes. Hence, (24a) to (24i) and (25a) to (25i) can be
used to realize a GFIMU inertial navigation system [14], [16],

[20], [31]. The accelerometer array models could thus be used
for high dynamic applications where gyroscopes usually saturate [42], [43]. If rotational information from gyroscopes are
to be included this must be done via some filtering framework,
such as the Kalman filter. In that case, (24a) to (24i) and (25a)
to (25i), describe the system dynamics and (24j) and (25j)
the observation equation of the state-space model used in the
filtering process. A natural consequence of using the Kalman
filter is that accelerometer and gyroscope measurements are
fused using Kalman updates that have a fixed amount of
computations. This is not the case for the current state-ofthe-art method that fuses the accelerometer and gyroscope
measurements by solving a non linear optimization problem
using an iterative method [17]. The Kalman updates will also
function as a feedback mechanism on _ω_, which has the added
benefit of stabilizing the potentially unstable continuous-time
equation in (7) [13], [20]. Moreover, it is also possible to
fuse the gyroscope and accelerometer array measurements for
orientation estimation without Kalman updates as shown in the
2nd order gyroscope model. However, the gyroscope models
will not work when the gyroscopes saturate.


IV. K ALMAN F ILTER FOR A RRAY I NERTIAL N AVIGATION


An inertial navigation solution is usually used in conjunction with other sensor systems. In this case, the sensor
measurements are fused in a filtering framework, which is
the topic of this section. Since the rotation matrix belongs
to _SO_ (3), we present a Lie group Kalman filter for inertial
navigation using the state-space models presented in Fig. 1.
The filter equations for a general matrix Lie group are first
presented, and then the specific equations for the 2nd order
accelerometer array state-space model in (24) are presented.
From this model, the other state-space models follow naturally.


_A. Discrete Lie Group Extended Kalman Filter_


Since the rotation matrix belongs to _SO_ (3) the standard
Kalman filter cannot be directly used with the state-space
models in Fig. 1. Here we instead employ the Discrete LieGroup Extended Kalman Filter (D-LG-EKF) [44] that explicitly considers the non-Euclidean geometry of _SO_ (3). Since


6



**2nd order accelerometer array state-space model**



(24a)
�



**1st order accelerometer array state-space model**


_R_ _n_ +1 = _R_ _n_ exp _[∧]_ _SO_ (3) [(] _[ω]_ _[n]_ _[T]_ [)] (25a)


_ω_ _n_ +1 = _ω_ _n_ + ˙ _ω_ _n_ _T_ (25b)

_p_ _n_ +1 = _p_ _n_ + _v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2] (25c)

2

_v_ _n_ +1 = _v_ _n_ + ( _g_ + _R_ _n_ _s_ _n_ ) _T_ (25d)

_b_ [( ˙] _n_ _[ω]_ +1 [)] [=] _[ b]_ _n_ [( ˙] _[ω]_ [)] + _w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)] (25e)

_b_ [(] _n_ _[s]_ +1 [)] [=] _[ b]_ _n_ [(] _[s]_ [)] [+] _[ w]_ _n_ [(] _[b,s]_ [)] (25f)

_b_ [(] _n_ [g] +1 [)] [=] _[ b]_ _n_ [(][g][)] [+] _[ w]_ _n_ [(] _[b,]_ [g][)] (25g)

_ω_ ˙ _n_ = _b_ [( ˙] _n_ _[ω]_ [)] + _w_ _n_ [( ˙] _[ω]_ [)] + � _A_ _k_ ( _y_ _k,n_ [(][a][)] _[−]_ [[] _[ω]_ _[n]_ _[×]_ []] [2] _[r]_ _[k]_ [)] (25h)


_k_



_R_ _n_ +1 = _R_ _n_ exp _[∧]_ _SO_ (3)



_T_ [2]
� _ω_ _n_ _T_ + ˙ _ω_ _n_ 2



_ω_ _n_ +1 = _ω_ _n_ + ˙ _ω_ _n_ _T_ (24b)

_p_ _n_ +1 = _p_ _n_ + _v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2] (24c)

2

_v_ _n_ +1 = _v_ _n_ + ( _g_ + _R_ _n_ _s_ _n_ ) _T_ (24d)

_b_ _n_ [( ˙] _[ω]_ +1 [)] [=] _[ b]_ _n_ [( ˙] _[ω]_ [)] + _w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)] (24e)

_b_ [(] _n_ _[s]_ +1 [)] [=] _[ b]_ _n_ [(] _[s]_ [)] [+] _[ w]_ _n_ [(] _[b,s]_ [)] (24f)

_b_ [(] _n_ [g] +1 [)] [=] _[ b]_ _n_ [(][g][)] [+] _[ w]_ _n_ [(] _[b,]_ [g][)] (24g)

_ω_ ˙ _n_ = _b_ _n_ [( ˙] _[ω]_ [)] + _w_ _n_ [( ˙] _[ω]_ [)] + � _A_ _k_ ( _y_ _k,n_ [(][a][)] _[−]_ [[] _[ω]_ _[n]_ _[×]_ []] [2] _[r]_ _[k]_ [)] (24h)


_k_



_s_ _n_ = _b_ [(] _n_ _[s]_ [)] [+] _[ w]_ _n_ [(] _[s]_ [)] + _K_ [1]



� _y_ _k,n_ [(][a][)] (24i)


_k_



� _y_ _k,n_ [(][a][)] (25i)


_k_



_s_ _n_ = _b_ [(] _n_ _[s]_ [)] [+] _[ w]_ _n_ [(] _[s]_ [)] + _K_ [1]



_y_ _n_ [(][g][)] = _ω_ _n_ + _b_ [(] _n_ [g][)] [+] _[ w]_ _n_ [(][g][)] (24j)


**2nd order gyroscope state-space model**



(26a)
�



_y_ _n_ [(][g][)] = _ω_ _n_ + _b_ [(] _n_ [g][)] [+] _[ w]_ _n_ [(][g][)] (25j)


**1st order gyroscope state-space model**


_R_ _n_ +1 = _R_ _n_ exp _[∧]_ _SO_ (3) [(] _[ω]_ _[n]_ _[T]_ [)] (27a)

_p_ _n_ +1 = _p_ _n_ + _v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2] (27b)

2

_v_ _n_ +1 = _v_ _n_ + ( _g_ + _R_ _n_ _s_ _n_ ) _T_ (27c)

_b_ [(] _n_ _[s]_ +1 [)] [=] _[ b]_ [(] _n_ _[s]_ [)] [+] _[ w]_ _n_ [(] _[b,s]_ [)] (27d)

_b_ [(] _n_ [g] +1 [)] [=] _[ b]_ _n_ [(][g][)] [+] _[ w]_ _n_ [(][g,b][)] (27e)



_R_ _n_ +1 = _R_ _n_ exp _[∧]_ _SO_ (3)



_T_ [2]
� _ω_ _n_ _T_ + ˙ _ω_ _n_ 2



_p_ _n_ +1 = _p_ _n_ + _v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2] (26b)

2

_v_ _n_ +1 = _v_ _n_ + ( _g_ + _R_ _n_ _s_ _n_ ) _T._ (26c)

_b_ [(] _n_ _[s]_ +1 [)] [=] _[ b]_ _n_ [(] _[s]_ [)] [+] _[ w]_ _n_ [(] _[b,s]_ [)] (26d)

_b_ [(] _n_ [g] +1 [)] [=] _[ b]_ _n_ [(][g][)] [+] _[ w]_ _n_ [(][g,b][)] (26e)



� _y_ _k,n_ [(][a][)] _[−]_ _[w]_ _k,n_ [(][a][)] (27f)


_k_



_s_ _n_ = _b_ [(] _n_ _[s]_ [)] [+] _K_ [1]



� _y_ _k,n_ [(][a][)] _[−]_ _[w]_ _k,n_ [(][a][)] (26f)


_k_



_s_ _n_ = _b_ [(] _n_ _[s]_ [)] [+] _K_ [1]



_ω_ _n_ = _y_ _n_ [(][g][)] _[−]_ _[b]_ _n_ [(][g][)] _[−]_ _[w]_ _n_ [(][g][)] (26g)



_ω_ _n_ = _y_ _n_ [(][g][)] _[−]_ _[b]_ [(] _n_ [g][)] _[−]_ _[w]_ _n_ [(][g][)] (27g)



_ω_ ˙ _n_ = � _A_ _k_ ( _y_ _k,n_ [(][a][)] _[−]_ _[w]_ _k,n_ [(][a][)] _[−]_ [[] _[ω]_ _[n]_ _[×]_ []] [2] _[r]_ _[k]_ [)] (26h)


_k_


Fig. 1. Equations for the four proposed state-space models for inertial navigation using an inertial sensor array. The 2nd order models have a 2nd order term
in the propagation of the rotation matrix in (24a) and (26a), while the 1st order models in (25a) and (27a) have a 1st order term. The accelerometer array
models propagate the angular velocity in (24b) and (25b) using the angular acceleration computed from the accelerometer measurements in (24h) and (25h).
The gyroscope models estimate the angular velocity directly using (26g) and (27g).



R _[N]_ can be embedded into a matrix, the Euclidean space is
also a matrix Lie group [34]. And since the composition of
matrix Lie groups also is a matrix Lie group, we only present
the D-LG-EKF for a single matrix Lie group _G_ . The D-LGEKF reduces to the standard Extended Kalman Filter (EKF)
when _G_ is the Euclidean space [44].
The D-LG-EKF framework is based on the concept of
concentrated Gaussian distributions on Lie groups [45]. The
random variable _X_ defined on the Lie group _G_ has a Gaussian
distribution with almost all of its probability mass concentratedin a small neighborhood around the mean _X_ ˆ, so that the
probability distribution is effectively contained in the Lie
algebra to _X_ [ˆ] . Since the Lie algebra is isomorphic to R _[N]_ _[x]_,



the Gaussian distribution can be represented by the Euclidean
random variable _e ∼N_ (0 _N_ _x_ _,_ 1 _, P_ ) where _P ∈_ R _[N]_ _[x]_ _[×][N]_ _[x]_ is a
covariance matrix. Here 0 _N,M_ is the zero matrix with _N_ rows
and _M_ columns. The concentrated Gaussian distribution on _G_

is then defined as


_X_ = _X_ [ˆ] exp _[∧]_ _G_ [(] _[e]_ [)] _[ .]_ (28)


Next, it is assumed in the D-LG-EKF framework that the statespace model is in the form


_X_ _n_ +1 = _X_ _n_ exp _[∧]_ _G_ Ω( _X_ _n_ _, u_ _n_ _, w_ _n_ [(][p][)] [)] _,_ (29a)
� �

_Y_ _n_ = _η_ ( _X_ _n_ ) exp _[∧]_ _G_ _[′]_ _w_ _n_ [(][m][)] _,_ (29b)
� �


where _w_ _n_ [(][p][)] _∈_ R _[N]_ _[p]_ is the process noise, _w_ _n_ [(][m][)] _∈_ R _[N]_ _[m]_ is
the measurement noise, and _u_ _n_ _∈_ R _[N]_ _[u]_ is the input. The
propagation function is Ω: _G ×_ R _[N]_ _[u]_ _×_ R _[N]_ _[p]_ _→_ R _[N]_ _[x]_ and
the measurement function is _η_ : _G →_ _G_ _[′]_, as given by, e.g.,
(24). Next, it is assumed that the state estimate of _X_ _n_ to
be a concentrated Gaussian with mean _X_ [ˆ] _n|n_ and covariance
_P_ _n|n_ according to (28), and that _w_ _n_ [(][p][)] _∼N_ (0 _, Q_ [(][p][)] ) and
_w_ _n_ [(][m][)] _∼N_ (0 _, Q_ [(][m][)] ). Then, the propagation equations for the
mean and the covariance are

_X_ ˆ _n_ +1 _|n_ = ˆ _X_ _n|n_ exp _[∧]_ _G_ �ˆΩ _n_ � (30a)

_P_ _n_ +1 _|n_ = _F_ _n_ _P_ _n|n_ _F_ _n_ _[⊤]_ [+] _[ G]_ _[n]_ _[Q]_ [(][p][)] _[G]_ _[⊤]_ _n_ (30b)


where


ˆΩ _n_ = Ω( ˆ _X_ _n|n_ _, u_ _n_ _,_ 0) _,_ (31a)

_F_ _n_ = Ad _G_ (exp _[∧]_ _G_ �Ω [ˆ] _n_ + Φ _n_ (Ω [ˆ] _n_ ) _J_ _n_ [(] _[x]_ [)] _[,]_ (31b)
� � ��

_G_ _n_ = Φ _G_ (Ω [ˆ] _n_ ) _J_ _n_ [(] _[w]_ [)] _,_ (31c)


ˆ

_J_ _n_ [(] _[x]_ [)] = _∂e_ _[∂]_ [Ω] � _X_ _n|n_ exp _[∧]_ _G_ [(] _[e]_ [)] _[, u]_ _[n]_ _[,]_ [ 0] � [�] ��� _e_ =0 _,_ (31d)

_∂_ ˆ
_J_ _n_ [(] _[w]_ [)] = _∂w_ [Ω] � _X_ _n|n_ _, u_ _n_ _, w_ � [�] ��� _w_ =0 _._ (31e)


Here Ad _G_ is the adjoint representation of _G_ on R _[N]_ _[x]_ and Φ _G_
is the right Jacobian of _G_ [34]. The measurement update is


_X_ ˆ _n|n_ = ˆ _X_ _n|n−_ 1 exp _[∧]_ _G_ � _e_ _n|n_ � (32a)

_P_ _n|n_ = Φ _G_ ( _e_ _n|n_ ) ( _I −_ _K_ _n_ _H_ _n_ ) _P_ _n|n−_ 1 Φ _G_ ( _e_ _n|n_ ) _[⊤]_ (32b)


where

_K_ _n_ = _P_ _n|n−_ 1 _H_ _n_ _[⊤]_ � _H_ _n_ _P_ _n|n−_ 1 _H_ _n_ _[⊤]_ [+] _[ Q]_ [(][m][)] [�] _[−]_ [1] (33a)

_e_ _n|n_ = _K_ _n_ log _[∨]_ _G_ _[′]_ � _η_ ( _X_ [ˆ] _n|n−_ 1 ) _[−]_ [1] _Y_ _n_ � (33b)



7


found from the matrix embedding of the Euclidean elements
by letting


_⊤_
_z_ _n_ ≜ _ω_ _n_ _[⊤]_ _p_ _[⊤]_ _n_ _v_ _n_ _[⊤]_ ( _b_ [( ˙] _n_ _[ω]_ [)] [)] _[⊤]_ ( _b_ [(] _n_ _[s]_ [)] [)] _[⊤]_ ( _b_ [(] _n_ [g][)] [)] _[⊤]_ (34)
� �


and









_G_



 =



_R_ _n_

 _ω_ _n_


_p_ _n_

_v_ _n_
_b_ [( ˙] _n_ _[ω]_ [)]
_b_ [(] _n_ _[s]_ [)]

 _b_ [(] _n_ [g][)]



_X_ _n_ ≜



_R_ _n_ 0 3 _,_ 18 0

0 18 _,_ 3 _I_ 18 _z_ _n_

 0 1 _,_ 3 0 1 _,_ 18 1



_._ (35)



The dimension of the Lie algebra of _G_ is consequently 21
and the state-covariance _P ∈_ R [21] _[×]_ [21] . Moreover, the process
noise vector is composed of the accelerometer measurement
noise and the white noise that drives the bias terms for the

accelerometers and gyroscopes, that is,






_._ (36)








_w_ _n_ [(][p][)] ≜









_w_ _n_ [( ˙] _[ω]_ [)]
_w_ _n_ [(] _[s]_ [)]
_w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)]
_w_ _n_ [(] _[b,s]_ [)]
_w_ _n_ [(] _[b,]_ [g][)]



The input to the propagation equation is the accelerometer measurements. The propagation equation is then derived
from (24) as







_ω_ _n_ _T_ + ˙ _ω_ _n_ _[T]_ [ 2]



_n_ _ω_ ˙ _n_ _T_ _n_ 2

_v_ _n_ _T_ + ( _g_ + _R_ _n_ _s_ _n_ ) _[T]_ [ 2]









Ω( _X_ _n_ _, y_ _n_ [(][a][)] _[, w]_ _n_ [(][p][)] [) =]









_n_ _n_ 2

( _g_ + _R_ _n_ _s_ _n_ ) _T_
_w_ _n_ [(] _[b,]_ [ ˙] _[ω]_ [)]
_w_ _n_ [(] _[b,s]_ [)]
_w_ _n_ [(] _[b,]_ [g][)]



_,_ (37)



where ˙ _ω_ _n_ and _s_ _n_ are computed using (24h) and (24i). The
Jacobians _F_ _n_ and _G_ _n_ are given in Appendix C.
Moreover, the angular velocity is propagated using the
accelerometer measurements in (24b), but also provided by
the gyroscopes in (24j). Hence, the gyroscope measurements
have to be fused using Kalman updates in (32). The Lie-Group
for gyroscope measurements is defined as _G_ [(][g][)] ≜ R [3] and
the gyroscope measurement equation and its corresponding
Jacobian is
_I_ 3 _y_ _n_ [(][g][)] = _I_ 3 _ω_ _n_ + _b_ [(] _n_ [g][)] _I_ 3 _w_ _n_ [(][g][)]

(38a)

�0 1 _,_ 3 1 � �0 1 _,_ 3 1 � �0 1 _,_ 3 1 �

~~�~~ ~~�~~ � ~~�~~

≜ _η_ [(][g][)] ( _X_ _n_ )

_H_ [(][g][)] = �0 3 _I_ 3 0 3 _,_ 12 _I_ 3 � _._ (38b)


Here 0 _N_ is the zero matrix of size _N_ . As mentioned in
Section III-B, the non linear optimization problem in [17]
is now solved using Kalman updates in (32) and (38). The
benefit of using Kalman updates is that the required number
of computations are known in advance, which is not the case
for iterative optimization methods.



_H_ _n_ = � _∂e_ _[∂]_ [log] _G_ _[∨]_ _[′]_ � _η_ � _X_ ˆ _n|n−_ 1 exp _[∧]_ _G_ [(] _[e]_ [)] � _−_ 1 _Y_ _n_



_._
����� _e_ =0

(33c)



Here log _[∨]_ _G_ _[′]_ [ is the matrix logarithm of] _[ G]_ _[′]_ [. If] _[ G]_ [ and] _[ G]_ _[′]_ [ were]
Euclidean spaces, (30) to (33) would be reduced to the regular
EKF filter equations [34], [44]. Compared to the standard
EKF filter equations, we can note the inclusion of the factors
Φ _G_ (Ω [ˆ] _n_ ) and Φ _G_ ( _e_ _n|n_ ) for the computation of the covariance
matrices. If _G_ = _SO_ (3) these factors account for the rotation
of the body frame and the correction of the covariance matrix
for the rotation is also referred to as attitude reset [37].


_B. D-LG-EKF for Array Inertial Navigation_


Here we define the specific Lie-Group _G_ applicable for
the inertial navigation equations. We derive the filter for the
2nd order accelerometer array state-space model in (24) and
omit the other state-space models, since they can be derived
from the 2nd order accelerometer array state-space model
through deleting rows and columns in the Jacobians. For the
state-space model in (24) the matrix Lie group is defined as
_G_ = _SO_ (3) _×_ R [18] . The explicit matrix expression for _G_ is



= _I_ 3 _ω_ _n_ + _b_ [(] _n_ [g][)]
� �0 1 _,_ 3 1



�



_I_ 3 _w_ _n_ [(][g][)]
�0 1 _,_ 3 1



(38a)
�


_y_


_z_


_y_


_z_


_z_


_y_




|31|Col2|Col3|
|---|---|---|
|31|||
































|Col1|Col2|Col3|
|---|---|---|
|32|32|32|
|32|||



Fig. 2. Layout and dimensions of the inertial sensor array used in the
experiments and simulations, along with the numbering of the IMU triads used
in tables and figures. The dimensions denote the distance between the center
positions of the IMU chip packages. The white dots on each IMU package
are the orientation markers, indicating the mounting directions of the IMU
packages [46]. The IMU packages on the underside, even numbers, are rotated
180° around the axis _y_ = _x_ relative to the IMU packages on the topside, odd
numbers. Each IMU package measures 4 mm _×_ 4 mm _×_ 1 mm [46].



Furthermore, a measurement update on the position can be
made if the inertial navigation system has information on the
position, e.g., when using a GPS sensor. The measurement
equation and the corresponding Jacobian is given as
_I_ 3 _y_ _n_ [(] _[p]_ [)] = _I_ 3 _p_ _n_ _I_ 3 _w_ _n_ [(] _[p]_ [)]

(39a)

�0 1 _,_ 3 1 � �0 1 _,_ 3 1 � �0 1 _,_ 3 1 �



� = �0 _I_ 13 _,_ 3 _p_ 1 _n_



�



_I_ 3 _w_ _n_ [(] _[p]_ [)]
�0 1 _,_ 3 1



(39a)
�



8


1000


0


-1000


0 1 2 3 4 5


(a) High dynamics


1000


0


-1000


0 1 2 3 4 5


(b) Low dynamics


Fig. 3. The angular velocity for the motion used in the simulations, where
(a) and (b) represent high and low rotational dynamics, respectively.


corresponding to different sampling frequencies _F_ _s_, and to
different degrees of rotational dynamics. The inertial sensor
array considered in the simulations is shown in Fig. 2,
which is an inertial sensor array with 32 IMUs attached
to a Printed Circuit Board (PCB). The accelerometers and
gyroscopes are assumed to be perfectly calibrated in terms of
scale factors, misalignment, cross-coupling, and accelerometer
positions [39], [47], [48]. Hence, the sensor measurements are
assumed only to be corrupted by a constant bias and white
noise. Specifically, we assume the noise of the accelerometers
and the gyroscopes to be zero-mean, uncorrelated and to have
a standard deviation of _σ_ [(][a][)] = 0 _._ 5 m _/_ s [2] and _σ_ [(][g][)] = 1 deg _/_ s,
respectively. The constant bias is assumed to be drawn from
a normal distribution with standard deviation set to _σ_ [(][a][)] and
_σ_ [(][g][)] for the accelerometers and gyroscope, respectively. These
parameters were selected to reflect the performance of typical
MEMS-based IMUs [46]. Further, we assume idealistically
that the sensors have an infinite dynamic range.

Field conditions were simulated by generating a continuous
sinusoidal motion from which artificial sensor measurements
were constructed. To account for the unknown constant bias,
artificial position measurements were simulated for an initial
time period to let the bias estimate of the filters converge. After
convergence, the position updates ceased and the filters conducted pure inertial navigation. More specifically, the angular
velocity in the simulations was set to two different sinusoids as
shown in Fig. 3, depicting low dynamic rotational and a high
dynamic rotational motion. From the generated continuoustime motion sequence discrete time sensor measurements were
generated considering two different sampling frequencies,
_F_ _s_ = 500 Hz and _F_ _s_ = 100 Hz, designating high and low
sampling frequencies, respectively. The synthetic navigation



~~�~~ ~~��~~ ~~�~~

≜ _η_ [(] _[p]_ [)] ( _X_ _n_ )

_H_ [(] _[p]_ [)] = �0 3 _,_ 6 _I_ 3 0 3 _,_ 12 � _._ (39b)

Here _y_ _n_ [(] _[p]_ [)] is the position measurement and _w_ _n_ [(] _[p]_ [)] is position
measurement noise.


V. S IMULATIONS AND E XPERIMENTS

The performance of the proposed Kalman filter and the four
proposed state-space models for inertial navigation using an
inertial sensor array was evaluated by simulations and experiments. The simulations demonstrate the performance obtained
under idealized assumptions, and real-world experiments verify the practical applicability of the proposed methods.


_A. Simulations_

We evaluated the performance of the proposed inertial
navigation system realizations in Fig. 1 using simulated data


9



0.2


0.15


0.1


0.05


0

0 1 2 3 4 5


(a) Low dynamics, _F_ _s_ = 500 Hz


1


0.8


0.6


0.4


0.2


0

0 1 2 3 4 5


(c) Low dynamics, _F_ _s_ = 100 Hz



0.2


0.15


0.1


0.05


0

0 1 2 3 4 5


(b) High dynamics, _F_ _s_ = 500 Hz


1


0.8


0.6


0.4


0.2


0

0 1 2 3 4 5


(d) High dynamics, _F_ _s_ = 100 Hz



Fig. 4. The position estimation RMSE of the four proposed state-spaces models in (24) to (27) using simulated data. (a), (b), (c), and (d) show the RMSE
for different rotational dynamics as shown in Fig. 3 and for different sampling frequencies _F_ _s_ .



position measurements were generated from the true motion
and with an added zero-mean noise with a standard deviation
of _σ_ [(] _[p]_ [)] = 10 cm and with a frequency of 100 Hz. The filters
had _σ_ [(] _[b,]_ [g][)], _σ_ [(] _[b,s]_ [)] and _σ_ [(] _[b,]_ [ ˙] _[ω]_ [)] all equal to zero. The initial
values for the accelerometer and gyroscope biases were set
to zero and the corresponding initial covariances were set to
_σ_ 0 [(] _[b,]_ [g][)] = 3 _σ_ [(][g][)], _σ_ 0 [(][a][)] = 3 _σ_ [(][a][)], with _σ_ 0 [(] _[b,s]_ [)] and _σ_ 0 [(] _[b,]_ [ ˙] _[ω]_ [)] evaluated
using (22).


The Root-Mean-Square Error (RMSE) of the navigation
position of the filters during the inertial navigation phase is
shown in Fig. 4 for 1000 Monte Carlo simulations. We first
observe that the 1st order state-space models in (25) and (27)
give similar results for all considered cases meaning that fusing
the accelerometer array’s and the gyroscopes’ measurements
for angular velocity estimation yields little improvement over
integrating the angular velocity directly from the gyroscope
measurements. Moreover, for the low dynamic rotational motion, we observe a reduced error of the 2nd order models in
(24) and (26) meaning that the 2nd order numerical integration
of the rotation matrix using the angular acceleration reduces
the overall position error growth. However, this is not the



case for highly dynamic rotational motion, where the reduced
error diminishes and even exceeds that of the 1st order models

in (25) and (27) for low sampling frequencies. This could be
attributed to the fact that the angular acceleration estimate has
its lowest variance when the angular velocity is zero [17],
and thus the 2nd order integration scheme for the rotation
matrix becomes more accurate for low dynamic rotational
motions. With increasing rotational motion, the variance in
angular acceleration increases and the 2nd order term in the
rotation matrix becomes increasingly less accurate. The same
conclusions seem to hold for both high and low sampling
frequencies, indicating that the numerical integration of the
angular velocity is not unstable. Evaluating the poles of the
Jacobian to (6a) using the nominal values of the accelerometer
positions of the inertial sensor array yields three eigenvalues
on the imaginary axis, meaning that the time-continuous
equations are stable.


_B. Experiments_


We also evaluated the performance of proposed inertial
navigation system realizations in Fig. 1 using real experiments


1000


0


-1000


1000


0


-1000



0 1 2 3 4 5


(a) High dynamics


0 1 2 3 4 5


(b) Low dynamics



Fig. 5. The angular velocity computed by the mean of 32 gyroscope triads
from experiment 1, where (a) and (b) represent high and low rotational
dynamics, respectively.


performed on the array in Fig. 2. We collected measurements
from the array while simultaneously measuring the position of
the array using a camera-based Motion Capture (MC) system [3] .
We assume that the inertial sensor array samples all the IMUs
simultaneously and instantaneously during one time sample.
The details about the hardware and the sampling process can
be found in [49]. The inertial sensor array was attached to a rig
that had multiple reflective markers that were tracked by the
cameras. The MC system provided both a rotation and position
estimate of the rig with a sampling frequency of 100 Hz.
The rig was then exposed to twisting motion in seven
different experiments. Each experiment consisted of three
phases, a time-synchronization phase, a low rotational dynamics phase, and a high rotational dynamics phase. The timesynchronization phase consisted of the rig and the inertial
sensor array being rotated around a single axis. This rotating
motion generated a high Signal-to-Noise Ratio (SNR) signal
from the gyroscopes, which was compared with the computed
angular velocity from the rotation estimates given by the MC
system. An illustration of the rotational motion during the low
and high dynamic phases is shown in Fig. 5, where the angular
velocity of the gyroscopes in experiment 1 is shown. Due to
difficulties in aligning the origin of the MC frame and the
origin of the inertial sensor array, the standard deviation for
the position updates was set to _σ_ [(] _[p]_ [)] = 10 cm.
In each experiment, the four filters were used to process
the measurement from the inertial sensor array with the
same noise variances settings as used in the simulations in
Section V-A. Position measurements given by the MC system
were also fed to the filters up to a certain time point, and
then the position updates ceased. The filters then performed


3 [https://www.qualisys.com/](https://www.qualisys.com/)



10


pure inertial navigation for 5 seconds. The accelerometer and
gyroscope biases were initialized to zero, and the filters ran for
a long enough time period for the bias estimates to converge
before the pure inertial navigation phase was started. Inertial
navigation commenced from 20 equally spaced time-instants
during the low dynamic and high dynamic phases. For each
rotational phase the RMSE during the inertial navigation phase
was computed by averaging the position over the 140 times
the position updates ceased and over the coordinate axes.
The RMSE of the position estimates for the experiments
is shown in Fig. 6 for two different sampling frequencies.
First, we note that the 2nd order accelerometer array model in
(24) has a higher RMSE compared to all other models for all
considered cases. And the expected improvement of the 2nd
order models in (24) and (26) is not seen as observed in the
simulations. Thus, joint propagation of the angular velocity
and the rotation matrix using the angular acceleration has a
higher error than solely propagating the rotation matrix only
using the gyroscope measurements. This suggests that there is
an estimation error in the angular acceleration computed with
the accelerometer array measurements, which could depend
on several factors such as misspecified covariances, scale
factor errors, sensitivity axes misalignments, cross-coupling
terms, and uncertainties in the accelerometer positions. However, for the high-frequency sampling case, the 2nd order
gyroscope model in (26) and the 1st order accelerometer
array in (25) have a lower error compared to the 1st order
gyroscope model in (27), meaning that the estimated angular
acceleration can improve the orientation estimation. And for
the 100 Hz sampling frequency, we observe that the RMSE
for the accelerometer array models in (24) and (25) increase
relative to the 1st order gyroscope model in (27). Thus, when
the integration time increases the error in the orientation
estimation using the angular acceleration increases, suggesting
that the angular velocity integration is not stable. Since the
simulations did not suggest an unstable integration for the
considered geometry of the accelerometer positions, it is left
for future research to find the cause for the observed behavior.


VI. S UMMARY AND C ONCLUSIONS


We propose four state-space models of how to perform inertial navigation using an inertial sensor array. Using different
underlying assumptions regarding the orientation modeling,
these four models fuse the measurements of multiple and generally placed accelerometer triads and a gyroscope triad to improve inertial navigation performance. The non linear problem
of fusing the accelerometer array measurements and the gyroscope measurements for angular velocity estimation is solved
through Kalman updates. The benefit of using Kalman updates
is twofold. First, the required computations for the sensor
fusion problem can be known in advance, which is not the
case when this fusion is done using an iterative optimization
method [17]. Knowing the number of computations in advance
is useful for embedded systems where computational resources
are limited. Second, we show that the Kalman updates stabilize
the potentially unstable equations when the angular velocity is
integrated using the accelerometer array measurements [13],


4


3.5


3


2.5


2


1.5


1


0.5


0

0 1 2 3 4 5


(a) Low dynamics, _F_ _s_ = 500 Hz


4


3.5


3


2.5


2


1.5


1


0.5


0

0 1 2 3 4 5


(c) Low dynamics, _F_ _s_ = 100 Hz



11


2


1.8


1.6


1.4


1.2


1


0.8


0.6


0.4


0.2


0

0 1 2 3 4 5


(b) High dynamics, _F_ _s_ = 500 Hz


2


1.8


1.6


1.4


1.2


1


0.8


0.6


0.4


0.2


0

0 1 2 3 4 5


(d) High dynamics, _F_ _s_ = 100 Hz



Fig. 6. The position estimation RMSE of the four proposed state-spaces models in (24) to (27) using experimental data. (a), (b), (c), and (d) show the RMSE
for different rotational dynamics as shown in Fig. 5 and for different sampling frequencies _F_ _s_ .




[20]. Thus, it is not necessary to place the accelerometer triads
in complex geometries to ensure stability [14], [19], [21]–

[23]. Furthermore, the angular acceleration is estimated from
the accelerometer array measurements and we present three
methods for how to capitalize on the angular acceleration:
either 1) propagate the angular velocity; or 2) propagate the
rotation matrix with 2nd order accuracy; or 3) both. We also
show that the correct weighting of multiple accelerometer
measurements for computation of the specific force is given
by the mean value [50], which is derived using the implicit
assumption of centered accelerometer positions. Moreover, we
show how only six dimensions of all individual accelerometer
biases are observable and consequently, it is sufficient to only
model the bias in six dimensions independent of the number
of accelerometer triads. This observation answers the question
posed in [28] where it was observed that the individual biases
of the accelerometers were unobservable, and that only three
dimensions of all bias terms were observable when computing
the specific force.


Moreover, simulations showed that for low rotational motions a significant reduction in navigation position error can



be achieved compared to the conventional inertial navigation
method when using all available information from the accelerometer array and the gyroscopes. This can be attributed
to the increased accuracy in the numerical integration of the
rotation matrix by the inclusion of a 2nd order term given
by the angular acceleration. However, this error reduction was
not observed in real-world experiments. This can be ascribed
to errors in the assumed covariances, accelerometer positions,
scale-factors, and misalignments. Thus, future research should
focus on methods to calibrate and compensate for these error
sources. However, it was observed from the experiments that
the inertial sensor array could, for high sampling frequencies,
provide extra orientation information and reduce the inertial
navigation error compared to conventional inertial navigation.


A PPENDIX A

A CCELEROMETER A RRAY D IFFERENTIAL E QUATIONS


Concatenating the measurements from _K_ accelerometer
triads using (2) yields



˙ _b_
_ω_
_f_ _[b]_ = _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [) +] _[ H]_ [(] _[r]_ 1: _[b]_ _K_ [)]

_s_ _[b]_

�



(40)
�


where _f_ _[b]_ and _h_ are defined in (4) and



12


A PPENDIX C

J ACOBIANS


The Jacobian in (31d) to (37) in the state-matrix _X_ _n_ is given
by



_J_ _n_ [(] _[x]_ [)] = �0 _J_ 9 _n_ [(1)] _,_ 12 _J_ 0 _n_ [(2)] 9



_,_ (52)
�





 _._ (41)







_H_ ( _r_ 1: _[b]_ _K_ [)][ ≜]









_−_ [ _r_ 1 _[b]_ _[×]_ []] _I_ 3

... ...
_−_ [ _r_ _K_ _[b]_ _[×]_ []] _I_ 3



The solution for the angular accelerations and the specific
force is then

˙ _b_
_ω_

_s_ _[b]_ = _A_ � _f_ _[b]_ _−_ _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [)] � _,_ (42)

� �


where
_A_ ≜ � _H_ _[⊤]_ _H_ � _−_ 1 _H_ _⊤_ _._ (43)


The angular acceleration and the specific force are thus different linear combinations determined by the matrix _A_ of the
difference between the specific forces _f_ _k_ and the centrifugal
accelerations _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [)][. Equation (42) can be simplified by]
noting that



= _A_ � _f_ _[b]_ _−_ _h_ ( _ω_ _[b]_ _, r_ 1: _[b]_ _K_ [)] � _,_ (42)
�



where


_J_ _n_ [(1)] =


and









_∂e∂v_ ˙ 0 _Rn_ 3 _T_ 2 [2] _∂ωω_ 0 _n_ 3 _[T]_ 00 33 _I_ 0 33 _T_



00 33 _I_ 3 _T_ + _∂ω_ ˙ _n_ _∂ω_ _[T]_ _[ω]_ _[n]_ 2 00 33 00 33



_∂e∂e∂vv_ _R_ ˙ _nRn_ _[T]_ 2 00 33 00 33 _I_ 0 33 _T_




_[ω]_ [˙] _[n]_ _T_ [2]

_∂ω_ 2






_,_ (53a)




_s_ _[b]_



0 3 _I_ 3 _T_ + _[∂][ω]_ [˙] _[n]_



_∂ω_ ˙ _n_ _T_ [2]
_∂b_ [( ˙] _[ω]_ [)] 2



_J_ _n_ [(2)] =









_∂b∂b∂ω_ [( ˙] _ω_ [( ˙] 0 ˙ _[ω]_ _n_ _[ω]_ _n_ [)] 3 [)] _[T]_ 2 _∂b∂v_ ˙ [(] 00 _n_ _[s]_ [)] 33 _T_ 2 [2] 000 333



00 33 _∂b∂b∂v_ [(] _v_ ˙ _n_ [(] _[s]_ _n_ _[s]_ [)][)] _[T]_ 2 00 33






_._ (53b)




_−_ [�]
_k_ [[] _[r]_ _k_ _[b]_ _[×]_ []] _[⊤]_ [[] _[r]_ _k_ _[b]_ _[×]_ []]



_H_ _[⊤]_ _H_ =
��



_k_ [[] _[r]_ _k_ _[b]_ _[×]_ []] _[⊤]_



Here _e_ _R_ _∈_ R [3] is the Lie algebra variable to _R_ . The partial
derivatives of ˙ _ω_ _n_ are given by



_k_ [[] _[r]_ _k_ _[b]_ _[×]_ []] _KI_ 3



_._ (44)
�



_−_ [�]



Assuming that [�] _k_ _[r]_ _k_ _[b]_ [= 0][, and consequently][ �] _k_ [[] _[r]_ _k_ _[b]_ _[×]_ [] = 0][,]

yields



_k_ _[r]_ _k_ _[b]_ [= 0][, and consequently][ �]



Assuming that [�]



_∂ω_ ˙ _n_



_A_ _k_ ([[ _ω_ _n_ _×_ ] _r_ _k_ _×_ ] + [ _ω_ _n_ _×_ ][ _r_ _k_ _×_ ]) _,_ (54a)

_k_



_H_ _[⊤]_ _H_ = �� _k_ [[] _[r]_ _k_ _[b]_ _[×]_ 0 []] _[⊤]_ [[] _[r]_ _k_ _[b]_ _[×]_ []] _KI_ 0 3


The three last rows of (42) then become



_._ (45)
�



_∂b∂ω_ ˙ [( ˙] _[ω]_ _n_ [)] [=] _[ I]_ [3] _[,]_ (54b)


derivatives of ˙ _v_ _n_ are given by


_∂v_ ˙ _n_ _∂v_ ˙ _n_
_∂e_ _R_ = _−R_ _n_ [ _s_ _n_ _×_ ] _,_ _∂b_ [(] _[s]_ [)] [=] _[ I]_ [3] _[.]_ (55)


The Jacobian in (31e) to (37) in the noise vector _w_ _n_ [(] _[p]_ [)] is given
by



_∂ω_ _n_ [=] �



_K_



1

_K_



_K_
�



�( _f_ _k_ _[b]_ _[−]_ [[] _[ω]_ _[b]_ _[×]_ []] [2] _[r]_ _k_ _[b]_ [) =] _K_ [1]

_k_ =1



_K_
� _f_ _k_ _[b]_ _[,]_ (46)


_k_ =1



which are independent of _ω_ _[b]_ . The differential equations in (42)
then decouples and become (6).


A PPENDIX B

T IME E VOLUTION OF R OTATION V ECTOR


To show that (12) is equal to (13) amounts to calculating
the terms _θ_ [˙] (0) and _θ_ [¨] (0). The rotation vector can be expressed
as _θ_ = _∥θ∥u_ where _∥θ∥_ is the magnitude of _θ_ and _u_ is the unit
vector pointing in the same direction as _θ_ . Using this, (11) can
be rewritten as



_T_ [2]



_∂ω_ ˙ _n_
_∂w_ _n_ [( ˙] _[ω]_ [)]



_∂w∂vv_ _n_ [(] ˙ _nn_ [(] _[s]_ _n_ _[s]_ [)][)] _[T]_ 2 00 33 _,,_ 99
0 9 _,_ 3 _I_ 9



_J_ _n_ [(] _[w]_ [)] =









_∂w∂w∂ωω_ _n_ [( ˙] ˙ _nn_ [( ˙] _[ω]_ _n_ _[ω]_ [)][)] _[T]_ 2 00 33 _,,_ 99



_∂v_ ˙ _n_
_∂w_ _n_ [(] _[s]_ [)]



_T_ [2]









(56a)




[1] 1 _−_ _[∥][θ][∥]_

2 _[∥][θ][∥]_ [[] _[u][×]_ []+] � 2




[ _u×_ ] [2] _._ (47)
��



where the partial derivatives are given by


_∂ω_ ˙ _n_ _∂v_ ˙ _n_
= _I_ 3 _,_ = _I_ 3 _._ (57)
_∂w_ _n_ [( ˙] _[ω]_ [)] _∂w_ _n_ [(][a][)]


R EFERENCES


[1] D. Titterton and J. Weston, _Strapdown Inertial Navigation Technology_ .
London, UK: The Institution of Engineering and Technology, 2004.

[2] J. A. Farrell, _Aided Navigation Systems: GPS and High Rate Sensors_ .
New York, NY, USA: McGraw-Hill, Inc., 2008.

[3] G. Huang, “Visual-Inertial Navigation: A Concise Review,” in _Int. Conf._
_Robotics Automation (ICRA)_, Montreal, QC, Canada, May 2019, pp.
9572–9582.

[4] A. D. Angelis, J.-O. Nilsson, I. Skog, P. H¨andel, and P. Carbone, “Indoor
Positioning by Ultrawide Band Radio Aided Inertial Navigation,” in
_XIX IMEKO World Congr. Fundamental Applied Metrology_, Lisbon,
Portugal, Sep. 2009, pp. 574–579.

[5] J. Tang, Y. Chen, X. Niu, L. Wang, L. Chen, J. Liu, C. Shi, and
J. Hyypp¨a, “LiDAR scan matching aided inertial navigation system in
GNSS-denied environments,” _Sensors_, vol. 15, no. 7, pp. 16 710–16 728,
July 2015.



Γ( _θ_ ) = _I_ 3 + [1]




_[θ][∥]_ _∥θ∥_

2 [cot] � 2



2



It is then clear that Γ(0) = _I_ 3 . With _θ_ (0) = 0 the first timederivative of _θ_ is


˙
_θ_ (0) = Γ( _θ_ (0)) _ω_ ( _t_ ) = _ω_ ( _t_ ) _._ (48)


Next _θ_ [¨] (0) is obtained through


¨
_θ_ ( _τ_ ) = ˙Γ( _θ_ ( _τ_ )) _ω_ ( _t_ + _τ_ ) + Γ( _θ_ ( _τ_ )) ˙ _ω_ ( _t_ + _τ_ ) _._ (49)


By differentiation, it can be shown that


˙Γ( _θ_ ( _τ_ )) (50)
��� _τ_ =0 [=] _[ −]_ [1] 2 [[] _[ω]_ [(] _[t]_ [)] _[×]_ []] _[,]_


so that


¨
_θ_ (0) = _−_ [1] (51)

2 [[] _[ω]_ [(] _[t]_ [)] _[×]_ []] _[ω]_ [(] _[t]_ [) + ˙] _[ω]_ [(] _[t]_ [) = ˙] _[ω]_ [(] _[t]_ [)] _[.]_


[6] M. Kok, N. Wahlstr¨om, T. B. Sch¨on, and F. Gustafsson, “MEMS-based
inertial navigation based on a magnetic field map,” in _IEEE Int. Conf._
_Acoustics, Speech Signal Processing (ICASSP)_, Vancouver, BC, Canada,
May 2013, pp. 6466–6470.

[7] J. Wahlstr¨om and I. Skog, “Fifteen Years of Progress at Zero Velocity:
A Review,” _IEEE Sensors J._, vol. 21, no. 2, pp. 1139–1151, Jan. 2021.

[8] A. D. King, “Inertial navigation-forty years of evolution,” _GEC review_,
vol. 13, no. 3, pp. 140–149, 1998.

[9] D. K. Shaeffer, “MEMS inertial sensors: A tutorial overview,” _IEEE_
_Commun. Mag._, vol. 51, no. 4, pp. 100–109, Apr. 2013.

[10] J.-O. Nilsson and I. Skog, “Inertial sensor arrays - A literature review,”
in _European Navigation Conf. (ENC)_, Helsinki, Finland, May 2016, pp.
1–10.

[11] M. W. Givens and C. Coopmans, “A Survey of Inertial Sensor Fusion:
Applications in sUAS Navigation and Data Collection,” in _Int. Conf._
_Unmanned Aircraft Systems (ICUAS)_, Atlanta, GA, USA, June 2019,
pp. 1054–1060.

[12] A. R. Schuler, A. Grammatikos, and K. A. Fegley, “Measuring Rotational Motion with Linear Accelerometers,” _IEEE Trans. Aerospace_
_Electron. Syst._, vol. AES-3, no. 3, pp. 465–472, May 1967.

[13] A. J. Padgaonkar, K. W. Krieger, and A. I. King, “Measurement of
Angular Acceleration of a Rigid Body Using Linear Accelerometers,”
_J. of Appl. Mechanics_, vol. 42, no. 3, pp. 552–556, Sep. 1975.

[14] J.-H. Chen, S.-C. Lee, and D. B. DeBra, “Gyroscope free strapdown
inertial measurement unit by six linear accelerometers,” _J. of Guidance,_
_Control, Dynamics_, vol. 17, no. 2, pp. 286–290, Apr. 1994.

[15] C.-W. Tan, S. Park, K. S. Mostov, and P. Varaiya, “Design of gyroscopefree navigation systems,” in _IEEE Intelligent Transportation Systems_
_Conf. Proc. (ITSC)_, Oakland, CA, USA, Aug. 2001, pp. 286–291.

[16] M. Pachter, T. C. Welker, and R. E. Huffman, “Gyro-free INS theory,”
_Navigation: J. of the Inst. of Navigation_, vol. 60, no. 2, pp. 85–96, June
2013.

[17] I. Skog, J.-O. Nilsson, P. H¨andel, and A. Nehorai, “Inertial Sensor
Arrays, Maximum Likelihood, and Cram´er-Rao Bound,” _IEEE Trans._
_Signal Process._, vol. 64, no. 16, pp. 4218–4227, Aug. 2016.

[18] J. Wahlstr¨om, I. Skog, and P. H¨andel, “Inertial Sensor Array Processing
with Motion Models,” in _21st Int. Conf. Information Fusion (FUSION)_,
Cambridge, UK, July 2018, pp. 788–793.

[19] S. Park, C.-W. Tan, and J. Park, “A scheme for improving the performance of a gyroscope-free inertial measurement unit,” _Sensors Actuators_
_A: Physical_, vol. 121, no. 2, pp. 410–420, June 2005.

[20] U. Nusbaum and I. Klein, “Control theoretic approach to gyro-free
inertial navigation systems,” _IEEE Aerospace Electron. Syst. Mag._,
vol. 32, no. 8, pp. 38–45, Aug. 2017.

[21] R. Hanson and M. Pachter, “Optimal Gyro-Free IMU Geometry,” in
_AIAA Guidance, Navigation, Control Conf. Exhibit_, San Francisco, CA,
USA, Aug. 2005, pp. 1–8.

[22] N. Sahu, P. Babu, A. Kumar, and R. Bahl, “A Novel Algorithm for
Optimal Placement of Multiple Inertial Sensors to Improve the Sensing
Accuracy,” _IEEE Trans. Signal Process._, vol. 68, pp. 142–154, Dec.
2020.

[23] T. R. Williams, D. W. Raboud, and K. R. Fyfe, “Minimal spatial
accelerometer configurations,” _J. of Dynamic Syst. Meas. Control, Trans._
_of the ASME_, vol. 135, no. 2, pp. 1–9, Feb. 2013.

[24] I. Colomina, M. Gim´enez, J. J. Rosales, M. Wis, A. G´omez, and
P. Miguelsanz, “Redundant IMUs for precise trajectory determination,”
in _XXth Int. Society for Photogrammetry Remote Sensing Congr. (IS-_
_PRS)_, Istanbul, Turkey, July 2004, pp. 159–165.

[25] T. Williams, A. Pahadia, M. Petovello, and G. Lachapelle, “Using an
Accelerometer Configuration to Improve the Performance of a MEMS
IMU: Feasibility Study with a Pedestrian Navigation Application,” in
_Proc. of 22nd Int. Technical Meeting of the Satellite Division of the_
_Institute of Navigation (ION GNSS)_, Savannah, GA, USA, Sep. 2009,
pp. 3049–3063.

[26] J. B. Bancroft and G. Lachapelle, “Data fusion algorithms for multiple
inertial measurement units,” _Sensors_, vol. 11, no. 7, pp. 6771–6798, June
2011.

[27] U. Patel and I. A. Faruque, “Multi-IMU Based Alternate Navigation
Frameworks: Performance & Comparison for UAS,” _IEEE Access_, pp.
1–1, 2022.

[28] A. Waegli, S. Guerrier, and J. Skaloud, “Redundant MEMS-IMU integrated with GPS for performance assessment in sports,” in _IEEE/ION_
_Position, Location Navigation Symp. (PLANS)_, Monterey, CA, USA,
May 2008, pp. 1260–1268.

[29] L. D. Landau and E. M. Lifshitz, _Mechanics_ . Oxford, UK: Elsevier
Butterworth-Heinemann, 1976.



13


[30] M. Kok, J. D. Hol, and T. B. Sch¨on, “Using Inertial Sensors for Position
and Orientation Estimation,” _Found. Trends® in Signal Process._, vol. 11,
no. 1-2, pp. 1–153, Nov. 2017.

[31] I. Klein, “Analytic Error Assessment of Gyro-Free INS,” _J. of Appl._
_Geodesy_, vol. 9, no. 1, pp. 49–62, Mar. 2015.

[32] H. Khalil, _Nonlinear Systems_ . Upper Saddle River, NJ, USA: Prentice
Hall, 2002.

[33] A. Iserles, H. Z. Munthe-Kaas, S. P. Nørsett, and A. Zanna, “Lie-group
methods,” _Acta Numerica_, vol. 9, no. 1, pp. 215–365, Jan. 2000.

[34] G. Bourmaud, R. M´egret, M. Arnaudon, and A. Giremus, “ContinuousDiscrete Extended Kalman Filter on Matrix Lie Groups Using Concentrated Gaussian Distributions,” _J. of Math. Imaging Vision_, vol. 51, no. 1,
pp. 209–228, July 2014.

[35] J. Bortz, “A New Mathematical Formulation for Strapdown Inertial
Navigation,” _IEEE Trans. Aerospace Electron. Syst._, vol. AES-7, no. 1,
pp. 61–66, Jan. 1971.

[36] M. D. Shuster, “The kinematic equation for the rotation vector,” _IEEE_
_Trans. Aerospace Electron. Syst._, vol. 29, no. 1, pp. 263–267, Jan. 1993.

[37] M. E. Pittelkau, “Rotation Vector in Attitude Estimation,” _J. of Guidance,_
_Control, Dynamics_, vol. 26, no. 6, pp. 855–860, Nov. 2003.

[38] V. Joukov, J. C´esi´c, K. Westermann, I. Markovi´c, D. Kuli´c, and
I. Petrovi´c, “Human motion estimation on Lie groups using IMU measurements,” in _IEEE/RSJ Int. Conf. Intelligent Robots Systems (IROS)_,
Vancouver, BC, Canada, Sep. 2017, pp. 1965–1972.

[39] H. Carlsson, I. Skog, and J. Jald´en, “Self-Calibration of Inertial Sensor
Arrays,” _IEEE Sensors J._, vol. 21, no. 6, pp. 8451–8463, Mar. 2021.

[40] H. Xu, S. Guerrier, R. C. Molinari, and M. Karemera, “Multivariate
signal modeling with applications to inertial sensor calibration,” _IEEE_
_Trans. Signal Process._, vol. 67, no. 19, pp. 5143–5152, Oct. 2019.

[41] J. Wahlstr¨om, I. Skog, P. H¨andel, and A. Nehorai, “IMU-Based
Smartphone-to-Vehicle Positioning,” _IEEE Trans. Intelligent Vehicles_,
vol. 1, no. 2, pp. 139–147, June 2016.

[42] K. Pamadi and E. Ohlmeyer, “Assessment of a GPS guided spinning
projectile using an accelerometer-only IMU,” in _AIAA Guidance, Nav-_
_igation, Control Conf. Exhibit_, Providence, RI, USA, Aug. 2004, pp.
1–13.

[43] D. B. Camarillo, P. B. Shull, J. Mattson, R. Shultz, and D. Garza, “An
instrumented mouthguard for measuring linear and angular head impact
kinematics in American football,” _Ann. of Biomed. Eng._, vol. 41, no. 9,
pp. 1939–1949, Apr. 2013.

[44] G. Bourmaud, R. M´egret, A. Giremus, and Y. Berthoumieu, “Discrete
Extended Kalman Filter on Lie groups,” in _21st European Signal_
_Processing Conf. (EUSIPCO)_, Marrakech, Morocco, Sep. 2013, pp. 1–5.

[45] Y. Wang and G. S. Chirikjian, “Error propagation on the Euclidean
group with applications to manipulator kinematics,” _IEEE Trans. Robot._,
vol. 22, no. 4, pp. 591–602, Aug. 2006.

[46] _MPU-9150 Product Specification_, InvenSense Inc., Sep. 2013, rev. 4.3.

[47] H. Carlsson, I. Skog, and J. Jald´en, “On-the-fly geometric calibration
of inertial sensor arrays,” in _Int. Conf. Indoor Positioning Indoor_
_Navigation (IPIN)_, Sapporo, Japan, Sep. 2017, pp. 1–6.

[48] H. Carlsson, I. Skog, T. B. Sch¨on, and J. Jald´en, “Quantifying the
Uncertainty of the Relative Geometry in Inertial Sensors Arrays,” _IEEE_
_Sensors J._, vol. 21, no. 17, pp. 19 362–19 373, Sep. 2021.

[49] I. Skog, J.-O. Nilsson, and P. H¨andel, “An open-source multi inertial
measurement unit (MIMU) platform,” in _Int. Symp. Inertial Sensors_
_Systems (ISISS)_, Laguna Beach, CA, USA, Feb. 2014, pp. 1–4.

[50] ——, “Pedestrian tracking using an IMU array,” in _IEEE Int. Conf. Elec-_
_tronics, Computing Communication Technologies (CONECCT)_, Bangalore, India, Jan. 2014, pp. 1–4.


