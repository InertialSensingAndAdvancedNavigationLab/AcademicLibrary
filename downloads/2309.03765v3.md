## **Equivariant Symmetries for Inertial Navigation Systems**

### Alessandro Fornasier [a] [,] [∗], Yixiao Ge [b], Pieter van Goor [b], Robert Mahony [b], Stephan Weiss [a]

a _Control of Networked Systems Group, University of Klagenfurt, Austria_


b _System Theory and Robotics Lab, Australian Centre for Robotic Vision, Australian National University, Australia_


**Abstract**


This paper investigates the problem of inertial navigation system (INS) filter design through the lens of symmetry. The
extended Kalman filter (EKF) and its variants have been the staple of INS filtering for 50 years. However, recent advances in
inertial navigation systems have exploited matrix Lie group structure to design stochastic filters and state observers that have
been shown to display superior performance compared to classical solutions. In this work, we explore various symmetries of
inertial navigation system, including two novel symmetries that have not been considered in the prior literature, and provide
a discussion of the relative strengths and weaknesses of these symmetries in the context of filter design. We show that all the
modern variants of the EKF for inertial navigation can be interpreted as the recently proposed equivariant filter (EqF) design
methodology applied to different choices of symmetry group for the INS problem. As a direct application of the symmetries
presented, we address the filter design problem for a vehicle equipped with an inertial measurement unit (IMU) and a global
navigation satellite system (GNSS) receiver, providing a comparative analysis of different modern filter solutions. We believe
the collection of symmetries that we present here capture all the sensible choices of symmetry for this problem, and that
the analysis provided is indicative of the relative real-world performance potential of the different algorithms for trajectories
ensuring full state observability.


_Key words:_ Inertial navigation system; Symmetry; Equivariance; Equivariant filter.



**1** **Introduction**


The theory of invariant filtering for group affine systems [4, 2] and the theory of equivariant filters [18, 21, 28]
that generalizes to systems on homogeneous spaces
have provided general design frameworks, as well as
strong theoretical performance guarantees, for filter designs that exploit symmetry. This has motivated the
widespread use of invariant filters in the robotics community, and its adoption for inertial navigation problems [13, 24, 17]. The application of these principles to
inertial navigation systems (INS) has seen the most significant performance gains from algorithm design in this
field for the last 40 years. There are now several competing modern INS filters based on geometric insights
available in the literature [1, 4, 11] and the question of
how to analyse and evaluate the similarities and differ

∗ Corresponding author
_Email addresses:_ `alessandro.fornasier@aau.at`
(Alessandro Fornasier), `yixiao.ge@anu.edu.au` (Yixiao
Ge), `pieter.vangoor@anu.edu.au` (Pieter van Goor),
`robert.mahony@anu.edu.au` (Robert Mahony),
`stephan.weiss@aau.at` (Stephan Weiss).


_Preprint submitted to Automatica_



ences is now of interest. A recent paper by Barrau et
al. states _“The big question when it comes to invariant_
_observers/filters is how do we find a group structure for_
_the state space [...]”_ [4]. The goal of the present paper
is to convince the reader that the choice of symmetry
structure is in fact the _only_ difference between different
versions of modern geometric INS filters.


In this paper we present six different symmetry groups
that act on the state-space of the INS problem. We
use the recent equivariant filter design methodology to
generate INS filter algorithms for each of these symmetries. We show that the classical multiplicative extended
Kalman filter (MEKF) [15], the Imperfect-invariant extended Kalman filter (IEKF) [1], the two-frames group
invariant extended Kalman filter (TFG-IEKF) [4], and
the authors own recent work proposing an equivariant
filter for the tangent group structure (TG-EqF) [11] are
all associated with equivariant filter design [29] applied
to different symmetry actions on the same state-space.
This leads us to consider the properties of the symmetry
groups and suggests two additional symmetries leading
to filters, that we term the Direct Position Equivariant
Filter (DP-EqF) and Semi-Direct Bias Equivariant Fil

ter (SD-EqF), that are novel and do not correspond to
prior algorithms in the literature.


In the context of GNSS-based navigation, we derive EqF
algorithms for all of the different symmetries, demonstrating that this approach provides a unifying analysis
framework for modern INS filters. In doing this we also
make a minor contribution in demonstrating how fixedframe measurements can be reformulated as body-frame
relative measurements. This allows us to exploit output
equivariance [29] for all the filter geometries, ensuring at
least third-order linearization error in the output equations.


We undertake a simple comparative study in concert
with a linearization analysis of the error equations. We
consider the “fully observable” case where all states are
estimated and are observable for the given system trajectories. We recognise that for specific cases where trajectories lead to unobservable states (e.g., straight-line
flight, hovering, etc.) some of the following observations
may not hold. For such trajectories we make the following observations:


- The classical MEKF demonstrates noticeable performance limitations compared to the modern filters. In
particular, it demonstrates worse transient response
and reports significant overconfidence during the transient phase.

- The performance differences in modern filters are primarily visible during the transient phase of error response. The asymptotic behaviour of all filters is similar.

- Notwithstanding the above, the asymptotic performance of the TG-EqF appears superior to all other filters demonstrating the best consistency and the lowest error.

- The TG-EqF filter is the only filter with exact linearization of the navigation states; the only nonlinearities occur in the bias states. The authors believe that
this property underlies its performance advantage.

- The bias state transient response of the filters with
semi-direct bias symmetry (TG-EqF, DP-EqF and
SD-EqF) appears superior to that of filters without
this geometric structure (MEKF, IEKF and TFGIEKF).


The study concludes that any of the IEKF, TG-EqF,
DP-EqF, and SD-EqF filters are candidates for a highperformance INS filter design. The lower filter error and
energy properties of the TG-EqF recommend it as the
leading choice for fully observable trajectories.


**2** **Notation and Preliminaries**


In this paper bold lowercase letters are used to indicate
vector quantities. Bold capital letters are used to indi


Their Lie algebras are the tangent spaces at the identities
of each group.


For all _X_ = ( **A** _,_ _**a**_ _,_ _**b**_ ) ∈ **SE** 2 (3) ∣ **A** ∈ **SO** (3) _,_ _**a**_ _,_ _**b**_ ∈ R [3],
define the map:


Ω (⋅) ∶ **SE** 2 (3) → se 2 (3) _,_ Ω ( _X_ ) = ( **0** 3×1 _,_ **0** 3×1 _,_ _**a**_ ) [∧] ∈ se 2 (3) _._


For all _**p**_ _,_ _**q**_ _,_ _**r**_ ∈ R [3] ∣( _**p**_ _,_ _**q**_ _,_ _**r**_ ) ∈ R [9], define the map:


Π (⋅) ∶ se 2 (3) → se(3) _,_ Π (( _**p**_ _,_ _**q**_ _,_ _**r**_ ) [∧] ) = ( _**p**_ _,_ _**q**_ ) [∧] ∈ se(3) _._


In what follows, we recall the concept of symmetry,
equivariance, and equivariant filter design. For an introduction to Lie groups and homogeneous spaces in
the context of equivariant filter, we refer the reader to
the authors’ prior work [18, 20, 29, 11]. The appendix B
also provides additional explanation.


_2.1_ _Symmetry Equivariance and Lifted System_


A symmetry of a kinematic system can be seen as a set of
transformations that either leave unchanged or change



cate matrices. Regular letters are used to indicate elements of a symmetry group.


Frames of reference are denoted as { _A_ } and { _B_ }. Vectors describing physical quantities expressed in a frame
of reference { _A_ } are denoted by _[A]_ _**x**_ . Rotation matrices
encoding the orientation of a frame of reference { _B_ } with
respect to a reference { _A_ } are denoted by _[A]_ **R** _B_ ; in particular, _[A]_ **R** _B_ expresses a vector _[B]_ _**x**_ defined in the { _B_ }
frame of reference into a vector _[A]_ _**x**_ = _[A]_ **R** _B_ _[B]_ _**x**_ expressed
in the { _A_ } frame of reference. Finally, **I** _n_ ∈ R _[n]_ [×] _[n]_ is the
_n_ × _n_ identity matrix, and **0** _n_ × _m_ ∈ R _[n]_ [×] _[m]_ is the _n_ × _m_ zero
matrix.


For all _**x**_ ∈ R _[n]_ define the maps:


( **⋅** ) ∶ R _[n]_ → R _[n]_ [+][3] _,_ _**x**_ ↦ ~~_**x**_~~ = ( **0** 3×1 _,_ _**x**_ ) _,_

( **⋅** ) ∶ R _[n]_ → R _[n]_ [+][3] _,_ _**x**_ ↦ _**x**_ = ( _**x**_ _,_ **0** 3×1 ) _._


The following Lie groups are used throughout the paper.


**SO** (3) = { **A** ∈ R [3][×][3] ∣ **AA** [⊺] = **I** 3 _,_ det( **A** ) = 1} _,_



**SE** (3) =
⎧⎪⎪⎨⎪⎪⎩



**A** _**b**_



∈ R [4][×][4] **A** ∈ **SO** (3) _,_ _**b**_ ∈ R [3] _,_
⎤⎥⎥⎥⎥⎦ ������������ ⎫⎪⎪⎬⎪⎪⎭



**0** 1×3 1



**A** _**a b**_



⎤⎥⎥⎥⎥⎥⎥⎥⎦



⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭



������������������



**A** ∈ **SO** (3) _,_ _**a**_ _,_ _**b**_ ∈ R [3]



**SE** 2 (3) =



⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩



⎡⎢⎢⎢⎢⎣

⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 1×3 1 0


**0** 1×3 0 1



∈ R [5][×][5]



_._



2


in a structured manner the equations that govern the
motion of the system. This is encoded by a transitive
group action _ϕ_ of a Lie group **G** (also called a _symmetry_
_group_ ) on the state space M of a system. Formally, a
(right) Lie group action _ϕ_ ∶ **G** × M →M is a smooth
map satisfying


_ϕ_ ( _XY,ξ_ ) = _ϕ_ ( _Y,ϕ_ ( _X,ξ_ )) _,_ _ϕ_ ( _I,ξ_ ) = _ξ,_


for all _X,Y_ ∈ **G** and _ξ_ ∈M. An action _ϕ_ is said to be
_transitive_ if for all _ξ_ 1 _,ξ_ 2 ∈M, there exists _X_ ∈ **G** such
that _ϕ_ ( _X,ξ_ 1 ) = _ξ_ 2 .


A symmetry that transforms the equations of motion
of a kinematic system in a structured manner encodes
_equivariance_ of the system. Formally, consider a system
_f_ ∶ L → X(M) as a map from a vector space of inputs L
to vector fields on the state space M; that is, each input
_u_ ∈ L corresponds to a vector field _f_ _u_ ∈ X(M) on the
state space M. Then _f_ is said to be _equivariant_ if


d _ϕ_ _X_       - _f_ _u_       - _ϕ_ _X_ −1 = _f_ _ψ_ _X_ ( _u_ ) _,_ (1)


∀ _X_ ∈ **G**, _u_ ∈ L, and for a right-handed group action
_ψ_ ∶ **G** × L → L of the group **G** on the input space
L. Similarly, a symmetry that changes the output in a
structured manner encodes _equivariance of the output_ .
Formally, consider an output map _h_ ∶M →N where N
is a smooth manifold called the output space. Then _h_ is
said to be _equivariant_ if


_h_ ( _ϕ_ _X_ ( _ξ_ )) = _ρ_ _X_ ( _h_ ( _ξ_ )) _,_ (2)


∀ _X_ ∈ **G**, _ξ_ ∈M, and for a right-handed action of the
group **G** on the output space N, that is _ρ_ ∶ **G** ×N →N .


Note that for any fixed _X_ ∈ **G** the actions _ϕ,ψ_ and _ρ_
can be written as diffeomorphisms _ϕ_ _X_ ∶M →M,
_ψ_ _X_ ∶ L → L and _ρ_ _X_ ∶N →N .


If a system possesses a symmetry ( **G** _,ϕ_ ), the Lie group
structure of the symmetry group can be exploited to “lift”
the system dynamics on the Lie group. That is, with an
arbitrary but fixed choice of origin point [˚] _ξ_ ∈M, defining
and defining aa geometric structure called “Lift” _lifted system_ _X_ ˙ = _X_ ΛΛ ( _ϕ_ ∶ _X_ M ×(˚ _ξ_ ) _,u_ L) whose→ g
solutions _X_ ( _t_ ) at time _t_, project to solutions _ξ_ ( _t_ ) [18, 29].


_2.2_ _Equivariant Filter Design_


For state estimation problems, lifting the system dynamics onto the Lie group translates the problem to that
of estimating an element of the symmetry group _X_ [ˆ] ∈ **G**
such that _ξ_ [ˆ] = _ϕ_ ( _X,_ [ˆ] [˚] _ξ_ ), rather than _ξ_ [ˆ] ∈M directly. This is
not just an “embedding” of the system on the Lie group,
but abstracts the estimation problem to the Lie group.



Exploiting the symmetry of the kinematic systems allows the definition of a _global error e_ = _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) ∈M,
termed _equivariant error_ [29, 27]. The EqF is then the
state estimation algorithm that results from applying
EKF design principles to the (global) error kinematics,
linearized about the fixed origin [˚] _ξ_ .


Let _f_ ∶ L → X(M) be a system whose state space is a _m_ dimensional homogeneous space M, and let _h_ ∶M →N
be an output function where the output space is a _n_ dimensional smooth manifold N . Assume that _f_ and _h_
are equivariant as in Section 2.1. Let _ξ_ ( _t_ ) ∈M be a
trajectory of the system with measurements,


˙
_ξ_ = _f_ _u_ ( _ξ_ ) _,_ _y_ ( _t_ _k_ ) = _h_ ( _ξ_ ( _t_ _k_ )) _,_


where _u_ ( _t_ ) ∈ L is a measured input signal, and the measurements _y_ ( _t_ _k_ ) ∈N occur at discrete times _t_ 1 < _t_ 2 < ⋯.
Choose a fixed origin [˚] _ξ_ ∈M and let Λ ∶M × L → g be
a lift of the system. Let _X_ [ˆ] ∈ **G** denote the observer state
and define its dynamics to be


_X_ ˙ˆ = ˆ _X_ Λ( _ϕ_ ( ˆ _X,_ ˚ _ξ_ ) _,u_ ) _,_ _X_ ˆ ( _t_ [+] _k_ [) =][ exp][(][∆][(] _[t]_ _[k]_ [))][ ˆ] _[X]_ [(] _[t]_ _k_ [+] [)] _[,]_


where the ∆( _t_ _k_ ) ∈ g are correction terms that depend
on the measurements _y_ ( _t_ _k_ ).


The _equivariant error_ is defined to be _e_ ∶= _ϕ_ _X_ ˆ [−][1] [ (] _[ξ]_ [)][.]
Choose local coordinates of the state space _ϑ_ ∶U ˚ _ξ_ [→] [R] _[m]_

in a neighbourhood U ˚ _ξ_ [⊂M][ of][ ˚] _[ξ]_ [, and choose local co-]
ordinates of the output space _δ_ ∶U ˚ _y_ → R _[n]_ in a neighbourhood U ˚ _y_ ⊂N of ˚ _y_ = _h_ ( [˚] _ξ_ ). Let _ε_ = _ϑ_ ( _e_ ) denote the
local coordinates of the error _e_ . Then the linearized
error dynamics and linearized output are [28]


_ε_ ˙ ≈ **A** [0] _t_ _[ε,]_

**A** [0] _t_ [=][ D] _[e]_ [∣] [˚] _ξ_ _[ϑ]_ [(] _[e]_ [)][ D] _[E]_ [∣] _I_ _[ϕ]_ [˚] _ξ_ [(] _[E]_ [)][ D] _[e]_ [∣] [˚] _ξ_ [Λ] [(] _[e,]_ [˚] _[u]_ [)][ D] _[ε]_ [∣] **0** _[ϑ]_ [−][1] [ (] _[ε]_ [)] _[,]_

_δ_ ( _h_ ( _e_ )) = _δ_ ( _h_ ( _ρ_ ( _X_ [ˆ] [−][1] _,y_ ))) ≈ **C** [0] _**ε**_ _,_

**C** [0] = D _y_ ∣ ˚ _y_ _δ_ ( _y_ ) D _e_ ∣ ˚ _ξ_ _[h]_ [(] _[e]_ [)][ D] _**[ε]**_ [∣] **0** _[ϑ]_ [−][1] [ (] _**[ε]**_ [)] _[.]_


If no compatible action _ψ_ of the symmetry group on the
input space is found, the state matrix can be computed
alternatively according to


**A** [0] _t_ [=][ D] _[e]_ [∣] [˚] _ξ_ _[ϑ]_ [(] _[e]_ [)][ D] _[ξ]_ [∣] _ξ_ [ˆ] _[ϕ]_ _X_ [ ˆ] [−][1] [ (] _[ξ]_ [)][ D] _[E]_ [∣] _I_ _[ϕ]_ _ξ_ [ˆ] [(] _[E]_ [)]

D _ξ_ ∣ _ϕ_ ˆ _X_ [(][˚] _ξ_ ) [Λ] [(] _[ξ,u]_ [)][ D] _[e]_ [∣] [˚] _ξ_ _[ϕ]_ _X_ [ ˆ] [(] _[e]_ [)][ D] _**[ε]**_ [∣] **0** _[ϑ]_ [−][1] [ (] _**[ε]**_ [)] _[.]_


Output equivariance can be exploited to derive a linearized output with third order error [29] as follows


_δ_ ( _h_ ( _e_ )) = _δ_ ( _ρ_ ˆ _X_ [−][1] [ (] _[h]_ [(] _[ξ]_ [))) ≈] **[C]** [⋆] _**[ε]**_ [ +] **[ O]** [(] _**[ε]**_ [3] [)] _[,]_

**C** [⋆] _**ε**_ = [1]

2 [D] _[y]_ [∣] [˚] _[y]_ _[ δ]_ [ (] _[y]_ [)(] [D] _[E]_ [∣] _[I]_ _[ ρ]_ _[E]_ [ (][˚] _[y]_ [) +][ D] _[E]_ [∣] _[I]_ _[ ρ]_ _[E]_ [ (] _[ρ]_ [ ˆ] _X_ [−][1] [ (] _[y]_ [)))] _[ε]_ [∧] _[.]_



3


Let **C** be either **C** [0] or **C** [⋆], then the EqF algorithm is


**Predict:**


˙ˆ
_X_ = dL _X_ ˆ [Λ][(] _[ϕ]_ [˚] _ξ_ [(][ ˆ] _[X]_ [)] _[,u]_ [)] _[,]_


˙ ⊺
**Σ** = **A** [0] _t_ **[Σ]** [ +] **[ ΣA]** [0] _t_ + **Q** _,_


**Update:**


∆ = D _E_ ∣ _I_ _ϕ_ ˚ _ξ_ [(] _[E]_ [)] [†] [ d] _[ϑ]_ [−][1] **[ΣC]** [⊺] [(] **[CΣC]** [⊺] [+] **[ R]** [)] [−][1] _[δ]_ [(] _[ρ]_ [(][ ˆ] _[X]_ [−][1] _[,y]_ [))] _[,]_

**Σ** = ( **I** − **ΣC** [⊺] ( **CΣC** [⊺] + **R** ) [−][1] **C** ) **Σ** _,_
_X_ ˆ = exp (∆) ˆ _X,_


**Reset:**


⊺
**Σ** = exp ( **Γ** d _ϕ_ ˚ _ξ_ [∆] [)] **[Σ]** [exp] [(] **[Γ]** [d] _[ϕ]_ [˚] _ξ_ [∆] [)] _._


where the last equation (Reset) accounts for the distortion of the covariance due to the change of coordinate
maps on a non-flat manifold, and is often referred to as
_reset step_ or _curvature correction_ [20, 12].


The equations above resemble those of continuousdiscrete Kalman-like filters, and indeed, the EqF has the
same order of computational complexity as any other
Kalman-like filter, such as EKF and MEKF.


**3** **Outline of the Paper**


The paper is organized as follows. Section 4 introduces
the biased inertial navigation system considered. Section 5 introduces and analyzes different symmetries of
the biased inertial navigation system under the lens of
equivariance. That is, for each symmetry, its equivariance properties, as well as the relation to classical filter design when exploited within the equivariant filter
framework, are discussed. In particular, Tab. 2 provides
an summary of the different symmetries considered, with
its rightmost column showing the linearized error dynamics when these symmetries are exploited for filter
design. Section 6 describes how the linearization error
analysis is carried out. For readers who do not wish to
replicate the straightforward but tedious calculations required to compute the linearisations, the detailed derivations are provided in the appendix B. Section 7 discussed
the problem of unmanned aerial vehicle (UAV) positionbased localization as a direct application of the symmetries presented in Section 5. This application serves as
a convenient framework to introduce an interesting result in Section 7.1. That is, how global-referenced measurements are reformulated as residual body-referenced
measurements that are compatible with the presented
symmetries. Finally, Section 7 concludes with an experimental validation of the performance of the different
equivariant filters built upon the symmetries discussed
in Section 5.



**4** **The Biased Inertial Navigation Problem**


Consider a mobile robot equipped with an IMU providing angular velocity and acceleration measurements, as
well as other sensors providing partial direct or indirect
state measurements (e.g. a GNSS receiver providing position measurements or a magnetometer providing direction measurements). Let { _G_ } denote the global inertial
frame of reference and { _I_ } denote the IMU frame of reference. In non-rotating, flat earth assumption, the deterministic (noise-free) continuous-time biased inertial
navigation system is


_G_ **R** ˙ _I_ = _G_ **R** _I_ ( _I_ _**ω**_ − _I_ _**b**_ _**ω**_ ) ∧ _,_ (3a)

_G_ ˙ _**v**_ _I_ = _G_ **R** _I_ ( _I_ _**a**_ − _I_ _**b**_ _a_ ) + _G_ _**g**_ _,_ (3b)

_G_ ˙ _**p**_ _I_ = _G_ _**v**_ _I_ _,_ (3c)

_I_ ˙ _**b**_ _**ω**_ = _I_ _**τ**_ _**ω**_ _,_ (3d)

_I_ ˙ _**b**_ _**a**_ = _I_ _**τ**_ _a_ _._ (3e)


Here, _[G]_ **R** _I_ denotes the rigid body orientation, and _[G]_ _**p**_ _I_
and _[G]_ _**v**_ _I_ denote the rigid body position and velocity
expressed in the { _G_ } frame, respectively. These variables
are termed the _navigation states_ . The gravity vector _[G]_ _**g**_
is expressed in frame { _G_ }. The gyroscope measurement
and accelerometer measurement are written _[I]_ _**ω**_ and _[I]_ _**a**_
respectively. The two biases _[I]_ _**b**_ _**ω**_ and _[I]_ _**b**_ _**a**_ are termed
the _bias states_ . The inputs _**τ**_ _**ω**_, _**τ**_ _**a**_ are used to model
the biases’ dynamics, and are zero when the biases are
modeled as constant quantities.


The state space is M = SO(3)× R [3] × R [3] × R [3] × R [3] where
the 4 copies of R [3] model velocity, position, and angular and acceleration bias, respectively, and SO(3) is the
**SO** (3)-torsor with rotation matrices representing coordinates of orientation rather than physical rotation of
space. Note that the state space itself is not a Lie-group
in the EqF formulation. Rather symmetry is modeled as
a group action on M, allowing us to consider different
symmetries acting on the same INS state. We write an
element of the state space, and an element of the input
space respectively


_ξ_ = ( _[G]_ **R** _I_ _,_ _[G]_ _**v**_ _I_ _,_ _[G]_ _**p**_ _I_ _,_ _[I]_ _**b**_ _**ω**_ _,_ _[I]_ _**b**_ _**a**_ ) ∈M _,_ (4)

_u_ = ( _[I]_ _**ω**_ _,_ _[I]_ _**a**_ _,_ _[I]_ _**τ**_ _**ω**_ _,_ _[I]_ _**τ**_ _a_ ) ∈ L ⊂ R [12] _._ (5)


For the sake of clarity of the presentation, in the following sections, we drop subscripts and superscripts from
state, input and output variables, and adopt the lean
notation defined in Table 1.


**5** **INS Symmetries**


Starting with Tab. 2, we show the relation between INS
filters and symmetry group, as well as the differences in



4


Table 1
Descriptive-Lean Notation Conversion Table.


Descriptive Lean
Description
notation notation


Rigid body orientation _G_ **R** _I_ **R**


_G_
Rigid body velocity _**v**_ _I_ _**v**_


_G_
Rigid body position _**p**_ _I_ _**p**_
Angular velocity _I_ _**ω**_ _**ω**_
measurement


Gyroscope bias _I_ _**b**_ _**ω**_ _**b**_ _**ω**_


_I_
Acceleration measurement _**a**_ _**a**_


Accelerometer bias _I_ _**b**_ _**a**_ _**b**_ _**a**_


the state error linearization of filters built upon those
symmetries. In Sec. 5.1, 5.2 and 5.3, we discuss the symmetry groups that lead to the design of equivariant filters
equivalent to the widely-known MEKF, IEKF, and the
recently published TFG-IEKF. In Sec. 5.4 we briefly recall the tangent group recently introduced and exploited
for INS in our prior work [11, 10]. In Sec. 5.5 and 5.6,
we introduce two new symmetry groups for biased inertial navigation Systems. These groups are based on
the semi-direct product and aim to address the overparametrization of bias states introduced in our prior
work [11].


_5.1_ _Special Orthogonal group_ **G** **O** ∶ **SO** (3) × R [12]


Lie group theory was first applied to navigation systems
to overcome the limitation and the singularities of using
Euler angles as the parameterization of the attitude of
a rigid body. Originally formulated on the quaternion
group, the modern approach directly models attitude on
the Special Orthogonal group **SO** (3).


Define the symmetry group **G** **O** ∶= **SO** (3) × R [12],
and let _X_ = ( _A,a,b,α,β_ ) ∈ **G** **O**, where _A_ ∈ **SO** (3),
_a,b,α,β_ ∈ R [3] . Let _X_ = ( _A_ _X_ _,a_ _X_ _,b_ _X_ _,α_ _X_ _,β_ _X_ ),
_Y_ = ( _A_ _Y_ _,a_ _Y_ _,b_ _Y_ _,α_ _Y_ _,β_ _Y_ ) be two elements of the
symmetry group, then the group product is written
_XY_ = ( _A_ _X_ _A_ _Y_ _,a_ _X_ + _a_ _Y_ _,b_ _X_ + _b_ _Y_ _,α_ _X_ + _α_ _Y_ _,β_ _X_ + _β_ _Y_ ).
The inverse of an element _X_ is given by
_X_ [−][1] = ( _A_ [⊺] _,_ − _a,_ − _b,_ − _α,_ − _β_ ).


**Lemma 1** _Define ϕ_ ∶ **G** **O** × M →M _as_


_ϕ_ ( _X,ξ_ ) ∶= ( **R** _A,_ _**v**_ + _a,_ _**p**_ + _b,_ _**b**_ _**ω**_ + _α,_ _**b**_ _a_ + _β_ ) ∈M _._ (6)


_Then, ϕ is a transitive right group action of_ **G** **O** _on_ M _._


The existence of a transitive group action of the symmetry group **G** **O** on the state space M guarantees the
existence of a lift [18].


**Theorem 2** _Define the map_ Λ ∶M × L → g **O** _by_


Λ ( _ξ,u_ ) ∶= (Λ 1 ( _ξ,u_ ) _,_ ⋯ _,_ Λ 5 ( _ξ,u_ )) _._



_where_ Λ 1 ∶M × L → so(3) _,_ _and_
Λ 2 _,_ ⋯ _,_ Λ 5 ∶M × L → R [3] _are given by_


∧
Λ 1 ( _ξ,u_ ) ∶= ( _[I]_ _**ω**_ − _[I]_ _**b**_ _**ω**_ ) _,_ (7)

Λ 2 ( _ξ,u_ ) ∶= _[G]_ **R** _I_ ( _[I]_ _**a**_ − _[I]_ _**b**_ _a_ ) + _[G]_ _**g**_ _,_ (8)

Λ 3 ( _ξ,u_ ) ∶= _[G]_ _**v**_ _I_ _,_ (9)

Λ 4 ( _ξ,u_ ) ∶= _[I]_ _**τ**_ _**ω**_ _,_ (10)

Λ 4 ( _ξ,u_ ) ∶= _[I]_ _**τ**_ _a_ _._ (11)


_Then, the_ Λ _is a lift for the system in Equ. (3) with respect_
_to the symmetry group_ **G** **O** ∶= **SO** (3) × R [12] _._


In the appendix B, it is shown that an EqF designed using this symmetry results in the well-known MEKF [15].


_5.2_ _Extended_ _Special_ _Euclidean_ _group_
**G** **ES** ∶ **SE** 2 (3) × R [6]


Using the extended pose **SE** 2 (3) group to model the
navigation states of the INS problem is one of the major
developments in INS filtering in the last 10 years.


Define _ξ_ = ( **T** _,_ _**b**_ ) ∈M ∶= SE 2 (3) × R [6] to be the state
space of the system. **T** = ( **R** _,_ _**v**_ _,_ _**p**_ ) ∈SE 2 (3) is the
extended pose [6], which includes the orientation
the, velocity and the position of the rigid body,
whereas _**b**_ = ( _**b**_ _**ω**_ _,_ _**b**_ _**a**_ ) ∈ R [6] denotes the IMU biases. Let
_u_ = ( _**w**_ _,_ _**τ**_ ) ∈ L ⊆ R [12] denote the system input, where
_**w**_ = ( _**ω**_ _,_ _**a**_ ) ∈ R [6] denotes the input given by the IMU
readings, and _**τ**_ = ( _**τ**_ _**ω**_ _,_ _**τ**_ _**a**_ ) ∈ R [6] denotes the input for the
IMU biases. Define the matrices



**G** = ( ~~_**g**_~~ ) [∧] ∈ se 2 (3) _,_



**0** 3×3 **0** 3×1 **0** 3×1



⎤⎥⎥⎥⎥⎥⎥⎥⎦



**B** = ( _**b**_ ) [∧] ∈ se 2 (3) _,_ **N** = **0** 0 1 ∈ R [5][×][5] _._



**N** =



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 1×3 0 1


**0** 1×3 0 0



**W** = ( _**w**_ ) [∧] ∈ se 2 (3) _,_



Then, the system in Equ. (3) may then be written as


**T** ˙ = **T** ( **W** − **B** + **N** ) + ( **G** − **N** ) **T** _,_ (12a)

˙
_**b**_ = _**τ**_ _._ (12b)


Define the symmetry group **G** **ES** ∶= **SE** 2 (3) × R [6], and
let _X_ = ( _C,γ_ ) ∈ **G** **ES**, where _C_ = ( _A,a,b_ ) ∈ **SE** 2 (3),
_A_ ∈ **SO** (3), _a,b_ ∈ R [3], _γ_ ∈ R [6] . Let _X_ = ( _C_ _X_ _,γ_ _X_ ),
_Y_ = ( _C_ _Y_ _,γ_ _Y_ ) be two elements of the symmetry group, then the group product is written
_XY_ = ( _C_ _X_ _C_ _Y_ _,γ_ _X_ + _γ_ _Y_ ). The inverse of an element _X_
is given by _X_ [−][1] = ( _C_ [−][1] _,_ − _γ_ ).


2 The homogeneous Galilean group **HG** (3) is isomorphic to
**SE** (3) but acts on attitude and velocity rather than attitude
and position.



5


Table 2
Qualitative overview of the differences in the presented symmetries when exploited for filter design. The first column indicates
the filter that is obtained by applying equivariant filter design methodology with the symmetry in the second column. The
third column describes the features of the state error linearization for the specific filter, whereas the rightmost column shows
the linearized error dynamics. For readers that do not have time to compute the linearisations themselves, detailed derivations
are provided in appendix B
Filter Symmetry group State error linearization. **A** ∣ _**ε**_ ˙ ≃ **A** _**ε**_



Special Orthogonal
MEKF [15]
group **G** **O** ∶ **SO** (3)×R [12]


Extended Special
Imperfect-IEKF [1] Euclidean group
**G** **ES** ∶ **SE** 2 (3) × R [6]


Two-Frames group
TFG-IEKF [4] **G** **TF** ∶
**SO** (3) ⋉(R [6] ⊕ R [6] )


Tangent group
TG-EqF [11] **G** **TG** ∶ **SE** 2 (3) ⋉ se 2 (3)


Direct Position
DP-EqF group [2] **G** **DP** ∶
**HG** (3) ⋉ hg(3) × R [3]


Semi-Direct Bias group
SD-EqF
**G** **SD** ∶ **SE** 2 (3) ⋉ se(3)


**Lemma 3** _Define ϕ_ ∶ **G** **ES** × M →M _as_



State-dependent attitude
error dynamics.
State-dependent and
input-dependent velocity
error dynamics. Linear
time-invariant position error
dynamics. Linear timeinvariant bias error dynamics


State-dependent attitude,
position and velocity error
dynamics. Linear timeinvariant bias error dynamics


Linear time-invariant attitude
error dynamics.
State-dependent velocity and
position error dynamics.
State-dependent and
input-dependent bias error
dynamics


Linear time-invariant
attitude, velocity and
position error dynamics.
State-dependent and
input-dependent bias error
dynamics


Linear time-invariant attitude
and velocity error dynamics.
State-dependent and
input-dependent position and
bias error dynamics


Linear time-invariant attitude
and velocity error dynamics.
State-dependent position
error dynamics.
State-dependent and
input-dependent bias error
dynamics



_**ε**_ ˙ _R_ ≃− **R** [ˆ] _**ε**_ _b_ _ω_ + O ( _**ε**_ [2] ),

_**εε**_ ˙˙˙ _vp_ ≃−( ≃ _**ε**_ _v_, **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ )) ∧ _**ε**_ _R_ − **R** ˆ _**ε**_ _b_ _a_ + O ( _**ε**_ 2 ),
_**ε**_ _b_ = **0** .


_**ε**_ ˙ _R_ ≃− **R** [ˆ] _**ε**_ _b_ _ω_ + O ( _**ε**_ [2] ),
_**ε**_ ˙ _v_ ≃ _**g**_ [∧] _**ε**_ _R_ − _**v**_ ˆ [∧] **R** [ˆ] _**ε**_ _b_ _ω_ − **R** [ˆ] _**ε**_ _b_ _a_ + O ( _**ε**_ [2] ),
_**ε**_ ˙˙ _p_ ≃ _**ε**_ _v_ − _**p**_ ˆ [∧] **R** [ˆ] _**ε**_ _b_ _ω_ + O ( _**ε**_ [2] ),
_**ε**_ _b_ = **0** .


_**ε**_ ˙ _R_ ≃− _**ε**_ _b_ _ω_,
_**ε**_ ˙ _v_ ≃ _**g**_ [∧] _**ε**_ _R_ − _**v**_ ˆ [∧] _**ε**_ _b_ _ω_ − _**ε**_ _b_ _a_ + O ( _**ε**_ [2] ),
_**ε**_ ˙ _p_ ≃ _**ε**_ _v_ − _**p**_ ˆ [∧] _**ε**_ _b_ _ω_ + O ( _**ε**_ [2] ),

_**ε**_ _b_ ˙ _ω_ ≃( **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _ω_ )) ∧ _**ε**_ _b_ _ω_ + O ( _**ε**_ 2 ),

_**ε**_ _b_ ˙ _a_ ≃( **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _ω_ )) ∧ _**ε**_ _b_ _a_ + O ( _**ε**_ 2 ).


_**εεε**_ ˙˙˙ _Rvp_ ≃ ≃ ≃ _**εgε**_ _v_ [∧] _b_ + _ω_ _**ε**_, _**ε**_ _R_ + _b_ _ν_ _**ε**_, _b_ _a_,
_**ε**_ ˙ _b_ ≃ **ad** [∨] ( ˚ _**w**_ [∧] + **G** ) _**[ε]**_ _[b]_ [ + O (] _**[ε]**_ [2] [)][.]


_**εε**_ ˙˙ _Rv_ ≃ ≃ _**gε**_ [∧] _b_ _ω_ _**ε**_, _R_ + _**ε**_ _b_ _a_,
_**ε**_ ˙ _p_ ≃ _**ε**_ _v_ − ˚ _**ν ε**_ _R_ + O ( _**ε**_ [2] ),
_**ε**_ ˙ _b_ ≃ **ad** [∨] ( ˚ _**w**_ [∧] + **G** ) _**[ε]**_ _[b]_ [ + O (] _**[ε]**_ [2] [)][.]


_**εε**_ ˙˙ _Rv_ ≃ ≃ _**gε**_ [∧] _b_ _ω_ _**ε**_, _R_ + _**ε**_ _b_ _a_,
_**ε**_ ˙ _p_ ≃ _**ε**_ _v_ + ˆ _**p**_ [∧] _**ε**_ _b_ _ω_ + O ( _**ε**_ [2] ),
_**ε**_ ˙ _b_ ≃ **ad** [∨] ( ˚ _**w**_ [∧] + **G** ) _**[ε]**_ _[b]_ [ + O (] _**[ε]**_ [2] [)][.]



_ϕ_ ( _X,ξ_ ) ∶= ( **T** _C,_ _**b**_ + _γ_ ) ∈M _._ (13)


_Then, ϕ is a transitive right group action of_ **G** **ES** _on_ M _._


**Theorem 4** _Define the map_ Λ ∶M × L → g **ES** _by_


Λ ( _ξ,u_ ) ∶= (Λ 1 ( _ξ,u_ ) _,_ Λ 2 ( _ξ,u_ )) _,_


_where_ Λ 1 ∶M × L → se 2 (3) _, and_ Λ 2 ∶M × L → R [6]
_are given by_


Λ 1 ( _ξ,u_ ) ∶= ( **W** − **B** + **N** ) + **T** [−][1] ( **G** − **N** ) **T** _,_ (14)
Λ 2 ( _ξ,u_ ) ∶= _**τ**_ _._ (15)



_Then,_ Λ _is a lift for the system in Equ. (12) with respect_
_to the symmetry group_ **G** **ES** ∶= **SE** 2 (3) × R [6] _._


Applying the EqF filter design methodology to this symmetry leads to the Imperfect-IEKF [1, 2]. Note that
ignoring the bias and considering only the navigation
states is the original IEKF filter [1]. The imperfect term
comes from breaking the group-affine symmetry of the
navigation states by adding the direct product terms for
the bias.


_5.3_ _Two-Frames group:_ **G** **TF** ∶ **SO** (3) ⋉(R [6] ⊕ R [6] )


The recently published two-frames group invariant extended Kalman filter [4] is one approach to address the



6


theoretical issue in the imperfect IEKF for INS where
the bias terms are not part of the symmetry structure.


Consider the system in Equ. (12). Define the symmetry group **G** **TF** ∶= **SO** (3) ⋉(R [6] ⊕ R [6] ), where
**SO** (3) acts on two vector spaces of 6 dimensions each defined with respect to two different
frames of references. Let _X_ = ( _C,γ_ ) ∈ **G** **TF**, with
_C_ = ( _A,_ ( _a,b_ )) ∈ **SE** 2 (3) ∶= **SO** (3) ⋉ R [6] such that
_A_ ∈ **SO** (3) _,_ ( _a,b_ ) ∈ R [6] . Let, ∗∶ **SO** (3) × R [3] _[N]_ → R [3] _[N]_
be the rotation term introduced in [4], such
that ∀ _A_ ∈ **SO** (3) and _x_ = ( _x_ 1 _,_ ⋯ _,x_ _N_ ) ∈ R [3] _[N]_,
_A_ ∗ _x_ = ( _Ax_ 1 _,_ ⋯ _,Ax_ _N_ ). Define the group product _XY_ = ( _C_ _X_ _C_ _Y_ _,γ_ _X_ + _A_ _X_ ∗ _γ_ _Y_ ) The inverse element of the symmetry group writes
_X_ [−][1] = ( _C_ [−][1] _,_ − _A_ _[T]_ ∗ _γ_ ) ∈ **G** **TF** .


**Lemma 5** _Define ϕ_ ∶ **G** **TF** × M →M _as_


_ϕ_ ( _X,ξ_ ) ∶= ( **T** _C,A_ _[T]_ ∗( _**b**_ − _γ_ )) ∈M _._ (16)


_Then, ϕ is a transitive right group action of_ **G** **TF** _on_ M _._


**Theorem 6** _Define_ Λ 1 ∶M × L → se 2 (3) _as_


Λ 1 ( _ξ,u_ ) ∶= ( **W** − **B** + **N** ) + **T** [−][1] ( **G** − **N** ) **T** _,_ (17)


_define_ Λ 2 ∶M × L → R [6] _as_


Λ 2 ( _ξ,u_ ) ∶= ( _**b**_ [∧] _**ω**_ [(] _**[ω]**_ [ −] _**[b]**_ _**[ω]**_ [) −] _**[τ]**_ _**[ω]**_ _[,]_ _**[ b]**_ [∧] _**a**_ [(] _**[ω]**_ [ −] _**[b]**_ _**[ω]**_ [) −] _**[τ]**_ _**[a]**_ [)] _[.]_
(18)
_Then, the map_ Λ ( _ξ,u_ ) = (Λ 1 ( _ξ,u_ ) _,_ Λ 2 ( _ξ,u_ )) _is a lift for_
_the system in Equ. (12) with respect to the symmetry_
_group_ **G** **TF** ∶= **SO** (3) ⋉(R [6] ⊕ R [6] ) _._


In the appendix B, it is shown that designing and EqF
based on this symmetry leads to the recently published
TFG-IEKF [4].


_5.4_ _Tangent group_ **G** **TG** ∶ **SE** 2 (3) ⋉ se 2 (3)


Recent work [23, 22] considered symmetries and EqF
filter design on the tangent group T **G** of a general Liegroup. Since bias states are closely related to velocities,
these ideas can easily be extended symmetries for bias
states [11].


Define _ξ_ = ( **T** _,_ _**b**_ ) ∈M ∶= SE 2 (3) × R [9] to be the state
space of the system. **T** ∈SE 2 (3) represents the extended pose, whereas _**b**_ = ( _**b**_ _**ω**_ _,_ _**b**_ _**a**_ _,_ _**b**_ _**ν**_ ) ∈ R [9] represents
the IMU biases, and an additional virtual bias _**b**_ _**ν**_ . Let
_u_ = ( _**w**_ _,_ _**τ**_ ) ∈ L ⊆ R [18] denote the system input, where
_**w**_ = ( _**ω**_ _,_ _**a**_ _,_ _**ν**_ ) ∈ R [9] denotes the input given by the IMU
readings, and an additional virtual input _**ν**_ . Note that
we can set _**ν**_ = _**b**_ _**ν**_ such that the original dynamics in
Equ. (3) are recovered. _**τ**_ = ( _**τ**_ _**ω**_ _,_ _**τ**_ _**a**_ _,_ _**τ**_ _**ν**_ ) ∈ R [9] denotes the



input for the IMU biases. Define the matrices



**G** = ( ~~_**g**_~~ ) [∧] ∈ se 2 (3) _,_



**0** 3×3 **0** 3×1 **0** 3×1



⎤⎥⎥⎥⎥⎥⎥⎥⎦



**B** = _**b**_ [∧] ∈ se 2 (3) _,_ **N** = **0** 0 1 ∈ R [5][×][5] _._



**N** =



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 1×3 0 1


**0** 1×3 0 0



**W** = _**w**_ [∧] ∈ se 2 (3) _,_



With these newly defined matrices, the system in
Equ. (3) may then be written in compact form as in
Equ. (12). Note, however, that the matrices **B** and **W**
are different than those in Equ. (12).


Define the symmetry group **G** **TG** ∶= **SE** 2 (3) ⋉ se 2 (3),
and let _X_ = ( _C,γ_ ) ∈ **G** **TG**, where _C_ ∈ **SE** 2 (3), _γ_ ∈ se 2 (3).
Let _X_ = ( _C_ _X_ _,γ_ _X_ ), _Y_ = ( _C_ _Y_ _,γ_ _Y_ ) be two elements of the
symmetry group, then the group product is written
_XY_ = ( _C_ _X_ _C_ _Y_ _,γ_ _X_ + Ad _C_ _X_ [ _γ_ _Y_ ]). The inverse of an element _X_ is given by _X_ [−][1] = ( _C_ [−][1] _,_ −Ad _C_ −1 [ _γ_ ]).


**Lemma 7** _Define ϕ_ ∶ **G** **TG** × M →M _as_


_ϕ_ ( _X,ξ_ ) ∶= ( **T** _C,_ **Ad** [∨] _C_ [−][1] [ (] _**[b]**_ [ −] _[γ]_ [∨] [)) ∈M] _[.]_ (19)


_Then, ϕ is a transitive right group action of_ **G** **TG** _on_ M _._


From here, we derive a compatible action of the symmetry group **G** **TG** on the input space L and derive the lift
Λ via constructive design as described in [18, 28].


**Lemma 8** _Define ψ_ ∶ **G** **TG** × L → L _as_


_ψ_ ( _X,u_ ) ∶= ( **Ad** [∨] _C_ [−][1] [ (] _**[w]**_ [ −] _[γ]_ [∨] [) +][ Ω] [∨] [(] _[C]_ [−][1] [)] _[,]_ **[Ad]** [∨] _C_ [−][1] _**[ τ]**_ [ ) ∈] [L] _[.]_
(20)
_Then, ψ is a right group action of_ **G** **TG** _on_ L _._


The system in Equ. (12) is equivariant under the actions
_ϕ_ in Equ. (19) and _ψ_ in Equ. (20). The existence of a
transitive group action of the symmetry group **G** **TG** on
the state space M and the equivariance of the system
guarantees the existence of an equivariant lift [18].


**Theorem 9** _Define the map_ Λ ∶M × L → g **TG** _by_


Λ ( _ξ,u_ ) ∶= (Λ 1 ( _ξ,u_ ) _,_ Λ 2 ( _ξ,u_ )) _,_


_where_ Λ 1 ∶M × L → se 2 (3) _,_ _and_
Λ 2 ∶M × L → se 2 (3) _are given by_


Λ 1 ( _ξ,u_ ) ∶= ( **W** − **B** + **N** ) + **T** [−][1] ( **G** − **N** ) **T** _,_ (21)
Λ 2 ( _ξ,u_ ) ∶= ad _**b**_ [Λ 1 ( _ξ,u_ )] − _**τ**_ [∧] _._ (22)


_Then,_ Λ _is_ _an_ _equivaraint_ _lift_ _for_ _the_ _system_
_in Equ. (12) with respect to the symmetry group_
**G** **TG** ∶= **SE** 2 (3) × se 2 (3) _._



7


This approach requires the introduction of a new state
_**b**_ _**ν**_ in order to apply the full se 2 (3) semi-direct symmetry on the bias states. This new state is entirely virtual,
it does not exist in the real system. Since introducing an
entirely virtual state just for the sake of the symmetry
appears questionable, it is of interest to consider alternative symmetries that try to preserve the semi-direct
group structure that models bias interaction, but doesn’t
require the additional bias filter state.


_5.5_ _Direct Position group_ **G** **DP** ∶ **HG** (3) ⋉ hg(3) × R [3]


In this subsection, we investigate a symmetry that does
not require the over-parametrization of the state introduced in [11] given by the addition of a velocity
bias state. Specifically, we achieve this by considering a
semi-direct product symmetry only on the homogeneous
Galilean structure of the state space and an Euclidean
symmetry for the position state.


We introduce the term **HG** (3) for the _homogeneous_
_Galilean_ group. This corresponds to extended pose
transformations **SE** 2 (3) where the spatial translation is
zero. That is the symmetry acts on rotation and velocity
only with the semi-direct product induced by the **SE** 2 (3)
geometry. The homogeneous Galilean group is isomorphic to **SE** (3) in structure, however, since **SE** (3) is synonymous with pose transformation we use the **HG** (3)
notation to avoid confusion.


The first step towards these goals is to introduce a virtual
input _**ν**_ and rewrite Equ. (3c) as ˙ _**p**_ = **R** _**ν**_ + _**v**_ . Note that
the input _**ν**_ can be set to zero to recover the original
dynamics in Equ. (3).


Define _ξ_ = ( **T** _,_ _**p**_ _,_ _**b**_ ) ∈M ∶= HG(3) × R [3] × R [6] to be the
state space of the system, where **T** = ( **R** _,_ _**v**_ ) ∈HG(3) includes the orientation and the velocity of the rigid body.
Let _u_ = ( _**w**_ _,_ _**ν**_ _,_ _**τ**_ ) ∈ L ⊆ R [15] denote the system input. Define the matrices


**G** = ( ~~_**g**_~~ ) [∧] ∈ se(3) _,_ **B** = _**b**_ [∧] ∈ se(3) _,_ **W** = _**w**_ [∧] ∈ se(3) _._


Then, the system in Equ. (3) may then be written as


**T** ˙ = **T** ( **W** − **B** ) + **G T** _,_ (23a)

˙
_**p**_ = **R** _**ν**_ + _**v**_ _,_ (23b)

˙
_**b**_ = _**τ**_ _._ (23c)


Define the symmetry group
**G** **DP** ∶= **HG** (3) ⋉ se(3) × R [3], and let
_X_ = ( _B,β,c_ ) ∈ **G** **DP** with _B_ = ( _A,a_ ) ∈ **HG** (3) such
that _A_ ∈ **SO** (3) _, a_ ∈ R [3] . Let _X_ = ( _B_ _X_ _,β_ _X_ _,c_ _X_ ) _,Y_ =
( _B_ _Y_ _,β_ _Y_ _,c_ _Y_ ) ∈ **G** **DP**, the group product is written _XY_ = ( _B_ _X_ _B_ _Y_ _,β_ _X_ + Ad _B_ _X_ [ _β_ _Y_ ] _,c_ _X_ + _c_ _Y_ ). The
inverse of an element _X_ ∈ **G** **DP** is given by
_X_ [−][1] = ( _B_ [−][1] _,_ −Ad _B_ −1 [ _β_ ] _,_ − _c_ ) ∈ **G** **DP** .



**Lemma 10** _Define ϕ_ ∶ **G** **DP** × M →M _as_


_ϕ_ ( _X,ξ_ ) ∶= ( **T** _B,_ **Ad** [∨] _B_ [−][1] [ (] _**[b]**_ [ −] _[β]_ [∨] [)] _[,]_ _**[ p]**_ [ +] _[ c]_ [) ∈M] _[.]_ (24)


_Then, ϕ is a transitive right group action of_ **G** **DP** _on_ M _._


We derive a compatible action of the symmetry group
**G** **DP** on the input space L.


**Lemma 11** _Define ψ_ ∶ **G** **DP** × L → L _as_


_ψ_ ( _X,u_ ) ∶= ( **Ad** [∨] _B_ [−][1] [ (] _**[w]**_ [ −] _[β]_ [∨] [)] _[,A]_ _[T]_ [ (] _**[ν]**_ [ −] _[a]_ [)] _[,]_ **[Ad]** [∨] _B_ [−][1] _**[ τ]**_ [ ) ∈] [L] _[.]_
(25)
_Then, ψ is a right group action of_ **G** **DP** _on_ L _._


The system in Equ. (23) is equivariant under the actions
_ϕ_ in Equ. (24) and _ψ_ in Equ. (25). Therefore, the existence of an equivariant lift is guaranteed.


**Theorem 12** _Define the map_ Λ ∶M × L → g **DP** _by_


Λ ( _ξ,u_ ) ∶= (Λ 1 ( _ξ,u_ ) _,_ Λ 2 ( _ξ,u_ ) _,_ Λ 3 ( _ξ,u_ )) _,_


_where_ Λ 1 ∶M × L → hg(3) _,_ Λ 2 ∶M × L → se(3) _, and_
Λ 3 ∶M × L → R [3] _are given by_


Λ 1 ( _ξ,u_ ) ∶= ( **W** − **B** ) + **T** [−][1] **G T** _,_ (26)
Λ 2 ( _ξ,u_ ) ∶= ad _**b**_ ∧ [Λ 1 ( _ξ,u_ )] − _**τ**_ [∧] _,_ (27)
Λ 3 ( _ξ,u_ ) ∶= **R** _**ν**_ + _v._ (28)


_Then, the_ Λ _is an equivariant lift for the system_
_in Equ. (23) with respect to the symmetry group_
**G** **DP** ∶= **HG** (3) ⋉ hg(3) × R [3] _._


The symmetry proposed in this subsection allows for
a minimal state parametrization (i.e. absence of overparametrization of the state with additional state variables ). However, the construction comes at the cost of
separating the position state from the geometric **SE** 2 (3)
structure and modeling it as a direct product linear

space.


_5.6_ _Semi-Direct Bias group:_ **G** **SD** ∶ **SE** 2 (3) ⋉ se(3)


In this subsection, we investigate a symmetry that maintains a minimal state representation (not requiring the
introduction of an additional velocity bias state) while
keeping the position state within the geometric structure given by **SE** 2 (3).


Consider the system in Equ. (12). Define the symmetry group **G** **SD** ∶= **SE** 2 (3) ⋉ se(3) with group product
_XY_ = ( _C_ _X_ _C_ _Y_ _,γ_ _X_ + Ad _C_ _X_ [ _γ_ _Y_ ]) for _X_ = ( _C_ _X_ _,γ_ _X_ ) _,Y_ =
( _C_ _Y_ _,γ_ _Y_ ) ∈ **G** **SD** . Here, for _X_ = ( _C,γ_ ) ∈ **G** **SD**
one has _C_ = ( _A,a,b_ ) = ( _B,b_ ) ∈ **SE** 2 (3) such that



8


_A_ ∈ **SO** (3) _, a,b_ ∈ R [3], and _B_ = ( _A,a_ ) ∈ **HG** (3). The element _C_ ∈ **SE** 2 (3) in its matrix representation is written



⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦





⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦



∈ **SE** 2 (3) _._







_C_ =



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣





=



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣



The inverse element is written


_X_ [−][1] = ( _C_ [−][1] _,_ −Ad _B_ −1 [ _γ_ ]) ∈ **G** **SD** _._


**Lemma 13** _Define ϕ_ ∶ **G** **SD** × M →M _as_


_ϕ_ ( _X,ξ_ ) ∶= ( **T** _C,_ **Ad** [∨] _B_ [−][1] [ (] _**[b]**_ [ −] _[γ]_ [∨] [)) ∈M] _[.]_ (29)


_Then, ϕ is a transitive right group action of_ **G** **SD** _on_ M _._


**Theorem 14** _Define_ Λ 1 ∶M × L → se 2 (3) _as_


Λ 1 ( _ξ,u_ ) ∶= ( **W** − **B** + **N** ) + **T** [−][1] ( **G** − **N** ) **T** _,_ (30)


_define_ Λ 2 ∶M × L → se(3) _as_


Λ 2 ( _ξ,u_ ) ∶= ad _**b**_ ∧ [Π (Λ 1 ( _ξ,u_ ))] − _**τ**_ [∧] _,_ (31)


_Then, the map_ Λ ( _ξ,u_ ) = (Λ 1 ( _ξ,u_ ) _,_ Λ 2 ( _ξ,u_ )) _is a lift for_
_the system in Equ. (12) with respect to the symmetry_
_group_ **G** **SD** ∶= **SE** 2 (3) ⋉ se(3) _._


The symmetry proposed in this subsection is a variation
of the symmetry defined in our previous work [11] that
does not require over-parametrization of the state and
additional state variables.


**6** **Linearization Error Analysis**


In Sec. 5, we present different symmetry groups for the
inertial navigation problem. An indicator of the performance of an EqF with a particular symmetry is the order
of approximation error in the associated linearization of
error dynamics.

˚ _ξ_ For all symmetries, the origin ∶= ( **R** ˚ _,_ ˚ _**v**_ _,_ ˚ _**p**_ _,_ _**b**_ [˚] _**ω**_ _,_ _**b**_ [˚] _a_ ) = ( **I** 3 _,_ **0** 3× [˚] _ξ_ 1 ∈M _,_ **0** 3×1 _,_ is chosen to be **0** 3×1 _,_ **0** 3×1 ). Define the local coordinate chart _ϑ_ ∶U ˚ _ξ_ [→] [R] _[n]_ [, to be]


_ϑ_ ∶= ( _ϕ_ ˚ _ξ_ [⋅] [exp] **[G]** [)] [−][1] [ =][ log] **[G]** [⋅] _[ϕ]_ ˚ [−] _ξ_ [1] _[,]_ (32)


on a neighborhood of [˚] _ξ_ ∈M such that log **G** ⋅ _ϕ_ ˚ [−] _ξ_ [1] is bijective. The chart _ϑ_ is always well-defined locally since all
group actions considered are free. The local error coordinates are defined by _ε_ ∶= _ϑ_ ( _e_ ), so long as _e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ )
remains in the domain of definition of _ϑ_ .



In Equ. (32), log **G** denotes the log coordinates on the
symmetry group considered. This map is different for
each symmetry group. For a product Lie group **G** ∶=
**G** 1 × **G** 2, the logarithm is given by log **G** (( _A,B_ )) =
(log **G** 1 ( _A_ ) _,_ log **G** 2 ( _B_ )). When the product groups are
Lie groups with well-known exponential maps, then the
standard expressions are used [8]. For the semi-direct
product groups **G** ⋉ g where g is the Lie algebra of **G**, we
will use a matrix realization to compute the exponential
and the logarithm algebraically.


In the rightmost column of Tab. 2, we present the linearization of the state error dynamics associated with
each of the symmetries considered. The linearization is
expressed in terms of elements _ε_ = log( _E_ ) ∈ g where the
element _E_ ∈ **G** corresponds bijectively to the error _e_ ∈M
through the free group action. That is, we solve


D _ϑ_ [−][1] ( _ε_ )[ ˙ _ε_ ] ≈ [d]

d _t_ _[e]_ [ =] _[ f]_ [(] _[ϑ]_ [−][1] [(] _[ε]_ [)] _[,u]_ [)]


for ˙ _ε_ to first order in _ε_ . Here ˙ _e_ = _f_ ( _e,u_ ) is the full error dynamics expressed as a function of _e_ and the input _u_ [20, 29]. Finally, the filter design follows the procedure outlined in Sec. 2 and in the authors’ earlier
works [29, 20, 11, 10]. The detailed derivation of the error linearization for each symmetry, as well as the related
equivariant filters, are provided in the appendix B.


Barrau and Bonnabel [1] developed the IEKF for the
bias free INS problem and showed that the linearization
of the navigation states was exact. This was a significant improvement on the MEKF geometry, where the
linearization of the navigation states is not exact, independently of the bias. However, this exact linearization
property is lost when bias is added to the INS problem,
the system is no longer group affine [2]. Using a direct
product geometric structure to add bias leads to the
Imperfect-IEKF [2] and introduces linearization error in
the navigation state equations (cf. Tab. 2). The remaining filters all model coupling between bias and navigation states using semi-direct geometry of some form or
other. The TG-EqF is the only filter for which the linearization of the navigation state is exact. In this case,
the linearization error is only present in the bias states.
The DP-EqF, SD-EqF and TFG-IEKF all have semidirect geometric coupling between part of their navigation states and the bias states leading to exact or improved linearization where the coupling acts compatibly
with the T **G** structure.


**7** **Application: position-based localization**


In the present section, we discuss a practical application of the symmetries presented in Sec. 5, that is UAV
position-based localization.



9


Consider the system in Equ. (3), and consider the output
for global position measurements:


_h_ ( _ξ_ ) = _**p**_ ∈ R [3] _._ (33)


It is straightforward to verify the **G** **ES** _,_ **G** **TG** _,_ **G** **SD** _,_ **G** **TF**
symmetries do not possess output equivariance [28, 29]
for global position measurements directly.


_7.1_ _Reformulation of position measurements as equiv-_
_ariant_


Here, we show how position measurements can be reformulated as residual body-frame measurements imposing
a nonlinear constraint [14]. The modified measurement
is output equivariant with respect to a suitable group
action, and the linearization methodology proposed in

[29] can be applied to generate cubic linearization error
in the output.


**Lemma 15** _Let_ _**π**_ _be a measurement of global position._
_Define a new measurement model h_ ( _ξ_ ) ∈ R [3] _, describ-_
_ing the body-referenced difference between the measured_
_global position and the position state as follows_


_h_ ( _ξ_ ) = **R** _[T]_ ( _**π**_ − _**p**_ ) ∈ R [3] _._ (34)


_Let y_ = _h_ ( _ξ_ ) ∈N _be a measurement defined according to_
_the above model in Equ. (34), define ρ_ ∶ **G** × R [3] → R [3]
_such that_
_ρ_ _X_ ( _y_ ) ∶= _A_ _[T]_ ( _y_ − _b_ ) _._ (35)
_Then, the output defined in Equ. (34) is equivariant._


The noise-free value for _y_ is zero and the output innovation _δ_ ( _ρ_ ˆ _X_ [−][1] [ (] **[0]** [)) =] _[ ρ]_ [ ˆ] _X_ [−][1] [ (] **[0]** [) −] _**[π]**_ [ measures the mismatch]
of the observer state in reconstructing the true state up
to noise in the raw measurement _**π**_ .


_7.2_ _Experimental evaluation_


We document results from a suite of experiments chosen to provide a comparison of the performance of the
MEKF, the Imperfect-IEKF, the TFG-IEKF, an EqF
based on the **G** **TG** symmetry [11] termed TG-EqF, an
EqF based on the **G** **DP** symmetry termed DP-EqF, and
an EqF based on the **G** **SD** symmetry termed SD-EqF.
Moreover, given the global nature of the measurement,
we included in the comparison a left-sided ImperfectIEKF which directly uses the measurement in Equ. (33).
Note that each of the aforementioned EqFs have been
implemented including the reset step discussed in Sec. 2,
whereas the Imperfect-IEKFs and the TFG-IEKF have
been implemented without reset step, according to their
original implementation, discussed in [1, 4] respectively.
We undertake two separate experimental analyses. In the
first experiment, we undertake a Monte-Carlo simulation of an UAV equipped with an IMU receiving acceleration and angular velocity measurements at 200Hz and



receiving global position measurements at 10Hz, simulating a GNSS receiver. In the second experiment, we
compare all the filters with real data from the INSANE
dataset [5].


_7.3_ _UAV Flight Simulation_


In this experiment, we conducted a Monte-Carlo simulation, including four hundred runs of a simulated UAV
equipped with an IMU and receiving global position
measurements simulating a GNSS receiver. In order to
simulate realistic flight conditions, we selected the initial 80s from four sequences in the Euroc dataset’s vicon
room [7] as reference trajectories. For each sequence, we
generated a hundred runs, incorporating synthetic IMU
data generated interpolating and differentiating the Vicon poses, and position measurements while varying the
initial conditions for the position (distributed normally
around zero with 1m standard deviation per axis) and
the attitude (distributed normally around zero with 20 [○]
standard deviation per axis). This experiment considers common realistic condition. For application of the
semi-direct product symmetries in scenarios of difficult
alignment we refer the reader to the authors’ related
work [11, 10, 25, 9].


The ground truth IMU biases are randomly generated
every run following a Gaussian distribution with standard deviation of 0 _._ 01rad/s ~~[√]~~ ~~s~~ for the gyro bias and
0 _._ 01m/s [2] ~~[√]~~ ~~s~~ for the accelerometer bias. To simulate realistic global position measurement, additive Gaussian
noise with a standard deviation of 0 _._ 2m per axis is added.


For a fair comparison, we were careful to use the same
prior distributions and noise parameters for all filters.
This includes accounting for the different scaling and
transformations of noise due to the input and state
parametrizations for the different geometries. Similarly,
each filter shares the same input and output measurement noise covariance adapted to the particular geometry of the filter. The validity of the noise models can
be verified in the Average Energy plot (Fig. 1a), which
plots the average normalized estimation error squared
(ANEES) [16]. Here, all filters initialize with unity
ANEES, demonstrating that the prior sampling and observer response corresponds to the stochastic prior used,
and all filters converge towards unity ANEES as expected from a filter driven by Gaussian noise. All the
filters are initialized at the identity (zero attitude, zero
position, zero velocity, and zero biases).


The primary plots in Fig. 1a show the RMSE values for
the navigation states (on the top) and the bias states
(on the bottom). It is clear that the MEKF filter demonstrates worse performance than the modern geometric
filters. There is little difference visible in the transient
and asymptotic error response of the navigation states
for the modern filters. The remaining attitude error is



10


(a) Average RMSE and sample variance (shaded) of the filters’ states, and full filter energy.


(b) Orientation and position states evolution, and innovation energy for the real-world UAV flight experiment.


Figure 1. Simulation and real-world experiments’ results. Orange: R-IEKF. Brown: L-IEKF. Purple: TFG-IEKF. Magenta:
TG-EqF. Green: DP-EqF. Yellow: SD-EqF.



due to yaw error. The position and velocity errors converge to the noise limits of the measurement signals. In
contrast, there are clear differences visible in the transient response of the bias states. To make the difference
in the transient response clearer, Tab. 3, shows the average RMSE values of each filter for the first 30s of the trajectory and the percentage improvement of the geometric filters with respect to the MEKF. Additionally, Tab. 4
shows the time taken by each filter to reach an average
RMSE below 10% of the maximum RMSE value. Based
on these results, the filters split roughly into three categories: the three filters with semi-direct bias symmetry
(TG-EqF, DP-EqF and SD-EqF) which appear to display the best transient response in any state. The IEKFs
and TFG-IEKF, which have the **SE** 2 (3) symmetry but
do not use a semi-direct geometry for the bias geometry,
have similar bias transient. The accelerometer bias, in
particular, is clearly separated from the filters with the



semi-direct group symmetry. Finally, the MEKF which
suffers from not modeling the **SE** 2 (3) symmetry at all.


The average energy plot provides an additional important analysis tool. This plot shows the ANEES [16] defined as



where _**ε**_ is the specific filter error state, **Σ** is the error
covariance, _M_ = 400 is the number of runs in the MonteCarlo simulation, and _n_ is the dimension of the state
space. The ANEES provides a measure of the consistency of the filter estimate. An ANEES of unity means
that the observed error variance corresponds exactly to
the estimated covariance of the information state. When
ANEES is larger than unity, it indicates that the filter is
overconfident; that is, the observed error is larger than
the estimate of the state covariance predicts. All ‘pure’



1
ANEES =
_nM_



_M_
∑ _**ε**_ _[T]_ _i_ **[Σ]** [−] _i_ [1] _**ε**_ _i_ _,_
_i_ =1



11


Table 3
RMSE values and percentage of improvement of the geometric filters with respect to the MEKF for the first 30s of the UAV
simulation, corresponding to the transient phase (T). Best values are in **bold**, second best values are underlined. In the table,
R-IEKF and L-IEKF represent respectively the right-sided and the left-sided Imperfect-IEKF.


RMSE (T) MEKF R-IEKF L-IEKF TFG-IEKF TG-EqF DP-EqF SD-EqF


Orientation 0 _._ 1108 (100%) 0 _._ 1076 (97%) 0 _._ 1011 (91%) 0 _._ 1082 (98%) **0** _._ **0938** ( **85** %) 0 _._ 0968 (87%) 0 _._ 0939 (85%)


Position 0 _._ 1433 (100%) 0 _._ 1276 (89%) 0 _._ 129 (90%) 0 _._ 1290 (90%) 0 _._ 1267 (88%) 0 _._ 1270 (89%) **0** _._ **1263** ( **88** %)


Velocity 0 _._ 1728 (100%) 0 _._ 1459 (84%) 0 _._ 146 (84%) 0 _._ 1488 (86%) 0 _._ 1411 (82%) 0 _._ 1411 (82%) **0** _._ **1399** ( **81** %)


Gyro bias 0 _._ 0054 (100%) 0 _._ 0044 (83%) 0 _._ 0045 (83%) 0 _._ 0046 (85%) 0 _._ 0043 (81%) 0 _._ 0043 (81%) **0** _._ **0043** ( **80** %)


Acc bias 0 _._ 0134 (100%) 0 _._ 0125 (94%) 0 _._ 013 (95%) 0 _._ 0126 (94%) **0** _._ **0116** ( **87** %) 0 _._ 0117 (88%) 0 _._ 0119 (89%)


Table 4
Transient times taken by each filter to reach an average RMSE below 10% of the maximum RMSE value. The accelerometer
bias is excluded since the average RMSE never reached a value below 10% of the maximum RMSE value. Best values are
in **bold**, second best values are underlined. In the table, R-IEKF and L-IEKF represent respectively the right-sided and the
left-sided Imperfect-IEKF.


Transient time MEKF R-IEKF L-IEKF TFG-IEKF TG-EqF DP-EqF SD-EqF


Orientation 32 _._ 090 (100%) 23 _._ 095 (72%) 26 _._ 595 (83%) 23 _._ 995 (75%) 21 _._ 295 (66%) **20** _._ **395** ( **64** %) 21 _._ 295 (66%)


Position 5 _._ 095 (100%) 4 _._ 795 (94%) **4** _._ **595** ( **90** %) 4 _._ 795 (94%) 4 _._ 995 (98%) 4 _._ 795 (94%) 4 _._ 795 (94%)


Velocity 16 _._ 295 (100%) **12** _._ **495** ( **77** %) 15 _._ 895 (98%) **12** _._ **495** ( **77** %) **12** _._ **495** ( **77** %) 12 _._ 695 (78%) **12** _._ **495** ( **77** %)


Gyro bias 17 _._ 095 (100%) 16 _._ 095 (94%) 16 _._ 395 (96%) 16 _._ 295 (95%) **15** _._ **895** ( **93** %) 16 _._ 195 (95%) **15** _._ **895** ( **93** %)


Table 5
ANEES for the first 30s, corresponding to the transient phase (T) and for the remaining of the trajectory length, corresponding
to the asymptotic phase (A). Best values are in **bold**, second best values are underlined. In the table, R-IEKF and L-IEKF
represent respectively the right-sided and the left-sided Imperfect-IEKF.


ANEES MEKF R-IEKF L-IEKF TFG-IEKF TG-EqF DP-EqF SD-EqF


Transient (T) 3 _._ 11 1 _._ 36 1 _._ 39 1 _._ 71 **1** _._ **20** 1 _._ 44 1 _._ 32


Asymptotic (A) 1 _._ 69 1 _._ 40 **1** _._ **20** 1 _._ 43 1 _._ 22 1 _._ 42 1 _._ 44



extended Kalman filters tend to be overconfident since
their derivation ignores linearization errors in the model.
The closer to an ANEES of unity that a filter manages
is directly correlated to the consistency of the filter estimate and is usually linked to smaller linearization errors. To provide numeric results, we have averaged the
ANEES values over the transient and asymptotic sections of the filter response and presented them in Tab. 5.
Here, it is clear that the TG-EqF is superior, with a consistent ANEES for the whole duration of the experiment,
the five other filters R-IEKF, L-IEKF TFG-IEKF, DPEqF and SD-EqF are similar in the transient phase, with
the L-IEKF that improves in the asymptotic phase. Finally, the MEKF is worst. The ANEES of the MEKF
diverges to over seven before converging, corresponding
to an overconfidence of a factor of seven standard deviations in the state error. Such a level of overconfidence
is dangerous in a real-world scenario and may indeed
lead to divergence of the filter estimate in certain situations. Note that in practice, overconfidence of a filter is
avoided by inflating the process noise model covariance
to account for linearization error in the model. A more
consistent filter requires a smaller covariance inflation



and has correspondingly more confidence in its model
than a filter that is less consistent.


In conclusion, the TG-EqF exhibits the best convergence
rate, particularly in orientation and IMU biases, as well
as the best consistency of all the filters. Hence, the TGEqF is the filter we recommend using for INS problems.
We believe that this performance can be traced back to
the coupling of the IMU bias with the navigation states
that are inherent in the semi-direct product structure of
the symmetry group **G** **TG** and the exact linearization of
the navigation error dynamics (Tab. 2). Note that the
bias states are poorly observable states and possess slow
dynamics. Consequently, moving linearization error into
these states heuristically appears better than leaving the
linearization error in the main navigation states that are
much more dynamic.


_7.4_ _Real-world UAV flight_


In this experiment, we compared the performance of
the discussed filters in a real-world UAV flight scenario
from the INSANE dataset [5]. In particular, in this ex


12


periment, a quadcopter is flying for 50m at a maximum
height of 13m covering an area of roughly 200m [2], at a
maximum speed of 3m/s. The UAV is receiving IMU
measurements at 200Hz, as well as measurements from
and RTK-GNSS receiver at 8Hz with an accuracy between 0 _._ 1m and 0 _._ 6m. The position and orientation reference has been obtained as described in [5] from raw
sensor measurements of two RTK-GNSS and a magnetometer.


Similar to the previous experiments, all the filters share
the same tuning parameters.


Fig. 1b shows the evolution of each filter orientation and
position estimates, as well as the innovation energy, commonly referred to as the Normalised Innovation Squared
(NIS) error

NIS = _n_ [1] _**[r]**_ _[T]_ **[ S]** [−][1] _**[ r]**_ _[,]_


where _**r**_ is the specific measurement residual of dimension _n_ computed via the output action _ρ_ and **S** is the
innovation covariance. The results in Fig. 1b show that
the high level conclusions from the simulations are confirmed on real data. There are slight differences between
filters in the plotted results but due to the lack of accurate ground truth all that can be deduced is that all
the filters provide high quality real-world INS solutions.
This is not surprising since the MEKF is the industry
standard and is know to perform well in practice and
the more modern filters are expected to improve on this
performance.


**8** **Conclusion**


This study investigates inertial navigation system filter
design from the perspective of symmetry. We establish
a unifying framework, demonstrating that various modern INS filter variants can be interpreted as equivariant
filters applied to distinct choices of symmetry, with the
group structure being the only difference among those
filter variants. With specific application to position measurements, we demonstrated that fixed-frame measurements can be reformulated as body-frame relative measurements. This allows one to exploit the equivariance
of the output, ensuring third-order linearization error in
the measurement equations.


We discussed and presented different symmetry groups
acting on the state-space of the INS problem. Novel symmetries are introduced alongside analysis of similarities
and differences in the context of filter design. Furthermore, we showed how different choices of symmetries
lead to filters with different linearized error dynamics,
and how the **G** **TG** symmetry yields exact linearization
of the navigation error, shifting all the lineraisation error into the bias state dynamics.



Comparative performance studies in simulation, and
real-world of a vehicle equipped with an IMU and receiving position measurement from a GNSS receiver highlighted that any of the R-IEKF, L-IEKF, TFG-IEKF,
TG-EqF, DP-EqF, and SD-EqF are good candidates for
high performance INS filter design with the TG-EqF
demonstrating superior performance.


**9** **Acknowledgment**


The authors would like to thank Martin Scheiber for
his invaluable support and insightful discussions, which
helped achieve the results presented in the manuscript.
The authors would also like to thank the reviewers for
their insightful critique that has substantially improved
the contribution of the paper.


**A** **Mathematical Preliminaries**


In this section, we provide a quick overview of fundamental concepts in Lie theory.


_A.1_ _Lie theory_


A Lie group **G** is a smooth manifold endowed with a
smooth group structure. For any _X,Y_ ∈ **G**, the group
multiplication is denoted _XY_, the group inverse _X_ [−][1]
and the identity element _I_ .


Given a Lie group **G**, G denotes the **G** -Torsor [19], which
is defined as the set of elements of **G** (the underlying
manifold), but without the group structure.


For a given Lie group **G**, the Lie algebra g can be modelled as a vector space corresponding to the tangent
space at the identity of the group, together with a bilinear non-associative map [⋅ _,_ ⋅] ∶ g → g called the _Lie_
_bracket_ . For a matrix Lie group, the Lie bracket is equal
to the matrix commutator:


[ _η,κ_ ] = _ηκ_ − _κη,_


for any _η,κ_ ∈ g ⊂ R _[n]_ [×] _[n]_ .


The Lie algebra g is isomorphic to a vector space R _[n]_
of dimension _n_ = dim (g). Define the _wedge_ map and its
inverse, the _vee_ map, as linear mappings between the
vector space and the Lie algebra:


(⋅) [∧] ∶ R _[n]_ → g _,_ (⋅) [∨] ∶ g → R _[n]_ _._


For any _X,Y_ ∈ **G**, define the left and right translation


L _X_ ∶ **G** → **G** _,_ L _X_ ( _Y_ ) = _XY,_
R _X_ ∶ **G** → **G** _,_ R _X_ ( _Y_ ) = _Y X._



13


The Adjoint map for the group **G**, Ad _X_ ∶ g → g is
defined by


Ad _X_ [ _**u**_ [∧] ] = dL _X_ dR _X_ −1 [ _**u**_ [∧] ] _,_


for every _X_ ∈ **G** and _**u**_ [∧] ∈ g, where dL _X_, and dR _X_ denote the differentials of the left, and right translation,
respectively. Given particular wedge and vee maps for a
matrix Lie group, the Adjoint matrix is defined as the
map **Ad** [∨] _X_ [∶] [R] _[n]_ [ →] [R] _[n]_


∨
**Ad** [∨] _X_ _**[u]**_ [ = (][Ad] _[X]_ [[] _**[u]**_ [∧] [])] _._


In addition to the Adjoint map for the group **G**, the
adjoint map for the Lie algebra g can be defined as the
differential at the identity of the Adjoint map for the
group **G** . The adjoint map for the Lie algebra ad _**u**_ ∧ ∶
g → g is given by


ad _**u**_ ∧ [ _**v**_ [∧] ] = [ _**u**_ [∧] _,_ _**v**_ [∧] ] _,_


and is equivalent to the Lie bracket. Given particular
wedge and vee maps for a matrix Lie group, we define
the adjoint matrix **ad** [∨] _**u**_ [∶] [R] _[n]_ [ →] [R] _[n]_ [ to be]


∨ ∧ ∧ ∨
**ad** [∨] _**u**_ _**[v]**_ [ = (] _**[u]**_ [∧] _**[v]**_ [∧] [−] _**[v]**_ [∧] _**[u]**_ [∧] [)] = [ _**u**_ _,_ _**v**_ ] _._


For all _**u**_ _,_ _**v**_ ∈ R _[n]_ and _X_ ∈ **G**, the two adjoints commute:


Ad _X_ [ad _**u**_ ∧ [ _**v**_ [∧] ]] = ad (Ad _X_ [ _**u**_ ∧ ]) [Ad _X_ [ _**v**_ [∧] ]] _,_

**Ad** [∨] _X_ **[ad]** [∨] _**u**_ _**[v]**_ [ =] **[ ad]** [∨] **Ad** [∨] _X_ _**[u]**_ **[Ad]** _X_ [∨] _**[v]**_ _[,]_


_A.2_ _Semi-direct product groups_


A semi-direct product group **G** ⋉ **H** can be seen as a
generalization of the direct product group **G** × **H** where
the underlying set is given by the cartesian product of
two groups **G** and **H** . Contrary to the direct product,
in the semi-direct product, the group multiplication is
defined with the group **G** that acts on a group **H** by a
group automorphism. Note that the semi-direct product
group **G** ⋉ **H** with the trivial automorphism corresponds
to the direct product group **G** × **H** .


In this work we will consider a semi-direct product symmetry group [23], [21], [22] **G** [⋉] g [∶=] **[ G]** [⋉][g][ where][ g][ is the Lie]
algebra of **G**, or a subalgebra of **G**, that is, a vector space
group under addition. Let _A,B_ ∈ **G** and _a,b_ ∈ g and
define _X_ = ( _A,a_ ) and _Y_ = ( _B,b_ ) elements of the symmetry group **G** [⋉] g [. Group multiplication is defined to be]
the semi-direct product _Y X_ = ( _BA,b_ + Ad _B_ [ _a_ ]). The
inverse element is _X_ [−][1] = ( _A_ [−][1] _,_ −Ad _A_ −1 [ _a_ ]) and identity
element is ( _I,_ 0).



_A.3_ _Lie group action and homogeneous space_


A right group action of a Lie group **G** on a differentiable
manifold M is a smooth map _ϕ_ ∶ **G** × M →M that
satisfies


_ϕ_ ( _I,ξ_ ) = _ξ,_ _ϕ_ ( _X,ϕ_ ( _Y,ξ_ )) = _ϕ_ ( _Y X,ξ_ ) _,_


for any _X,Y_ ∈ **G** and _ξ_ ∈M. A right group action _ϕ_
induces a family of diffeomorphism _ϕ_ _X_ ∶M →M and
smooth projections _ϕ_ _ξ_ ∶ **G** →M. The group action _ϕ_
is said to be transitive if the induced projection _ϕ_ _ξ_ is
surjective. In this case, M is a homogeneous space of **G** .


_A.4_ _Important Lie groups_


The _special orthogonal group_ **SO** (3) is the Lie group of
3D rotations in space. The special orthogonal group and
its Lie algebra are defined as follows:


**SO** (3) = { **A** ∈ R [3][×][3] ∣ **AA** [⊺] = **I** 3 _,_ det( **A** ) = 1} _,_

so(3) = { _**ω**_ [∧] ∈ R [3][×][3] ∣ _**ω**_ [∧] = − _**ω**_ [∧⊺] _,_ _**ω**_ [∧] _**v**_ = _**ω**_ × _**v**_ } _,_


where × represents the cross-product.


The _special Euclidean group_ **SE** (3) is the group of 3D
rigid body transformation in space. Note that **SE** (3)
is defined as a semi-direct product group, specifically,
**SE** (3) ∶= **SO** (3) ⋉ R [6] . The special Euclidean group and
its Lie algebra are defined as follows:



⎡⎢⎢⎢⎢⎣

⎡⎢⎢⎢⎢⎣



∈ R [4][×][4] **A** ∈ **SO** (3) _,_ _**b**_ ∈ R [3] _,_
⎤⎥⎥⎥⎥⎦ ������������ ⎫⎪⎪⎬⎪⎪⎭



∈ R [4][×][4] _**ω**_ [∧] ∈ so(3) _,_ _**w**_ ∈ R [3] _,_
⎤⎥⎥⎥⎥⎦ ������������ ⎫⎪⎪⎬⎪⎪⎭



**SE** (3) =
⎧⎪⎪⎨⎪⎪⎩



**A** _**b**_



**0** 1×3 1



se(3) =
⎧⎪⎪⎨⎪⎪⎩



_**ω**_ [∧] _**w**_



**0** 1×3 0



The _extended special Euclidean group_ **SE** 2 (3) [2, 1, 3, 6]
is an extension of the special Euclidean group. The group
and its Lie algebra are defined as follows:



⎤⎥⎥⎥⎥⎥⎥⎥⎦



_,_

⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭



**A** _**a b**_



**A** ∈ **SO** (3) _,_ _**a**_ _,_ _**b**_ ∈ R [3]

������������������



**SE** 2 (3) =


se 2 (3) =



⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩

⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩



⎡⎢⎢⎢⎢⎢⎢⎢⎣

⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 1×3 0 0


**0** 1×3 0 0



**0** 1×3 1 0


**0** 1×3 0 1



∈ R [5][×][5]



_**ω**_ [∧] ∈ so(3) _,_ _**v**_ _,_ _**w**_ ∈ R [3]

⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭



_**ω**_ [∧] _**v w**_



������������������



_._



⎤⎥⎥⎥⎥⎥⎥⎥⎦



∈ R [5][×][5]



The _homogenous Galilean group_ **HG** (3) is the group
of 3D rotation and relative velocity transformations.



14


**HG** (3) is isomorphic with **SE** (3) but acts on physical
velocities rather than physical translations. The homogeneous Galilean group and its Lie algebra are defined
as follows:



⎡⎢⎢⎢⎢⎣

⎡⎢⎢⎢⎢⎣



**HG** (3) =
⎧⎪⎪⎨⎪⎪⎩



**A** _**a**_



∈ R [4][×][4] **A** ∈ **SO** (3) _,_ _**a**_ ∈ R [3] _,_
⎤⎥⎥⎥⎥⎦ ������������ ⎫⎪⎪⎬⎪⎪⎭


∈ R [4][×][4] _**ω**_ [∧] ∈ so(3) _,_ _**v**_ ∈ R [3] _,_
⎤⎥⎥⎥⎥⎦ ������������ ⎫⎪⎪⎬⎪⎪⎭



**0** 1×3 1



hg(3) =
⎧⎪⎪⎨⎪⎪⎩



_**ω**_ [∧] _**v**_



**0** 1×3 0



**B** **Linearization Error and Equivariant Filter**
**Design with Different Symmetries**


In this section, we explicitly derive the linearization error
in the error dynamics and the related filter matrices of
each filter presented in Tab. 2.


_B.1_ _Logarithm map of semi-direct product group_


As mentioned in Sec. 6, for the semi-direct product
groups **G** ⋉ g where g is the Lie algebra of **G**, we will
use a matrix realization to compute the exponential algebraically. Define _X_ = ( _C,γ_ ) ∈ **G** ⋉ g, then _X_ has a
matrix representation given by





⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦



∈ R [(][dim][ g][+][1][)×(][dim][ g][+][1][)]



_X_ =



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣





The logarithm is then given by



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣



_,_

⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦



log **G** ⋉g ( _X_ ) =







where _J_ _l_ (log **G** ( _C_ )) is the left Jacobian of log **G** ( _C_ ),



∞
_J_ _l_ (log **G** ( _C_ )) = ∑
_k_ =0



1 _k_
( _k_ + 1)! **[ad]** log [∨] **G** ( _C_ ) _._



_B.2_ _MEKF linearization error and filter design_


_B.2.1_ _Overview_


The state space is defined to be
M ∶= SO(3) × R [3] × R [3] × R [3] × R [3] with
˚ _ξξ_ ∶= ( ∶= ( **IR** 3 _,,_ **0** _**v**_ 3 _,_ × _**p**_ 1 _,,_ _**b**_ **0** _**ω**_ 3× _,_ _**b**_ 1 _,_ _a_ **0** ) ∈M 3×1 _,_ **0** . Choose the origin to be 3×1 ) ∈M. The velocity input
is given by _u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ ).



The symmetry group of MEKF is given by
**G** _X_ ˆ **O** ∶== ( **SO** _A,_ [ˆ] ( ˆ _a,_ 3) × [ˆ] _b,_ ˆ _α,_ R [12] _β_ [ˆ] ) ∈. Define **G** **O**, wherethe _A_ ˆ ∈filter **SO** (3) andstate
_a,_ ˆ [ˆ] _b,_ ˆ _α,_ _β_ [ˆ] ∈ R [3] . The state estimate is given by


_ξ_ ˆ ∶= _ϕ_ ( ˆ _X,_ ˚ _ξ_ ) = ( ˆ _A,_ ˆ _a,_ ˆ _b,_ ˆ _α,_ ˆ _β_ ) = ( ˆ **R** _,_ ˆ _**v**_ _,_ ˆ _**p**_ _,_ ˆ _**b**_ _**ω**_ _,_ ˆ _**b**_ _a_ ) _._ (B.1)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **R** _A_ [ˆ] [⊺] _,_ _**v**_ − _a,_ ˆ _**p**_ − [ˆ] _b,_ _**b**_ _ω_ − _α,_ ˆ _**b**_ _a_ − _β_ [ˆ] ) _,_

= ( **R** **R** [ˆ] [⊺] _,_ _**v**_ − _**v**_ ˆ _,_ _**p**_ − _**p**_ ˆ _,_ _**b**_ _ω_ − _**b**_ [ˆ] _ω_ _,_ _**b**_ _a_ − _**b**_ [ˆ] _a_ ) _._
(B.2)


_B.2.2_ _Error dynamics_


The error dynamics related to Equ. (B.2) for each state
is given by


˙
_e_ _R_ = [d]

d _t_ [(] **[R]** [ ˆ] **[R]** [⊺] [)]

= **R** ( _**ω**_ − _**b**_ _**ω**_ ) [∧] **R** [ˆ] [⊺] − **R** **R** [ˆ] [⊺] **R** [ˆ] ( _**ω**_ − _**b**_ [ˆ] _**ω**_ ) [∧] **R** [ˆ] [⊺]

= **R** ( _**ω**_ − _**b**_ _**ω**_ − _**ω**_ + _**b**_ [ˆ] _**ω**_ ) [∧] **R** [ˆ] [⊺]

= − _e_ _R_ **R** [ˆ] _e_ [∧] _b_ _ω_ **[R]** [ˆ] [⊺]

= − _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) ∧ ;


˙
_e_ _v_ = d [d] _t_ [(] _**[v]**_ [ −] _**[v]**_ [ˆ] [) =][ ˙] _**[v]**_ [ −] _**[v]**_ [˙ˆ]

= **R** ( _**a**_ − _**b**_ _a_ ) [∧] + _**g**_ − **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) [∧] − _**g**_

= **R** ( _**a**_ − _**b**_ _a_ ) [∧] − **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) [∧]

= _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ _a_ ) − **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ );


˙
_e_ _p_ = d [d] _t_ [(] _**[p]**_ [ −] _**[p]**_ [ˆ] [) =][ ˙] _**[p]**_ [ −] _**[p]**_ [˙ˆ]


ˆ
= _**v**_ − _**v**_ = _e_ _v_ ;


˙
_e_ _b_ = [d]

d _t_ [(] _**[b]**_ [ −] _**[b]**_ [ˆ][) =] **[ 0]** _[.]_


The local coordinate chart _ε_ = log **G** **O** - _ϕ_ ˚ [−] _ξ_ [1] [(] _[e]_ [)][ for each]
state is given by


_ε_ _R_ ∶= log **SO** (3) ( _e_ _R_ ) [∨] ∈ R [3]

_ε_ _v,p,b_ _ω_ _,b_ _a_ ∶= _e_ _v,p,b_ _ω_ _,b_ _a_ ∈ R [3] _._


The linearization of ˙ _e_ _R_ = Dexp( _ε_ [∧] _R_ [)[][ ˙] _[ε]_ [∧] _R_ []][ is given by]


I − exp(− ad _ε_ [∧] _R_ [)] ˙ ∧
_e_ _R_ ad _ε_ [∧] _R_ _ε_ [∧] _R_ [= −] _[e]_ _[R]_ [(][ ˆ] **[R]** _[ε]_ _[b]_ _ω_ [)]


∧
(I + O( _ε_ [∧] _R_ [))][ ˙] _[ε]_ [∧] _R_ [= (][ ˆ] **[R]** _[ε]_ _[b]_ _ω_ [)]

_ε_ ˙ _R_ = **R** [ˆ] _ε_ _b_ _ω_ + _O_ ( _ε_ _R_ 2 ) _._



15


The linearization of ˙ _e_ _v_ = ˙ _ε_ _v_ is given by


˙
_ε_ _v_ = _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ _a_ ) − **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ )

= (I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 )) ˆ **R** ( _**a**_ − _**b**_ _a_ ) − **R** ˆ ( _**a**_ − _**b**_ ˆ _a_ )

= **R** [ˆ] ( _**b**_ [ˆ] _a_ − _**b**_ _a_ ) + _ε_ [∧] _R_ **[R]** [ˆ] [(] _**[a]**_ [ −] _**[b]**_ _[a]_ [) +] _[ O]_ [(] _[ε]_ _[R]_ 2 )

= − **R** [ˆ] _ε_ _b_ _a_ + _ε_ [∧] _R_ **[R]** [ˆ] [(] _**[a]**_ [ −] _[ε]_ _[b]_ _a_ [−] _**[b]**_ [ˆ] _[a]_ [) + O(] _[ε]_ [2] [)]


2
= − **R** [ˆ] _ε_ _b_ _a_ + _ε_ [∧] _R_ **[R]** [ˆ] [(] _**[a]**_ [ −] _**[b]**_ [ˆ] _[a]_ [) −] _[ε]_ [∧] _R_ **[R]** [ˆ] _[ε]_ _[b]_ _a_ [+] _[ O]_ [(] _[ε]_ _[R]_ )

= −( **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ )) [∧] _ε_ _R_ − **R** [ˆ] _ε_ _b_ _a_ + O( _ε_ [2] ) _._


The linearization of ˙ _e_ _p_ = ˙ _ε_ _p_ is given by


˙
_ε_ _p_ = _ε_ _v_ _._


The linearization of ˙ _e_ _b_ = ˙ _ε_ _b_ is given by ˙ _ε_ _b_ = **0** .


_B.2.3_ _Filter design_


From the linearization error analysis, it is trivial to see
that the linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ is]
written



˚ _ξ_ and = ( **I** 5 _**b**_ _,_ **0** = ( 6× _**b**_ 1 ) ∈M _**ω**_ _,_ _**b**_ _a_ ) ∈. The velocity input is given byR [6] . Choose the origin to be
_u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ ).


The symmetry group of Imperfect-IEKF is given
by _X_ ˆ = ( **G** ˆ _C,_ **ES** ˆ _γ_ ) ∈ ∶ **SEG** **ES** 2 (3) ×with R [6] . _C_ Defineˆ = ( ˆ _A,_ ˆ _a,_ theˆ _b_ ) ∈ **SE** filter 2 (3) stateand
_γ_ ˆ = ( ˆ _γ_ _ω_ _,_ ˆ _γ_ _a_ ) ∈ R [6] . The state estimate is given by


ˆ ˚
_ξ_ ∶= _ϕ_ ( ˆ _X,_ _ξ_ ) = ( ˆ _A,_ ˆ _γ_ ) = ( ˆ **T** _,_ ˆ _**b**_ ) _._ (B.5)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **T** _C_ [ˆ] [−][1] _,_ _**b**_ − _γ_ ˆ) _,_

(B.6)
= ( **T** **T** [ˆ] [−][1] _,_ _**b**_ − _**b**_ [ˆ] ) _._


_B.3.2_ _Error dynamics_


The error dynamics related to Equ. (B.6) for each state
is given by


_e_ ˙ _R_ = − _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) [∧] (Derivation same as MEKF) ;



⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦



d _t_ [(−] **[R]** [ ˆ] **[R]** [⊺] _**[v]**_ [ˆ][ +] _**[ v]**_ [)]





∈ R [15][×][15] _,_ (B.3)



**A** [0] _t_ [=]


where



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣





˙
_e_ _v_ = [d]



˙ ˆ
= − _e_ _R_ ˆ _**v**_ − _e_ _R_ _**v**_ [˙] + ˙ _**v**_


ˆ
= _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) [∧] _**v**_ − _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) − _e_ _R_ _**g**_ + **R** ( _**a**_ − _**b**_ _a_ ) + _**g**_


ˆ
= _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) [∧] _**v**_ − _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) − _e_ _R_ _**g**_

+ _e_ _R_ **R** [ˆ] ( _**a**_ − _e_ _b_ _a_ + _**b**_ [ˆ] _a_ ) + _**g**_ ;


˙
_e_ _p_ = d [d] _t_ [(−] **[R]** [ ˆ] **[R]** [⊺] _**[p]**_ [ˆ][ +] _**[ p]**_ [)]


˙ ˆ
= − _e_ _R_ ˆ _**p**_ − _e_ _R_ _**p**_ [˙] + ˙ _**p**_


ˆ
= _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) [∧] _**p**_ − _e_ _R_ ˆ _**v**_ + _**v**_


ˆ
= _e_ _R_ ( **R** [ˆ] _e_ _b_ _ω_ ) [∧] _**p**_ + _e_ _v_ ;

˙
_e_ _b_ = **0** _._


The local coordinate chart _ε_ = log **G** **ES** - _ϕ_ ˚ [−] _ξ_ [1] [(] _[e]_ [)][ for each]
state is given by


_ε_ _T_ ∶= log **SE** 2 (3) ( _ϕ_ ˚ [−] _ξ_ [1] [(] _[e]_ _[T]_ [ ))] [∨] [=][ log] **[SE]** [2] [(][3][)] [(] _[e]_ _[T]_ [ )] [∨] [∈] [R] [9]

_ε_ _b_ _ω_ _,b_ _a_ ∶= _e_ _b_ _ω_ _,b_ _a_ ∈ R [3] _._


The linearization of ˙ _e_ _R_ is the same as the derivation in
MEKF, given by


_ε_ ˙ _R_ = **R** [ˆ] _ε_ _b_ _ω_ + _O_ ( _ε_ _R_ 2 ) _._




[d] [d]

d _t_ [(−] **[R]** [ ˆ] **[R]** [⊺] [+] _**[ v]**_ [) =] d





**0** 3×3 **0** 3×3 **0** 3×3



1 **[A]** [ =]



⎡⎢⎢⎢⎢⎢⎢⎢⎣



−( **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ )) ∧ **0** 3×3 **0** 3×3



∈ R [9][×][9] _._



**0** 3×3 **I** 3 **0** 3×3



⎤⎥⎥⎥⎥⎥⎥⎥⎦



Position measurements are linear with respect to the
defined error; therefore, the output matrix **C** [0] yields


**C** [0] **0** 3×6 **I** 3 **0** 3×6 R [3][×][15] _._ (B.4)
= [ ] ∈


It is straightforward to verify that the derived equivariant filter is equivalent to the well-known MEKF, and the
EqF state matrix in Equ. (B.3) corresponds directly to
the state matrix of the MEKF [26, Sec. 7]


_B.3_ _Imperfect-IEKF_


_B.3.1_ _Overview_


The state space is defined as M ∶= SE 2 (3) × R [6]
with _ξ_ ∶= ( **T** _,_ _**b**_ ) ∈M. One has **T** = ( **R** _,_ _**v**_ _,_ _**p**_ ) ∈SE 2 (3)



16


The linearization of ˙ _e_ _v_ = ˙ _ε_ _v_ + O( _ε_ [2] ) is given by


_ε_ ˙ _v_ = −(I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 ))( ˆ **R** _ε_ _b_ _ω_ ) ∧ _**v**_ ˆ

−(I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 )) ˆ **R** ( _**a**_ − _**b**_ ˆ _a_ )

−(I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 )) _**g**_

+ (I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 )) ˆ **R** ( _**a**_ − _ε_ _b_ _a_ + ˆ _**b**_ _a_ )

+ _**g**_ + O( _ε_ [2] )


ˆ
= − _**v**_ [∧] **R** [ˆ] _ε_ _b_ _ω_ − **R** [ˆ] _ε_ _b_ _a_ + _**g**_ [∧] _ε_ _R_ + O( _ε_ [2] ) _._


The linearization of ˙ _e_ _p_ = ˙ _ε_ _p_ + O( _ε_ [2] ) is given by


_ε_ ˙ _p_ = (I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 ))( ˆ **R** _e_ _b_ _ω_ ) ∧ _**p**_ ˆ + _ε_ _v_ + O( _ε_ 2 )


ˆ
= _ε_ _v_ − _**p**_ [∧] _ε_ _b_ _ω_ + O( _ε_ [2] ) _._


The linearization of ˙ _e_ _b_ = ˙ _ε_ _b_ is given by ˙ _ε_ _b_ = **0** .


_B.3.3_ _Filter design_


The linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ yields]



∈ R [15][×][15] _,_ (B.7)

⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦





**A** [0] _t_ [=]


where



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣







˚ _ξ_ = ( **I** 5 _,_ **0** 9×1 ) ∈M. The velocity input is given by
_u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**ν**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ _,_ _**τ**_ _ν_ ).


The symmetry group of TG-EqF is given by
_X_ **G** ˆ = ( **TG** ∶ ˆ _C,_ **SE** ˆ _γ_ ) ∈ 2 (3 **G** ) ⋉ **TG** se 2 (with3). Define _C_ ˆ = ( ˆ _A,_ ˆ _a,_ theˆ _b_ ) ∈ **SE** filter 2 (3) stateand
_γ_ ˆ = ( ˆ _γ_ _ω_ _,_ ˆ _γ_ _a_ _,_ ˆ _γ_ _ν_ ) [∧] ∈ se 2 (3). The state estimate is given by


ˆ ˚
_ξ_ ∶= _ϕ_ ( ˆ _X,_ _ξ_ ) = ( ˆ _C,_ Ad _C_ ˆ [−][1] [(−] _[γ]_ [ˆ] [∨] [)) = (][ ˆ] **[T]** _[,]_ [ ˆ] _**[b]**_ [)] _[.]_ (B.10)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **T** _C_ [ˆ] [−][1] _,_ **Ad** [∨] _C_ ˆ [(] _**[b]**_ [ +][ Ad] _C_ [ ˆ] [−][1] [ [] _[γ]_ [ˆ][]] [∨] [))][ (B.11)]

= ( **T** _C_ [ˆ] [−][1] _,_ **Ad** [∨] _C_ ˆ _**[b]**_ [ +][ ˆ] _[γ]_ [∨] [)] (B.12)

= ( **T** **T** [ˆ] [−][1] _,_ **Ad** [∨] **T** ˆ [(] _**[b]**_ [ −] _**[b]**_ [ˆ][))] (B.13)


_B.4.2_ _Error dynamics_


**Navigation states** The error dynamics related to
Equ. (B.11) for the navigation states _e_ _T_ = **T** **T** [ˆ] [−][1] is given
by


˙
_e_ _T_ = **T** [˙] **T** [ˆ] [−][1] − **T** **T** [ˆ] [−][1] [ ˙ˆ] **T** **T** [ˆ] [−][1]

= **T** ( **W** − **B** + **N** ) **T** [ˆ] [−][1] + ( **G** − **N** ) **T** **T** [ˆ] [−][1]

− _e_ _T_ **T** [ˆ] ( **W** − **B** [ˆ] + **N** ) **T** [ˆ] [−][1] − _e_ _T_ ( **G** − **N** ) **T** [ˆ] **T** [ˆ] [−][1]

= _e_ _T_ **T** [ˆ] ( **W** − **B** + **N** ) **T** [ˆ] [−][1] − _e_ _T_ **T** [ˆ] ( **W** − **B** [ˆ] + **N** ) **T** [ˆ] [−][1]

+ ( **G** − **N** ) _e_ _T_ − _e_ _T_ ( **G** − **N** )

= _e_ _T_ Ad ˆ **T** [ **B** [ˆ] − **B** ] + ( **G** − **N** ) _e_ _T_ − _e_ _T_ ( **G** − **N** ) _._


The above dynamics can be separate to two
parts: ˙ _e_ _T_ = ˙ _e_ _T_ _W_ + ˙ _e_ _T_ _G_, where ˙ _e_ _T_ _W_ = _e_ _T_ Ad ˆ **T** [ **B** [ˆ] − **B** ] and

˙
_e_ _T_ _G_ = ( **G** − **N** ) _e_ _T_ − _e_ _T_ ( **G** − **N** ). The linearization can be
derived separately for each part.


The local coordinate chart is given by _ε_ = log ○ _ϕ_ ˚ [−] _ξ_ [1] [(] _[e]_ [)][.]
For each state, one has


∧
_e_ _T_ = exp **SE** 2 (3) ( _ε_ _T_ ) _,_

_e_ _b_ = Ad _e_ _T_ −1 [(− _J_ _l_ ( _ε_ _T_ ) _ε_ _b_ ) [∧] ] _,_


where the exponential map exp **SE** 2 (3)⋉se 2 (3) is derived
from the semi-direct product structure, and _J_ _l_ ( _ε_ _T_ ) is
the left Jacobian of **SE** 2 (3), given by



∈ R [9][×][9] (B.8)

⎤⎥⎥⎥⎥⎥⎥⎥⎦



2 **[A]** [ =]



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 3×3 **0** 3×3 **0** 3×3


_**g**_ [∧] **0** 3×3 **0** 3×3


**0** 3×3 **I** 3 **0** 3×3



Position measurements formulated according to
Equ. (34) are equivariant, yielding the following output
matrix


**C** [⋆] = [ [1] 2 [(] _[y]_ [ +][ ˆ] _**[p]**_ [)] [∧] **[0]** [3][×][3] [ −] **[I]** [3] **[ 0]** [3][×][6] [] ∈] [R] [3][×][15] _[.]_ (B.9)


It is trivial to verify that the state matrix in Equ. (B.7),
derived according to equivariant filter design principles,
directly corresponds to the state matrix in the ImperfectIEKF [13, Sec. 7].


_B.4_ _TG-EqF_


_B.4.1_ _Overview_


The state space is defined as M ∶= SE 2 (3) × R [9]
with _ξ_ ∶= ( **T** _,_ _**b**_ ) ∈M. One has **T** = ( **R** _,_ _**v**_ _,_ _**p**_ ) ∈SE 2 (3)
and _**b**_ = ( _**b**_ _**ω**_ _,_ _**b**_ _a_ _,_ _**b**_ _**ν**_ ) ∈ R [9] . Choose the origin to be



∞
_J_ _l_ ( _ε_ _T_ ) = ∑
_k_ =0



1

_ε_ _T_ _[.]_
( _k_ + 1)! [ad] _[k]_



Recall that by definition Equ. (B.11) one has
_e_ [∧] _b_ [∶=][ Ad] [ ˆ] **T** [[(] _**[b]**_ [ −] _**[b]**_ [ˆ][)] [∧] []][ with] _**[ b]**_ [∧] [=] **[ B]** [, and][ ˆ] _**[b]**_ [∧] [=][ ˆ] **[B]** [. Hence,]



17


for ˙ _e_ _T_ _W_ one has


_e_ ˙ _T_ _W_ = _e_ _T_ Ad ˆ **T** [ **B** [ˆ] − **B** ] = − _e_ _T_ _e_ [∧] _b_ _[.]_


Substituting the local coordinate yields


∧ ∧ ∧
Dexp **SE** 2 (3) ( _ε_ _T_ )[ ˙ _ε_ _T_ _W_ ] = − _e_ _T_ Ad _e_ _T_ −1 [(− _J_ _l_ ( _ε_ _T_ ) _ε_ _b_ ) ]

I − exp(− ad _ε_ _T_ ∧ ) ˙ ∧ ∧
_e_ _T_ ad _ε_ _T_ ∧ _ε_ _T_ _W_ = − _e_ _T_ Ad _e_ _T_ −1 [(− _J_ _l_ ( _ε_ _T_ ) _ε_ _b_ ) ]

I − exp(− ad _ε_ _T_ ∧ ) ˙ ∧ ∧
Ad _e_ _T_ ad _ε_ _T_ ∧ _ε_ _T_ _W_ = ( _J_ _l_ ( _ε_ _T_ ) _ε_ _b_ ) _._ (B.14)


Because Ad _e_ _T_ = Ad exp( _ε_ _T_ ∧ ) = exp(ad _ε_ _T_ ∧ ), the term on
the left side in Equ. (B.14) can be modified as



_ε_ ˙ _T_ _G_ =



Note that:



I − _e_ _R_ = I − exp( _ε_ _R_ ∧ )



∞

= I −
∑
_k_ =0



1 ∧ _[k]_
_k_ ! _[ε]_ _[R]_



∞
= −( ∑
_k_ =0



1 ∧ _[k]_ ∧
) _ε_ _R_
( _k_ + 1)! _[ε]_ _[R]_



∧
= − _J_ _l_ ( _ε_ _R_ ) _ε_ _R_ _._


One can then simplify Equ. (B.17) to



**0** 3×3 _**g**_ [∧] _ε_ _R_ _ε_ _v_


**0** 1×3 0 0

**0** 1×3 0 0 ⎤⎥⎥⎥⎥⎥⎥⎥⎦



⎡⎢⎢⎢⎢⎢⎢⎢⎣



_._



p(− ad _ε_ _T_ ∧ ) = exp(ad _ε_ _T_ ∧ ) [I][ −] [ex][p][(][−] [ad] _[ε]_ _[T]_ [ ∧] [)]

ad _ε_ _T_ ∧ ad _ε_ _T_ ∧



Ad _e_ _T_ I − exp(− ad _ε_ _T_ ∧ )



ad _ε_ _T_ ∧



= [ex][p][(][ad] _[ε]_ _[T]_ [ ∧] [)][ −] [I] (Expanding exp,)

ad _ε_ _T_ ∧



∞

=
∑
_k_ =0



1
_ε_ _T_ [∧] [=] _[ J]_ _[l]_ [(] _[ε]_ _[T]_ [)] _[.]_
( _k_ + 1)! [ad] _[k]_

(B.15)



Hence, for the linearization of ˙ _e_ _T_ _W_, one has


˙
_ε_ _T_ _W_ = _ε_ _b_ _._


For the second part ˙ _e_ _T_ _G_ = Dexp **SE** 2 (3) ( _ε_ _T_ [∧] )[ ˙ _ε_ _T_ _G_ ∧ ], one
has



⎤⎥⎥⎥⎥⎥⎥⎥⎦



_e_ _T_ I − exadp( _ε_ − _T_ ad ∧ _ε_ _T_ ∧ ) _ε_ ˙ _T_ _G_ ∧ =



I − exp(− ad _ε_ _T_ ∧ )
_e_ _T_



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 3×3 _**g**_ − _e_ _R_ _**g**_ _e_ _v_


**0** 1×3 0 0


**0** 1×3 0 0



_._ (B.16)



Multiply both sides of Equ. (B.16) by _e_ _T_ [−][1] and then
apply Ad _e_ _T_ to both sides:



Combining the results for ˙ _ε_ _T_ _W_ and ˙ _ε_ _T_ _G_, one has


˙
_ε_ _T_ = ( _ε_ _b_ _ω_ _, ε_ _b_ _a_ + _**g**_ [∧] _ε_ _R_ _, ε_ _b_ _ν_ + _ε_ _v_ ) [∧] _._


**Bias states** The linearization of the bias error are derived from the formula given by


_ε_ ˙ = **A** [0] _t_ _[ε]_ [ + O(] _[ε]_ [2] [)] _[,]_

**A** [0] _t_ [=][ D] _[e]_ [∣] [˚] _ξ_ _[ϑ]_ [(] _[e]_ [)][ D] _[E]_ [∣] I _[ϕ]_ [˚] _ξ_ [(] _[E]_ [)][ D] _[e]_ [∣] [˚] _ξ_ [Λ] [(] _[e,u]_ [○] [)][ D] _[ε]_ [∣] **0** _[ϑ]_ [−][1] [ (] _[ε]_ [)] _[.]_


In this case, because we choose normal coordinates as
the local coordinate chart, that is, _ϑ_ ∶= log ○ _ϕ_ ˚ [−] _ξ_ [1] [, we have]


˙
_ε_ = D _e_ ∣ ˚ _ξ_ [Λ] [(] _[e,]_ [˚] _[u]_ [)][ D] _[E]_ [∣] I _[ϕ]_ [˚] _ξ_ [(] _[E]_ [)[] _[ε]_ [] + O(] _[ε]_ [2] [)] _[.]_


Evaluating D _ϕ_ ˚ _ξ_ [at I with direction][ [] _[ε]_ _[T]_ _[,ε]_ _[b]_ []][ yields]


D _ϕ_ ˚ _ξ_ [(][I][)[] _[ε]_ _[T]_ _[,ε]_ _[b]_ [] = (] _[ε]_ _[T]_ ∧ _,_ − _ε_ _b_ ∧ ) _._


Evaluating DΛ ˚ _u_ at [˚] _ξ_ with direction [ _ε_ _T_ [∧] _,_ − _ε_ _b_ [∧] ] yields


DΛ ˚ _u_ ( [˚] _ξ_ )[ _ε_ _T_ ∧ _,_ − _ε_ _b_ ∧ ] = (∼ _,_ ad − _ε_ _b_ ∧ [Λ 1 (˚ _ξ,_ ˚ _u_ )])

= (∼ _,_ **ad** [∨] ( _**w**_ ˚ [∧] + **G** ) _[ε]_ _[b]_ [)] _[.]_


Hence the linearization of bias error is given by


˙
_ε_ _b_ = **ad** [∨] ( _**w**_ ˚ [∧] + **G** ) _[ε]_ _[b]_ [+ O(] _[ε]_ [2] [)] _[.]_


_B.4.3_ _Filter design_


The linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ is de-]
fined according to



I − exp(− ad _ε_ _T_ ) ˙ −1
Ad _e_ _T_ ad _ε_ _T_ _ε_ _T_ _G_ = Ad _e_ _T_ _e_ _T_



**0** 3×3 _**g**_ − _e_ _R_ _**g**_ _e_ _v_


**0** 1×3 0 0

⎡⎢⎢⎢⎢⎢⎢⎢⎣ **0** 1×3 0 0



⎤⎥⎥⎥⎥⎥⎥⎥⎦



=



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 3×3 _**g**_ − _e_ _R_ _**g**_ _e_ _v_


**0** 1×3 0 0


**0** 1×3 0 0



_._



Use the result from Equ. (B.15):



⎤⎥⎥⎥⎥⎥⎥⎥⎦



_J_ _l_ ( _ε_ _T_ ) ˙ _ε_ _T_ _G_ =



⎡⎢⎢⎢⎢⎢⎢⎢⎣



**0** 3×3 (I − _e_ _R_ ) _**g**_ _J_ _l_ ( _ε_ _R_ ) _ε_ _v_


**0** 1×3 0 0


**0** 1×3 0 0



_._ (B.17)



⎤⎥⎥⎥⎥⎥⎥⎥⎦


18


⎤⎥⎥⎥⎥⎥⎦



**A** [0] _t_ [=]



⎡⎢⎢⎢⎢⎢⎣



∈ R [18][×][18] _,_ (B.18)



and the corresponding bias states, the derivation of the
error dynamics of the HG(3) part is similar to the one
in TG-EqF. In this case, one has


_ε_ ˙ _R_ = _ε_ _b_ _ω_ _,_

˙
_ε_ _v_ = _ε_ _b_ _a_ + _**g**_ [∧] _ε_ _R_ _._


For the position error, one has


_ε_ ˙ _p_ = ˙ _e_ _p_ = ˙ _**p**_ − _**p**_ ˆ [˙] = **R** _**ν**_ + _**v**_ − **R** [ˆ] _**ν**_ − _**v**_ ˆ


ˆ
= _e_ _v_ + _e_ _R_ ˆ _**v**_ − _**v**_ + _e_ _R_ **R** [ˆ] _**ν**_ − **R** [ˆ] _**ν**_

= _J_ _l_ ( _ε_ _R_ ) _ε_ _v_ + (I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 ))( ˆ **R** _**ν**_ + ˆ _**v**_ ) −( ˆ **R** _**ν**_ + ˆ _**v**_ )

= _J_ _l_ ( _ε_ _R_ ) _ε_ _v_ + (I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ _[R]_ 2 ))˚ _**ν**_ − ˚ _**ν**_


˚
= _ε_ _v_ − _**ν**_ [∧] _ε_ _R_ + O( _ε_ [2] ) _._


**Bias states** The derivation of bias error dynamics is
the same as TG-EqF:


˙
_ε_ _b_ = **ad** [∨] ( _**w**_ ˚ [∧] + **G** ) _[ε]_ _[b]_ [+ O(] _[ε]_ [2] [)] _[.]_


_B.5.3_ _Filter design_


The linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ is de-]
fined according to



with 2 **A** in Equ. (B.8).


Position measurements formulated according to
Equ. (34) are equivariant, yielding the following output
matrix


**C** [⋆] = [ 2 [1] [(] _[y]_ [ +][ ˆ] _**[p]**_ [)] [∧] **[0]** [3][×][3] [ −] **[I]** [3] **[ 0]** [3][×][9] [] ∈] [R] [3][×][18] _[.]_ (B.19)


Moreover, an additional constraint can be imposed on
the virtual bias _**b**_ _ν_ ; that is, an additional measurement in
the form of _h_ ( _ξ_ ) = _**b**_ _ν_ = **0** ∈ R [3] can be considered, leading
to the following output matrix


**C** [0] = [ **0** 3×3 **0** 3×3 **0** 3×3 − **R** [ˆ] [⊺] **0** 3×3 **R** [ˆ] [⊺] _**p**_ ˆ [∧] ] ∈ R [3][×][18] _._
(B.20)


Note that for a practical implementation of the presented
EqF the virtual inputs _**ν**_ is set to zero.


It is worth noticing that the EqF built on the **G** **TG**
symmetry group is the only filter with exact linearization
of the navigation error dynamics.


_B.5_ _DP-EqF_


_B.5.1_ _Overview_


The state space is defined as M ∶= HG(3) × R [3] × R [6]
with _ξ_ ∶= ( **T** _,_ _**p**_ _,_ _**b**_ ) ∈M. One has **T** = ( **R** _,_ _**v**_ ) ∈HG(3)
˚and _ξ_ = ( **I** 4 _**b**_ _,_ **0** = ( 6× _**b**_ 1 _,_ _**ω**_ **0** _,_ _**b**_ 3× _a_ 1 ) ∈) ∈MR [6] .. The velocity input is given byChoose the origin to be
_u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ _,_ _**ν**_ ).


The symmetry group of DP-EqF is given by
_X_ **G** ˆˆ = ( **DP** ∶ ˆ _B,_ **HG** ˆ _β,_ ˆ _c_ () ∈3) ⋉ **G** hg **DP** (3) ×with R [3] . _B_ Defineˆ = ( ˆ _A,_ ˆ _a_ the) ∈ **HG** filter(3) stateand
_β_ = ( ˆ _β_ _ω_ _,_ _β_ [ˆ] _a_ ) [∧] ∈ hg(3). The state estimate is given by


ˆ ˚
_ξ_ ∶= _ϕ_ ( ˆ _X,_ _ξ_ ) = ( ˆ _B,_ Ad _B_ ˆ [−][1] [(−] _[β]_ [ˆ][)] _[,]_ [ ˆ] _[c]_ [) = (][ ˆ] **[T]** _[,]_ [ ˆ] _**[b]**_ _[,]_ [ ˆ] _**[p]**_ [)] _[.]_ (B.21)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **T** _B_ [ˆ] [−][1] _,_ **Ad** [∨] _B_ ˆ _**[b]**_ [ +][ ˆ] _[β]_ [∨] _[,]_ _**[ p]**_ [ −] _[c]_ [ˆ][)] (B.22)

= ( **T** **T** [ˆ] [−][1] _,_ **Ad** [∨] **T** ˆ [(] _**[b]**_ [ −] _**[b]**_ [ˆ][)] _[,]_ _**[ p]**_ [ −] _**[p]**_ [ˆ] [)] (B.23)


_B.5.2_ _Error dynamics_


**Navigation states** Because of the semi-direct product structure related to the rotation and velocity states



⎤⎥⎥⎥⎥⎥⎥⎥⎦



**A** [0] _t_ [=]


where



3 **[A]** **I** 6 **0** 6×3

**0** 6×6 **ad** [∨] ( _**w**_ ˚ [∧] + **G** ) [∨] **[0]** [6][×][3]

⎡⎢⎢⎢⎢⎢⎢⎢⎣ 4 **[A]** **0** 3×6 **0** 3×3



∈ R [15][×][15] _,_ (B.24)



3 **[A]** [ =]
⎡⎢⎢⎢⎢⎣



**0** 3×3 **0** 3×3


_**g**_ [∧] **0** 3×3



∈ R [6][×][6]
⎤⎥⎥⎥⎥⎦



4 **[A]** [ = [−][˚] _**[ν]**_ [ ∧] **[I]** 3 [] ∈] [R] [3][×][6] _[.]_


Position measurements are linear; therefore, the output
matrix is written


**C** [0] **0** 3×3 **0** 3×3 **0** 3×6 **I** 3 R [3][×][15] _._ (B.25)
= [ ] ∈


Similar to the previous filter, for a practical implementation of the presented EqF, the virtual input _**ν**_ is set
to zero.



19


_B.6_ _SD-EqF_


_B.6.1_ _Overview_


The state space is defined as M ∶= SE 2 (3) × R [6]
with _ξ_ ∶= ( **T** _,_ _**b**_ ) ∈M. One has **T** = ( **R** _,_ _**v**_ _,_ _**p**_ ) ∈SE 2 (3)
˚and _ξ_ = ( **I** 5 _**b**_ _,_ **0** = ( 6× _**b**_ 1 ) ∈M _**ω**_ _,_ _**b**_ _a_ ) ∈. The velocity input is given byR [6] . Choose the origin to be
_u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ ).


The symmetry group of SD-EqF is given by
**G** _X_ ˆ = ( **SD** ∶ ˆ _C,_ **SE** ˆ _γ_ ) ∈ 2 (3 **G** ) ⋉ **SD** se(3with). Define _C_ ˆ = ( ˆ _A,_ ˆ _a,_ theˆ _b_ ) ∈ **SE** filter 2 (3) stateand
_γ_ ˆˆ = ( ˆ _γ_ _ω_ _,_ ˆ _γ_ _a_ ) [∧] ∈ se(3). The **SE** 2 (ˆ3) component in
_BX_ ˆ = (can also be expressed in ˆ _A,_ ˆ _a_ ) ∈ **HG** (3). The state estimate is given by _C_ = ( _B,_ [ˆ] [ˆ] _b_ ) where


ˆ ˚
_ξ_ ∶= _ϕ_ ( ˆ _X,_ _ξ_ ) = ( ˆ _C,_ Ad _B_ ˆ [−][1] [(−] _[γ]_ [ˆ] [∨] [)) = (][ ˆ] **[T]** _[,]_ [ ˆ] _**[b]**_ [)] _[.]_ (B.26)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **T** _C_ [ˆ] [−][1] _,_ **Ad** [∨] _B_ ˆ [(] _**[b]**_ [ +][ Ad] _B_ [ ˆ] [−][1] [ [] _[γ]_ [ˆ][]] [∨] [))][ (B.27)]

= ( **T** _C_ [ˆ] [−][1] _,_ **Ad** [∨] _B_ ˆ _**[b]**_ [ +][ ˆ] _[γ]_ [∨] [)] _[.]_ (B.28)


_B.6.2_ _Error dynamics_


**Navigation states** Because of the semi-direct product structure related to the rotation and velocity states
and the corresponding bias states, the derivation of the
error dynamics of the **HG** (3) part is similar to the one
in TG-EqF. In this case, one has


_ε_ ˙ _R_ = _ε_ _b_ _ω_ _,_

˙
_ε_ _v_ = _ε_ _b_ _a_ + _**g**_ [∧] _ε_ _R_ _._


For the position error ˙ _e_ _p_ = ˙ _ε_ _p_ + O( _ε_ [2] ), one has


˙
_e_ _p_ = d [d] _t_ [(−] **[R]** [ ˆ] **[R]** [⊺] _**[p]**_ [ˆ][ +] _**[ p]**_ [)]


˙ ˆ
= − _e_ _R_ ˆ _**p**_ − _e_ _R_ _**p**_ [˙] + ˙ _**p**_
= _e_ _R_ _e_ [∧] _b_ _ω_ _**[p]**_ [ˆ][ −] _[e]_ _[R]_ _**[v]**_ [ˆ][ +] _**[ v]**_

_ε_ ˙ _p_ = ((I + _ε_ [∧] _R_ [+] _[ O]_ [(] _[ε]_ [2] [)))(] _[ε]_ [∧] _b_ _ω_ [+ O(] _[ε]_ [2] [))][ ˆ] _**[p]**_ [ + (] _[ε]_ _[v]_ [+ O(] _[ε]_ [2] [))]

= _ε_ _v_ + ˆ _**p**_ [∧] _ε_ _b_ _ω_ + O( _ε_ [2] ) _._


**Bias states** The derivation of bias error dynamics is
the same as TG-EqF, and yields:


_ε_ ˙ _b_ = **ad** [∨]
**Ad** [∨] ˆ
( _B_ _**[w]**_ [+] _[γ]_ [ˆ] [∨] [+] **[G]** [∨] [)] _[ε]_ _[b]_ [ + O(] _[ε]_ [2] [)] _[.]_


Note that the following relation holds


∨
**Ad** [∨] _B_ ˆ _**[w]**_ [ +][ ˆ] _[γ]_ [∨] [=][ Π] [(] _**w**_ [˚] [∧] ) _,_



_B.6.3_ _Filter dseign_


The linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ is de-]
fined according to









**A** [0] _t_ [=]



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣



∈ R [15][×][15] _,_ (B.29)



⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦



When comparing **A** [0] _t_ [in Equ. (B.29) with the one in]
Equ. (B.18), it is trivial to see the only difference between the two matrices is in the row of **A** [0] _t_ [relative to]
the position error. This is where the major difference between filters employing the symmetries **G** **TG**, and **G** **SD**
is found.


Position measurements formulated according to
Equ. (34) are equivariant, yielding the following output
matrix


**C** [⋆] = [ [1] 2 [(] _[y]_ [ +][ ˆ] _**[p]**_ [)] [∧] **[0]** [3][×][3] [ −] **[I]** [3] **[ 0]** [3][×][6] [] ∈] [R] [3][×][15] _[.]_ (B.30)


_B.7_ _TFG-IEKF_


_B.7.1_ _Overview_


The state space is defined as M ∶= SE 2 (3) × R [6]
with _ξ_ ∶= ( **T** _,_ _**b**_ ) ∈M. One has **T** = ( **R** _,_ _**v**_ _,_ _**p**_ ) ∈SE 2 (3)
˚ _ξ_ and = ( **I** 5 _**b**_ _,_ **0** = ( 6× _**b**_ 1 ) ∈M _**ω**_ _,_ _**b**_ _a_ ) ∈. The velocity input is given byR [6] . Choose the origin to be
_u_ ∶= ( _**ω**_ _,_ _**a**_ _,_ _**τ**_ _**ω**_ _,_ _**τ**_ _a_ ).


The symmetry group of TFG-IEKF is
given _C_ fineˆ = ( ˆ _A,_ the( _a,_ ˆ ˆ _b_ by)) ∈filter **SE** 2 **G** (3state **TF** ) = ∶ **SOSO** (( _X_ ˆ33 = () ⋉) ⋉(R ˆ _C,_ R [6] ˆ [6] _γ_ ⊕) ∈R **G** [6] ) **TF** . withandDe_γ_ ˆ = ( ˆ _γ_ _ω_ _,_ ˆ _γ_ _a_ ) ∈ R [6] . The state estimate is given by


_ξ_ ˆ ∶= _ϕ_ ( ˆ _X,_ ˚ _ξ_ ) = ( ˆ _C,_ ˆ _A_ [−][1] ∗(− _γ_ ˆ)) = ( ˆ **T** _,_ ˆ _**b**_ ) _._ (B.31)


The state error is defined as


_e_ ∶= _ϕ_ ( _X_ [ˆ] [−][1] _,ξ_ ) = ( **T** _C_ [ˆ] [−][1] _,_ _A_ [ˆ] ∗( _**b**_ + _A_ [ˆ] [−][1] ∗ _γ_ ˆ)) (B.32)

= ( **T** **T** [ˆ] [−][1] _,_ **R** [ˆ] ∗( _**b**_ − _**b**_ [ˆ] )) _._ (B.33)


_B.7.2_ _Error dynamics_


**Navigation states** Because of the semi-direct product structure related to the rotation state, the error dynamics of the rotation part is similar to the TG-EqF,



20


but with different signs due to the use of log-coordinates
_ε_ = log **G** :


˙
_ε_ _R_ = − _ε_ _b_ _ω_ _._


For the velocity error _e_ _v_ = − **R** **R** [ˆ] [⊺] _**v**_ ˆ + _**v**_, one has


˙ ˙ ˆ
_e_ _v_ = − _e_ _R_ ˆ _**v**_ − _e_ _R_ _**v**_ [˙] + ˙ _v_


ˆ
= _e_ _R_ ( _e_ _b_ _ω_ ) [∧] _**v**_ − _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) − _e_ _R_ _**g**_ + **R** ( _**a**_ − _**b**_ _a_ ) + _**g**_


ˆ
= _e_ _R_ ( _e_ _b_ _ω_ ) [∧] _**v**_ − _e_ _R_ **R** [ˆ] ( _**a**_ − _**b**_ [ˆ] _a_ ) −( _e_ _R_ − I) _**g**_

+ _e_ _R_ **R** [ˆ] ( _**a**_ − **R** [ˆ] [⊺] ( _e_ _b_ _a_ − _γ_ _b_ _a_ ))
= _e_ _R_ _e_ [∧] _b_ _ω_ _**[v]**_ [ˆ][ −] _[e]_ _[R]_ _[e]_ _[b]_ _a_ [−(] _[e]_ _[R]_ [−] [I][)] _**[ g]**_ [;]


˙ ˆ
_ε_ _v_ = − _**v**_ [∧] _ε_ _b_ _ω_ + _**g**_ [∧] _ε_ _R_ − _ε_ _b_ _a_ + O( _ε_ [2] ) _._


The derivation for position error _e_ _p_ = − **R** **R** [ˆ] [⊺] _**p**_ ˆ + _**p**_ is
similar to the SD-EqF, and it is given by


˙ ˆ
_ε_ _p_ = _ε_ _v_ − _**p**_ [∧] _ε_ _b_ _ω_ + O( _ε_ [2] ) _._


**Bias statesR** ˆ ∗( _**b**_ _**ω**_ − _**b**_ ˆ _**ω**_ ). The dynamics can be derived:The error in bias state _b_ _ω_ is given by _e_ _b_ _ω_ =


_e_ ˙ _b_ _ω_ = **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _**ω**_ ) [∧] ∗( _**b**_ _**ω**_ − _**b**_ [ˆ] _**ω**_ )

= **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _**ω**_ ) [∧] **R** [ˆ] [⊺] **R** [ˆ] ∗( _**b**_ _**ω**_ − _**b**_ [ˆ] _**ω**_ )

= ( **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _**ω**_ )) [∧] _e_ _b_ _ω_ _._


In local coordinates, the linearization is given by


_ε_ ˙ _b_ _ω_ = ( **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _**ω**_ )) [∧] _ε_ _b_ _ω_ + O( _ε_ [2] ) _._


The error in _b_ _a_ follows the same derivation, which is
given by


_ε_ ˙ _b_ _a_ = ( **R** [ˆ] ( _ω_ − _**b**_ [ˆ] _**ω**_ )) [∧] _ε_ _b_ _a_ + O( _ε_ [2] ) _._


_B.7.3_ _Filter design_


The linearized error state matrix **A** [0] _t_ [∣] _**[ε]**_ [˙] [ ≃] **[A]** [0] _t_ _**[ε]**_ [ is de-]
fined according to



∈ R [15][×][15] _._


(B.34)


21



⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦





Position measurements formulated according to
Equ. (34) are equivariant, yielding the following output
matrix


**C** [⋆] = [ [1] 2 [(] _[y]_ [ +][ ˆ] _**[p]**_ [)] [∧] **[0]** [3][×][3] [ −] **[I]** [3] **[ 0]** [3][×][6] [] ∈] [R] [3][×][15] _[.]_ (B.35)


**References**


[1] A Barrau and S Bonnabel. The Invariant Extended
Kalman Filter as a Stable Observer. _IEEE Transac-_
_tions on Automatic Control_, 62(4):1797–1812, 2017.

[2] Axel Barrau and Axel Barrau. _Non-linear state er-_
_ror based extended Kalman filters with applications_
_to navigation_ . PhD thesis, Mines Paristech, 9 2015.

[3] Axel Barrau and Silvere Bonnabel. A Mathematical Framework for IMU Error Propagation with
Applications to Preintegration. _Proceedings - IEEE_
_International Conference on Robotics and Automa-_
_tion_, pages 5732–5738, 5 2020.

[4] Axel Barrau and Silvere Bonnabel. The Geometry of Navigation Problems. _IEEE Transactions on_
_Automatic Control_, 68(2):689–704, 2022.

[5] Christian Brommer, Alessandro Fornasier, Martin
Scheiber, Jeff Delaune, Roland Brockers, Jan Steinbrener, and Stephan Weiss. The INSANE dataset:
Large number of sensors for challenging UAV flights
in Mars analog, outdoor, and out-/indoor transition scenarios. _International Journal of Robotics_
_Research_, 2 2024.

[6] Martin Brossard, Axel Barrau, Paul Chauchat, and
Silvere Bonnabel. Associating Uncertainty to Extended Poses for on Lie Group IMU Preintegration With Rotating Earth. _IEEE Transactions on_
_Robotics_, 38(2):998–1015, 2021.

[7] Michael Burri, Janosch Nikolic, Pascal Gohl,
Thomas Schneider, Joern Rehder, Sammy
Omari, Markus W. Achtelik, and Roland Siegwart. The EuRoC micro aerial vehicle datasets.
_https://doi.org/10.1177/0278364915620033_,
35(10):1157–1163, 1 2016.

[8] Gregory S Chirikjian. _Stochastic models, infor-_
_mation theory, and Lie groups, volume 2: Ana-_
_lytic methods and modern applications_, volume 2.
Springer Science & Business Media, 2011.

[9] Alessandro Fornasier, Pieter van Goor, Eren Allak, Robert Mahony, and Stephan Weiss. MSCEqF:
A Multi State Constraint Equivariant Filter for
Vision-aided Inertial Navigation. _IEEE Robotics_
_and Automation Letters_, 1 2023.

[10] Alessandro Fornasier, Yonhon Ng, Christian Brommer, Christoph Bohm, Robert Mahony, and
Stephan Weiss. Overcoming Bias: Equivariant Filter Design for Biased Attitude Estimation With Online Calibration. _IEEE Robotics and Automation_
_Letters_, 7(4):12118–12125, 10 2022.

[11] Alessandro Fornasier, Yonhon Ng, Robert Mahony,
and Stephan Weiss. Equivariant Filter Design



**A** [0] _t_ [=]



⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣




for Inertial Navigation Systems with Input Measurement Biases. _2022 International Conference_
_on Robotics and Automation (ICRA)_, pages 4333–
4339, 5 2022.

[12] Yixiao Ge, Pieter Van Goor, and Robert Mahony.
A Geometric Perspective on Fusing Gaussian Distributions on Lie Groups. _IEEE Control Systems_
_Letters_, 8:844–849, 2024.

[13] Ross Hartley, Maani Ghaffari, Ryan M Eustice,
and Jessy W Grizzle. Contact-aided invariant extended Kalman filtering for robot state estimation.
_The International Journal of Robotics Research_,
39(4):402–430, 2020.

[14] Simon J. Julier and Joseph J. LaViolar. On Kalman
filtering with nonlinear equality constraints. _IEEE_
_Transactions on Signal Processing_, 55(6 II):2774–
2784, 6 2007.

[15] E. J. Lefferts, F. L. Markley, and M. D. Shuster.
Kalman Filtering for Spacecraft Attitude Estimation. _https://doi.org/10.2514/3.56190_, 5(5):417–
429, 5 1982.

[16] X. Rong Li, Zhanlue Zhao, and Xiao Bai Li. Evaluation of Estimation Algorithms: Credibility Tests.
_IEEE Transactions on Systems, Man, and Cyber-_
_netics Part A: Systems and Humans_, 42(1):147–163,
2012.

[17] Xinghan Li, Haodong Jiang, Xingyu Chen,
He Kong, and Junfeng Wu. Closed-Form Error
Propagation on SE-n (3) Group for Invariant EKF
With Applications to VINS. _IEEE Robotics and_
_Automation Letters_, 7(4):10705–10712, 10 2022.

[18] Robert Mahony, Tarek Hamel, and Jochen Trumpf.
Equivariant Systems Theory and Observer Design.
_arXiv preprint arXiv:2006.08276_, 6 2020.

[19] Robert Mahony, Jochen Trumpf, and Tarek Hamel.
Observers for kinematic systems with symmetry?
_IFAC Proceedings Volumes (IFAC-PapersOnline)_,
9(PART 1):617–633, 2013.

[20] Robert Mahony, Pieter Van Goor, and
Tarek Hamel. Observer Design for
Nonlinear Systems with Equivariance.
_https://doi.org/10.1146/annurev-control-061520-_
_010324_, 5:221–252, 5 2022.

[21] Yonhon Ng, Pieter Van Goor, Tarek Hamel, and
Robert Mahony. Equivariant Systems Theory and
Observer Design for Second Order Kinematic Systems on Matrix Lie Groups. _Proceedings of the_
_IEEE Conference on Decision and Control_, 2020Decem(Xx):4194–4199, 2020.

[22] Yonhon Ng, Pieter van Goor, and Robert Mahony.
Pose Observation for Second Order Pose Kinematics. _IFAC-PapersOnLine_, 53(2):2317–2323, 1 2020.

[23] Yonhon Ng, Pieter Van Goor, Robert Mahony, and
Tarek Hamel. Attitude Observation for Second Order Attitude Kinematics. In _Proceedings of the_
_IEEE Conference on Decision and Control_, volume
2019-Decem, pages 2536–2542. IEEE, 2019.

[24] Natalia Pavlasek, Alex Walsh, and James Richard
Forbes. Invariant Extended Kalman Filtering Us


ing Two Position Receivers for Extended Pose Estimation. In _2021 IEEE International Conference_
_on Robotics and Automation (ICRA)_, pages 5582–
5588. Institute of Electrical and Electronics Engineers (IEEE), 10 2021.

[25] Martin Scheiber, Alessandro Fornasier, Christian
Brommer, and Stephan Weiss. Revisiting MultiGNSS Navigation for UAVs – An Equivariant Filtering Approach. In _2023 21st International Con-_
_ference on Advanced Robotics (ICAR)_, pages 134–
141. IEEE, 12 2023.

[26] Joan Solà. Quaternion kinematics for the
error-state Kalman filter. _arXiv_ _preprint_
_arXiv:1711.02508_, 11 2017.

[27] Pieter Van Goor. _Equivariant Filters for Visual_
_Spatial Awareness_ . PhD thesis, Australian National
University (ANU), 2023.

[28] Pieter Van Goor, Tarek Hamel, and Robert Mahony. Equivariant Filter (EqF): A General Filter
Design for Systems on Homogeneous Spaces. _Pro-_
_ceedings of the IEEE Conference on Decision and_
_Control_, 2020-Decem(Cdc):5401–5408, 2020.

[29] Pieter van Goor, Tarek Hamel, and Robert Mahony.
Equivariant Filter (EqF). _IEEE Transactions on_
_Automatic Control_, 68(6):3501 – 3512, 6 2022.



22


