## INS/Odometer Land Navigation by Accurate Measurement Modeling and Multiple-Model Adaptive Estimation

Wei Ouyang, Yuanxin Wu, _Senior Member_, _IEEE,_ and Hongyue Chen



_**Abstract**_ **—Land vehicle navigation based on inertial navigation**
**system (INS) and odometers is a classical autonomous navigation**
**application and has been extensively studied over the past several**
**decades. In this work, we seriously analyze the error**
**characteristics of the odometer (OD) pulses and investigate three**
**types of odometer measurement models in the INS/OD integrated**
**system. Specifically, in the pulse velocity model, a preliminary**
**Kalman filter is designed to obtain accurate vehicle velocity from**
**the accumulated pulses; the pulse increment model is accordingly**
**obtained by integrating the pulse velocity; a new pulse**
**accumulation model is proposed by augmenting the travelled**
**distance into the system state. The three types of measurements,**
**along with the nonhonolomic constraint (NHC), are implemented**
**in the standard extended Kalman filter. In view of the motion-**
**related pulse error characteristics, the multiple model adaptive**
**estimation (MMAE) approach is exploited to further enhance the**
**performance. Simulations and long-distance experiments are**
**conducted to verify the feasibility and effectiveness of the proposed**
**methods. It is shown that the standard pulse velocity measurement**
**achieves the superior performance, whereas the accumulated**
**pulse measurement is most favorable with the MMAE**
**enhancement.**


_**Index Terms**_ **—Land vehicle navigation, Odometer, Kalman**
**filtering, Pulse measurement, Multiple model adaptive estimation**


I. I NTRODUCTION
# T works independently or complementarily with other H E strapdown inertial navigation system (INS) either

sensors, e.g., the global positioning system (GPS) in case of
possible signal loss and interference [1]-[13]. Under special
scenarios, such as the military applications [3], the underground
mining [4], and the pipeline surveying [7], the GPS signal might
be not available. To fulfill autonomous navigation in GPSdenied situations, the inertial measurement units (IMU) are
commonly integrated with wheel encoders/odometers (OD) to
mitigate the land vehicle’s navigation error drift caused by
sensor biases, scale factor errors, and random walks [8], [9].
Specifically, high-precision IMUs are indispensable in order to
ensure the long-distance and long-time stability of the
navigation performance [13].


The paper was supported in part by National Key R&D Program of China
(2018YFB1305103) and National Natural Science Foundation of China
(61673263). A short version was presented at International Conference on
Integrated Navigation Systems, Saint Petersburg, Russia, 2020.

W. Ouyang and Y. Wu are with Shanghai Key Laboratory of Navigation and
Location-based Services, School of Electronic Information and Electrical
Engineering, Shanghai Jiao Tong University, Shanghai 200240, China (email:



The INS/OD integrated system has been exhaustively
investigated for decades as a typical enhancement of the
strapdown inertial navigation system (SINS). Table I gives a
summary of the relevant papers on the INS/OD integrated
system in the last two decades. Odometers are ubiquitous in
land vehicles and very convenient to be used as external
measurements, but only a few studies have seriously studied the
measurement model. In [1], the authors proposed to use the
odometer velocity together with the vehicle motion constraints
as the measurement information. However, the raw outputs of
odometers are pulses that are proportional to the travelled
distance and the indirectly-derived velocity outputs from the
odometer pulses by approximate difference are severely
corrupted by noise. To overcome this problem, the distance
increments travelled over a small time period are frequently
taken as measurements, which are formulated as the time
integration of the velocity [8], [10]. Although the distance
increment measurements are helpful to smooth out errors, more
rigorous error modeling is desired to further improve the
estimation accuracy. Besides, the laser doppler velocimeter
(LDV), a more accurate and stable velocity sensor, has been
used in lieu of the odometer for direct velocity measurement [8],

[11]. Unfortunately, the LDV is vulnerable to dusty/muddy and
watering roads [12]. Our team initially exploited the filtered
pulse velocity as measurements [13], whereas the technical
details were not disclosed and the achieved performance was
unsatisfactory to us.

Researchers have also delved into studying various adaptive
filtering methods to improve the INS/OD navigation
performance. Leopoldo _et al_ . [14] proposed an adaptive
filtering technique based on the innovation sequence to account
for inaccurate process and measurement covariance matrices in
the localization of mobile robots. The algorithms in [15], [16],
and [17] also fall into this type of the adaptive covariance
matrix methods. The strong tracking Kalman filter (STF) [18]
was used to keep track of the variation of the odometer scale
factor error in [19] and [20]. The ‘strong tracking’ of parameters
was realized by introducing a scaling matrix/factor into the
covariance prediction process of EKF. Nevertheless, STF is


ywoulife@sjtu.edu.cn, yuanx_wu@hotmail.com); H. Chen is with Beijing
Institute of space launch technology, Beijing 100076, China (email:
cfplyzdy@163.com ).


2


TABLE I

P REVIOUS R ELATED R ESEARCHES

**Year** **Author** **Technical Merits** **Measurement Type***


1996 Borenstein _et al_ . [24] Measurement and correction of odometry errors. DI

2001 Dissanayake _et al_ . [1] Odometer velocity and NHC measurements. OV


2009 Wu _et al_ . [30] Self-calibration and observability analysis. PV

2010 Wu _et al_ . [31] Calibration of misalignment angles. PV

2012 Wang _et al_ . [10] Comparison of loosely and tightly coupled mode. DI

2014 Wu [13] Self-calibration, in-motion alignment and positioning. PV

2016 Zhao _et al_ . [19] Adaptive two-stage Kalman filter. OV


2017 Gao _et al_ . [12] Accurate calibration method for Laser Doppler Velocimeter. OV

2017 Chang _et al_ . [2] Attitude estimation-based in-motion initial alignment. OV

2017 Hidalgo-Carrió _et al_ . [23] Gaussian process estimation of odometry error. OV

2018 Fu _et al_ . [8] Laser Doppler Velocimeter and observability analysis. SOV

2018 Gao _et al_ . [3] Single-Axis Rotational INS/OD integrated navigation system. OV

2019 Brossard _et al_ . [22] Learning wheel odometry and IMU errors. OV


2019 Chen _et al_ . [7] Pipeline Surveying System and experiment tests. OV


2019 Wang _et al_ . [6] Precise positioning of shearer based on closing path. DI


2019 Wang _et al_ . [9] State transformation method and SINS/OD integration. OV


  - DI: Distance increment measurement is the output of the odometer. OV: Odometer velocity is computed by differencing the distance increment w.r.t. the
sampling interval. PV: Pulse-derived velocity by using the Kalman filter. SOV: Summed odometer velocity.



only sensitive to significant change of model parameters, which
is inappropriate for the INS/OD system that comprises
minutely-changing parameters such as the odometer scale
factor. As pointed out in [21], STF fails to detect the maneuver
when the magnitude of the impulsive maneuver is small.
Recently, deep learning techniques and Gaussian processes
have also been applied to learn the inertial sensor error statistics
or to predict the measurement residuals of the wheel odometry

[22], [23]. In general, the biases of high-precision gyroscopes
and accelerometers, and the odometer scale factor can be
regarded as noised constants. However, the error characteristics
of the odometer measurements are unknown and largely
unstable [24], predictably related to vehicle motions. In this
regard, the multiple model adaptive estimation technique
(MMAE) [26], [25] is potentially promising to address this
problem by running a bank of filters that respectively take
different statistical parameters of the measurement error. The
MMAE approach has been successfully applied to deal with
maneuvering target tracking [27], fault detection [28] and Mars
entry navigation [29], etc, in which varying parameters were
involved.


Given the aforementioned problems, this article starts by
analyzing the error characteristics of the odometer pulses and
then three kinds of odometer measurement models are

investigated. The travelled distance up to the odometer scale
factor is augmented into the system state so that the
accumulated pulses can be used as measurements. Furthermore,
similar to the traditional distance increment method [8], [10], a
counterpart is developed using the incremental pulses as
measurements. The third measurement model is developed
based on the pulse-derived velocity, for which a preliminary
Kalman filter is formulated by assuming a constant acceleration
of the vehicle forward motion in a short time interval [30], [31].
Finally, the multiple model adaptive estimation (MMAE)
approach is applied to further ameliorate the performances of
these methods, by exploiting the analyzed pulse error



characteristics in the MMAE design process. Simulations and
long-distance land vehicle experiments are conducted to
validate the effectiveness of the proposed methods. Comparing
with previous works, the main contributions of this article
include:


1) The error characteristics of odometer pulse measurements

are studied, which are conducive to the Kalman filter and
the MMAE model design.
2) A new system scheme is proposed by augmenting the

traditional state model with the travelled distance. In doing
so, the accumulated odometer pulses could be directly used
as the measurement.

3) A linear time-invariant system is used to model the pulse

change over short intervals and a preliminary Kalman filter
is exploited to acquire accurate velocity information. The
pulse-derived velocity is shown to be quite effective in
improving the navigation performance.
4) Multiple model adaptive estimation algorithms are used to

even further improve the performance by accounting for the
motion-dependent error characteristics of the odometer
pulses.


The remaining content is organized as follows. Section II
gives some preliminaries and backgrounds of INS/OD
integrated navigation. Section III develops three types of
measurement models and the corresponding error
characteristics are investigated. Subsequently, the MMAE
method is introduced in Section IV. Simulations are conducted

in Section V and the results of land vehicle experiments are
given in Section VI. Finally, Section VII concludes this article.


II. P RELIMINARIES AND BACKGROUND


This section provides an overview of the INS/OD integrated
navigation system. The land vehicle is equipped with a
navigation-grade IMU, and the odometer is mounted on the


non-steering wheel. As shown in Fig. 1, the center of the vehicle
frame _O_ _m_ is situated at the middle point of the rear non-steering
axle of the vehicle. The _x_ _m_ axis points forward, _y_ _m_ axis points
upward, and _z_ _m_ axis is along the right direction. The odometer
measures the forward motion in terms of accumulated pulses,
i.e., the number of pulses generated from the very start of the
vehicle motion, and we assume that the measurement frame is
coincided with the vehicle frame for simplicity. The IMU frame
is misaligned with the vehicle frame by mounting angles 𝜑, _ψ_,
_θ_ . The displacement between the IMU center _O_ _b_ and the vehicle
center _O_ _m_ is the lever arm **l** _[b]_, which is expressed in the body
frame. The navigation frame is defined as north, up and east.


_N_ _x_ _n_



3


denotes the meridian radius of curvature of the reference

ellipsoid.

Besides, the odometer scale factor _K_ is defined as the number
of pulses generated when the 1-m distance is travelled. The
mounting angle, the lever arm, and the scale factor _K_ are
regarded as random constants. For a navigation-grade IMU, the
biases **b** _g_, **b** _a_ for gyroscopes and accelerometers can be modeled
as constants as well.


The transformation matrix from the IMU body frame _b_ to the
vehicle frame _m_, by the 2-3-1 rotation sequence, is given as

**C** _bm_ = **M** 1 ( )  **M** 3 ( )  **M** 2 ( )  (5)

where **M** _i_  ( ) denotes the elementary rotation matrix along the


_i_ -th axis. According to the observability analysis [30], the
mounting angle along the forward direction is unobservable and
only the mounting angles along the yaw and the pitch directions
can be estimated.


Therefore, the parameters involves in the navigation system
can be modeled as


= 0 (6)


= 0 (7)

_K_ = 0 (8)


_b_
**l** = **0** (9)







_U_















**b** = **0**



=



_g_



(10)



Figure 1. IMU installed on a vehicle, with definitions of the body frame, the
vehicle frame, and the navigation frame.


In current INS/OD integrated navigation system, the
dynamic model that includes the rate equations of the attitude,
velocity and position are given as blow [13].
##### C bn = C bn ( ω bnb  ), ω bnb = ω ibb − b g − C ω bn inn (1) v n = C bn ( f b − b a ) ( − 2 ω ien + ω enn )  v n + g n (2)


_n_
**p** = **R v** _c_ (3)


where **C** _b_ is attitude matrix from the body frame to the _n_



**b** = **0**



=



_a_



The indirect Kalman filter is used to estimate the system error
states [32]. The attitude error is defined as


_b_ _b_ _n_
##### C n = C n ( I + (   ) ) (11)


_n_
where  denotes the attitude error angles, and ( )  represents


the skew-symmetric operation.

The error format of other states are defined as the estimate

ˆ
subtracting the true state, i.e.,  **x** = **x** − **x** . Therefore, the 21
dimension error state is


_T_
**x** ( ) _t_ =   _nT_,  **v** _nT_,  **p** _T_,  **b** _Tg_,  **b** _Ta_,  _K_, ,,  **l** _bT_  (12)


More details about the error state Kalman filter for SINS can

be readily found in textbooks, e.g., [32].


III. O DOMETER P ULSE E RRORS AND M EASUREMENT MODELS


In this section, three types of measurement models are
presented by means of different odometer pulse usage.
Comparing with traditional forward velocity and distance
increment measurements, the current models are directly based
on the output of the odometer, i.e., the number of pulses.
Specifically, we propose a new pulse accumulation model, in
which the system state is augmented with the accumulated
pulses. Similar to the traditional state-of-the-art distance
increment model, the pulse increment model is then derived. At
last, we report the details of the pulse-derived velocity
measurement model, which have not been given in our previous
work [30].

We start this section by analyzing the error characteristics of



_b_
**ω** _ib_



navigation frame.



**v** is the velocity relative to the earth. _n_



and **f** denote the error-contaminated body rate measured by _b_

the gyroscopes and the specific force measured by the
accelerometers, respectively. **ω** _ien_ is the earth rotation rate



relative to the inertial frame, and **ω** _enn_ is the rotation rate of the


navigation frame relative to the earth frame. **g** _n_ is the


gravitational vector.


_T_

The vehicle’s position **p** =   _L_ _h_  includes the


longitude λ, latitude _L_, and height _h_ . Thus, the local curvature
matrix in (3) is



 0 0 1 ( _R_ _E_ + _h_ ) cos _L_ 
 
=  1 _R_ _N_ + _h_ 0 0 
 0 1 0 



0 0 1 ( _R_ _E_ + _h_ ) cos



_R_ + _h_ cos _L_



_E_



_R_ + _h_



**R** = 1 _R_ _N_ + _h_ 0 0 (4)



1 _R_ + _h_ 0 0



_c_ _N_



0 1 0



where _R_ _E_ denotes the transverse radius of curvature and _R_ _N_


the accumulated pulses and the incremental pulses. The
odometer is in nature an encoder that counts the number of

pulses generated by the movement of the vehicle [34]. The
odometer encoder of the land vehicle usually comprises of a
detector and a number of pulse-generating physical nodes (e.g.,
magnetic material nodes) uniformly fixed on the rotating wheel
hub. When the vehicle wheel rotates, the nodes pass in turns by
the detector and a sequence of pulses are generated. Under
normal scenarios without tire slips, all odometer pulses should
be evenly situated across the travelled distance and the gap
between two pulses is 1/ _K_ m, namely, one pulse corresponds to
a distance increment of 1/ _K_ m.


As illustrated in Fig. 2(a), it is not uncommon that the
detector misaligns with the pulse-generating nodes at the
sampling time. However, the encoder can only count the
number of pulses in integers, therefore, we define the pulse
round-off error as the distance between the detector’s location

and the last pulse-generating node. Upon initiation, the roundoff error is denoted by  _p_ 0 (see Fig. 2(a)). Predictably, at each

sampling time the detector’s location relative to the pulsegenerating nodes depends on the vehicle motions. In other
words, the odometer pulse round-off error  _p_ _k_ is related to the

vehicle motions.


Assume _N_ _k_ accumulated pulses have been detected at the _k_  th sampling time _t_ . The accumulated pulse error _k_ _e_ _k_ can be

defined as the accumulated pulse counts subtracting the true
pulse counts



4


_[e]_ _k_ _U_ (  _p_ 0 − 1,  _p_ 0 ) .


_Proof:_ Assume _N_ _k_ accumulated pulses have been detected at
the _k_ -th sampling time _t_ . As shown in Fig. 2(b), if the _k_


sampling time _[t]_ [ approaches the next pulse-generating time ] _k_



_T_ _N_ _k_ + 1 from left, i.e.,



_t_ _k_ → _T_ _N_ − _k_ + 1, the true pulse counts



corresponding to the travelled distance are _N_ _k_ + − 1  _p_ 0 .

Therefore, the accumulated pulse measurement error is

_e_ _k_ → _N_ _k_ − ( _N_ _k_ + − 1  _p_ 0 ) =  _p_ 0 − 1 (14)



Similarly, as



_t_ _k_ → _T_ _N_ + _k_, the true pulse counts corresponding to



the travelled distance are _N_ _k_ − _p_ 0 . The accumulated pulse

measurement error becomes


_e_ _k_ → _N_ _k_ − ( _N_ _k_ − _p_ 0 ) =  _p_ 0 (15)


The probability that the sampling time _t_ happens between _k_

two pulse-generating nodes is uniform. Hence, the
measurement error of the accumulated pulses is
_e_ _k_ _U_ (  _p_ 0 − 1,  _p_ 0 ) . Besides, the variance is correspondingly


computed as



var ( _e_ _k_ ) =  _p_ 0 − (  _p_ 0 − 1 )  12=1 12 (16)



( _e_ _k_ ) =  _p_ 0 − (  _p_ 0 − 1 )



2







Detector's initial location



Pulse-generating nodes



 _p_ _k_



(13)



_k_



_t_ _t_ _t_



_t_ _k_ _t_ _k_ − 1
### = N k −  0 s dt = N k − 1 +  N k − (  0 s dt +  t


_t_ _k_

= _e_ +  _N_ − _s dt_



_T_ 0



_k_ _k_ − 1 _k_



− 1



_e_ = _N_ − _s dt_ = _N_ +  _N_ − _s dt_ + _s dt_



_e_ _k_ = _N_ _k_ − _N_ _k_ −+ 1  _p_ _k_ 1



_e_ _k_ = _N_ _k_ − _N_ _k_ −+ 1  _p_ _k_ + − 1  _p_



= − −+ + −



( _N_ _k_ −+ 1  _p_ _k_ + − 1  _p_ 0 )



 + − 1 



= _N_ − _s dt_ = _N_ +  _N_ − _s dt_ +



_k_ _k_ 0 _k_ − 1 _k_ 0 _t_



0 _k_ − 1 _k_ 0



_k_ − 1



−



_t_ _k_ − 1 _t_ _k_

_s dt_ + _s dt_
### (  0  t k − 1 )



Detector's location at the sampling time


 _p_ 0


Distance


Time



= −



 −



_p_ _k_ − _p_ 0



0



_t_ _k_



_e_ +  _N_ − _s dt_



_t_ 0 _T_ 1 _T_ 2 _T_ _N_ _k_ _t_ _k_


(a)



_k_ − 1 _k_ _t_



1



1


###  t



−



_k_



_k_ − 1



in which  _N_ _k_ is the measured pulse increment in the sampling


time interval right before _t_, and _k_ _s_ denotes the vehicle’s

forward speed in pulse/s. Especially, if the vehicle moves
forward with a constant speed, we turn to have identical pulse
increments  _N_ _k_ (depending the detector’s location relative to

the pulse-generating nodes at both ends of the sample interval).
As a result, any two consecutive accumulated pulse errors are
approximately related by a constant  _N_ _k_ − _sT_, where


_T_ = _t_ _k_ − _t_ − _k_ 1 . In general, however, the statistical characteristics

of the accumulated pulse errors are impossible to model without
the knowledge of the vehicle motion.

In order to make the problem mathematically tractable, we
make an assumption below to decouple the odometer pulse
measurement error with the vehicle motion and then account for

their connection by using the MMAE approach in next section.

_Assumption 1:_ The pulse measurement error  _p_ _k_ ( _k_  0 ), is

uniformly distributed over [0, 1) with variance 1/12. In addition,
the pulse measurement error is statistically independent, i.e.,


_T_
_E_  _p_ _k_  _p_ _i_ = 0, _i_  _k_ .
####  


_A._ _Pulse Accumulation Measurement_


_Lemma 1_ : The accumulated pulse measurement error is
subject to the uniform distribution, namely,



1 − 1 ( 2 −  _p_ 0 )



( _N_ _k_ + − 1  _p_ 0 )







− 1 2







_e_ 1 − − _p_ 0



_e_ _k_  _N_ _k_ + − 1 _N_ _k_ + − 1  _p_



 + − + −



− −



 _p_ 0



= −







_p_ 0





=









1



Distance


Time













( _N_ _k_ + − 1  _p_ 0 )



1


























|Col1|Col2|Col3|0|Col5|0|
|---|---|---|---|---|---|
|||(<br>)<br>1<br>0<br>0<br>1<br>1<br>_e_<br>_p_<br>_p_<br><br><br>−<br>−<br>=|(<br>)<br>1<br>0<br>0<br>1<br>1<br>_e_<br>_p_<br>_p_<br><br><br>−<br>−<br>=|(<br>0<br>1<br>_k_<br>_k_<br>_k_<br>_e_<br>_N_<br>_N_<br>_p_<br><br><br>−<br>+<br>=<br>−|(<br>0<br>1<br>_k_<br>_k_<br>_k_<br>_e_<br>_N_<br>_N_<br>_p_<br><br><br>−<br>+<br>=<br>−|



_T_ 0 _T_ 1



_T_ _N_ _k_



_T_ _N_ _k_ + 1



(b)


Figure 2. Definitions of round-off error and accumulated pulse measurement
error on the distance line. (a) Pulse round-off error, defined as the distance
between the odometer detector’s location and the last pulse-generating node. (b)
Upper bound and lower bound of accumulated pulse measurement error.

The time rate of travelled distance (in terms of odometer
pulse _s_ ) is related to the system states as [30]


_T_ _m_ _b_ _n_ _b_ _b_
##### s = K e C 1 b ( C v n + ω eb  l ) (17)


_b_

where **ω** _eb_ is the angular velocity of the vehicle body frame


w.r.t. the earth frame. **[e]** 1 [ is the 3 dimensional unit vector with ]

the _i_ -th element being 1.

In order to use the accumulated pulses as the measurement
directly, the error of the travelled distance _s_ is augmented to the

system error state


_T_
**x** _a_  **x** _T_  _s_  (18)
=  


In the error-state Kalman filter, the kinematics of the pulse


error should be derived and added into the dynamical model of
the integrated navigation system. Specifically, we need to
consider (17) with error terms, which is given as


_T_ _m_ _b_ _n_ _b_ _b_
##### s = K e C 1 b ( C v n + ω eb  l ) (19)


_K_ = _K_ +  _K_ (20)

**C** _bm_ = ( **I** −  **α**  ) **C** _bm_ (21)


_b_ _b_ _b_
**l** = **l** +  **l** (22)
where the IMU-vehicle misalignment angles is denoted by


_T_
 **α** =  ,,  .



5


_B._ _Pulse Increment Measurement_


The second type of measurement is the pulse increment in
time intervals of interest. The dynamical model is the same as
in Section II. The pulse increment measurement model is



_N_ _t_



1



_s_ _s dt_



= _s_


###  k = 1 tt k



_k_ +



+



= 1



_k_



=



_N_ _T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
###  k = 1 K e C 1 b  t k C n ( ) t v ( ) t + ω eb ( ) t  l



(32)



_T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_
###  K e C 1 b  t C n ( ) t v ( ) t + ω eb ( ) t  l



_k_ +



+ 1



_n_ _b_

( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_



+



_K_ **e C** _m_ **C** _t_ **v** _n_ _t_ + **ω** _t_  **l** _dt_



= _t_ **v** _t_ + **ω** _t_ 



1

1



_k_



=



_b_

In (19), **ω** _eb_ can be further expanded as


**ω** _beb_ = **ω** _ibb_ − **C ω** _bn_ _ien_ (23)


_b_ _b_
**ω** _ib_ = **ω** _ib_ + **b** _g_ (24)


_b_ _n_ _b_ _n_ _n_ _n_
##### C ω n ie = C n ( I + (   ) ) ( ω ie +  ω ie ) (25)



Note that the pulse increment is related to all states during
the considered interval, instead of the state at a fixed time. This
violates the basic assumption of the standard Kalman filter that
the measurement is simply a function of the current state.

Along with the NHC measurements, the complete
measurement model is given as



  _s_ 
 _y_  _s_   _T_ 
 **y** _nhc_  =  **ee** _T_ 32  **C** _bm_ ( **C v** _bn_ _n_ + **ω** _beb_  **l** _b_ ) 



**y** _nhc_   **ee** _T_ 2  **C** _bm_ ( **C v** _bn_ _n_ + **ω** _beb_  **l**



2 _m_ _b_ _n_ _b_ _b_

_nhc_   _T_  **C** _b_ ( **C v** _n_ + **ω** _eb_  **l**



2 _m_ _b_ _n_ _b_ _b_

_T_  **C** _b_ ( **C v** _n_ + **ω** _eb_  **l** )



_s_
_y_  _s_  



_s_ _T_



(33)



where  **ω** reflects the influence of the position error. _ien_



3



 **ω** _ien_ =  **ωp** _ien_  **p** =  _ie_  000 − cossin0 _LL_ 000  



_N_ _t_



_ien_ =  **ω** _ien_  **p** =  _ie_



0 − sin _L_ 0

0 cos _L_ 0

0 0 0



**ω** _ien_ =  **ωp** _ie_  **p** =  _ie_  0 cos _L_ 0   **p**



(26)



Here, we need to derive the measurement matrix of the pulse
increment measurement. Similar to the method used in

Appendix A, the error format for (32) is



+ 1



_k_



**M**  **x**



_k_ +



+



in which  _ie_ is the rotational rate of the Earth.


Substitute (20)-(26) into (19), the kinematics of the pulse
error is obtained


= _s_ _s_ − _s_ (27)
The Jacobian matrices are obtained by calculating the partial
derivative of (27) w.r.t. error states, which are given in
Appendix A.


Accompanied with the NHC constraint [13], the complete
measurement model is



 _s_ **M** 



 _s_



_s_ **M**  **x** _dt_


###  t



_k_ = 1 _t_ _k_ _k_ _k_



1



=



_N_ _t_


### 



_k_



_k_ +



+ 1



+ 1



**M Φ**  **x**



(34)







= 1 _t_ _k_ _k_ |







_k_ = 1 _t_ _k_ _k_ _k N_ | _N_



_dt_



=



 _N_ _t_ _k_ + 1 
### =   k = 1 t k M k dt Φ k |0 



_N_ _t_



+ 1


###  t



_k_ +



_dt_



+



**M** _dt_ **Φ** **Φ**  **x**



1 _t_ _k_ _k_ _k_ |0  0|







_k_ = 1 _t_ _k_ _k_ _k_ |0  0| _N_ _N_



_k_



=



 _s_ 
 _y_ _s_   _T_ 
 **y** _nhc_  =  **ee** _T_ 32  **C** _bm_ ( **C v** _bn_ _n_ + **ω** _beb_  **l** _b_ ) 



_s_
_y_  



_s_ _T_



where **M** denotes the Jacobian matrix of pulse velocity w.r.t. _k_


state **x** at _t_ . _k_ **Φ** _k k_ | − 1 denotes the state transition matrix from


_t_ − _k_ 1 to _t_ that is assumed to be constant during the small time _k_


interval _T_ . The integration of **M** in (34) is denoted as _k_ **H**, and _k_

its derivation is provided in Appendix C. Therefore, the
complete measurement matrix for pulse increment
measurement is



**y** _nhc_   **ee** _T_ 2  **C** _bm_ ( **C v** _bn_ _n_ + **ω** _beb_  **l**



2 _m_ _b_ _n_ _b_ _b_

_T_  **C** _b_ ( **C v** _n_ + **ω** _eb_  **l** )



(28)



2 _m_ _b_ _n_ _b_ _b_

_nhc_   _T_  **C** _b_ ( **C v** _n_ + **ω** _eb_  **l**



3



The corresponding measurement matrix is then computed as



_N_



(35)



 **0** 1 21  1 



 **0** 1 21  1 

**H** _s_ =   (29)
**H**


### H   H Φ k k |0  Φ



_k_ _k_ |0 0| _N_
_s_ =  _k_ = 1 



 _N_  
###   H Φ k k |0  Φ 0| N 
=  _k_ = 1  
 **H** _nhc_ 



_k_ _k_ |0 0|

1 



**H**



 _s_ =



_s_



  **0** 1 21  1  
=  
 **H** _nhc_ 



_nhc_



_nhc_



Note that the Jacobian matrices w.r.t. the NHC are similarly
computed as the method given in Appendix A. The difference
is that **e** 1 should be replaced with **e** 2 and **e** 3, respectively.


The measurement prediction of accumulated number of pulse
counts requires the integration of (17)



If the vehicle is driven mildly, **M** can be regarded as _k_

constant over the small interval of length _T_ . In addition, if no
fast turns exist in the interval of length _NT_, the state transition
matrices can be further approximated by an identity matrix. In
this case, (35) can be further approximated as



_N_



_T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### s k + 1 [=] s k + K e C 1 b  t C n ( ) t v ( ) t + ω eb ( ) t  l dt  (30)



 _N_ 
###   [M] k T 

**H**  _s_ _k_ = 1
=  
 **H** _nhc_ 



_T_



_k_



+ 1 [=] _s_ _k_ + _K_ **e C** 1 _T_ _bm_ _k_ + 1



_n_ _b_

( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_



1



 _s_ _k_ = 1



_k_

_s_ _k_ = 1



(36)



_k_



_nhc_



The integral involved can be expanded using (23)



**H**



_t_ _k_ + 1 _b_ _n_ _b_ _b_
_t_ **C** _n_ ( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_  **l**



_k_ + 1 _b_ _n_ _b_ _b_
###  t k C n ( ) t v ( ) t + ω eb ( ) t  l dt


= _t_ _k_ + 1 **C** _b_ _t_ **v** _n_ _t_ + **ω** _b_ _t_  **l** _b_ − **C** _b_ _t_ **ω** _n_ 



_k_ +



+ 1



_n_ _b_

( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_



_t_ **v** _n_ _t_ + **ω** _t_  **l** _dt_



+



**C** _t_ **v** _n_ _t_ + **ω** _t_  **l**



+ **ω** _t_ 



_k_



Additionally, the measurement prediction of (32) is
computed following the Appendix B.

_Lemma 2:_ The pulse increment measurement error _[i]_ _k_


_T_
##### satisfies  E i i k k − 1  = − 1 12 and var ( ) [i] k = 1 6 .


_Proof:_ The accumulated pulse measurement error is


##### tt k + 1 C bn ( ) t v n ( ) t + ω bib ( ) t  l b − ( C bn ( ) t ω ien )  l b



(31)


### 



_k_



_k_ +



1



**C** _t_ **v** _n_ _t_ + **ω** _t_  **l** − **C** _t_ **ω** _n_  **l**


##### ( ) t v n ( ) t + ω bib ( ) t  l b − ( C bn ( ) t ω ien )



_t_ **v** _n_ _t_ + **ω** _t_  **l** − **C** _t_ **ω** _n_  **l** _dt_



+



An accurate calculation of (31) is provided in Appendix B.


computed as

_i_ _k_ = ( _s_ _k_ − _s_ _k_ − 1 ) ( − _s_ _k_ − _s_ _k_ − 1 ) =  _p_ _k_ − _p_ _k_ − 1 (37)
##### Since  p k U ( 0,1 ), according to Assumption 1 and (16),


####  k kT − 1  = E  (  p k −  p k − 1 )(  p k − 1 −  p k − 2 ) T 


##### E i i  k kT − 1  = E (  p k −  p k − 1 )(  p k − 1 −  p k − 2 ) T



 _p_ _k_ −  _p_ _k_ − 1 )(  _p_ _k_ − 1 −  _p_ _k_ − 2 )
(38)



= −



1 12



which means that the increment measurement errors are not

independent.

In addition, the variance of the incremental measurement
error is computed as


#### var ( ) i k = E i i  k kT  = E  (  p k −  p k − 1 )(  p k −  p k − 1 ) T 


##### i k = E i i  k kT  = E (  p k −  p k − 1 )(  p k −  p k − 1 ) T



 _p_ _k_ −  _p_ _k_ − 1 )(  _p_ _k_ −  _p_ _k_ − 1 )
(39)



6


IV. A CCOUNTING FOR V EHICLE M OTION D EPENDENCE BY


MMAE M ETHOD


Considering that the error characteristics of three types of
measurements are varying with the motion, the multiple model
method is selected from a wealth of adaptive algorithms to deal
with this problem. In this work, the standard deviation of the
odometer measurement error is taken as the modeling
parameter and the theoretical characteristics of pulse
measurement errors in Section III are exploited to guide the
design of the candidate models.

The rationale behind the MMAE method is the adaptive
selection of model parameters according to the probability
density function (pdf) [36]. Assume that the model set includes
_M_ models and each model is parameterized with **p** ( ) _j_ .Initially,


each model is assigned with equal weight, and then gradually
updated based on the measurement residual and residual
covariance. The process of weight updating and normalizing is
given as



=



1 6




                   

_C._ _Pulse Velocity Measurement_


The pulse velocity information is usually calculated from the
pulse increment over the sampling interval by

_s_ _k_ =  _NT_ _k_ + _i_ _k_ (40)


where  _N_ _k_ is the measured incremental pulse counts and _i_ _k_ is

the corresponding pulse increment measurement error.

If the wheel slipping and skidding are not considered, the
pulse increment error satisfies the property given in Lemma 2.
Unfortunately, even in normal situations (40) will still
introduce severe noise into the velocity as the sampling interval
_T_ is quite short. For instance, if _i_ _k_ = 0.5 and _T_ = 0.02s, then the
velocity error is 25 pulse/s, which is too inaccurate to be used.

To circumvent this problem, a preliminary Kalman filter is
adopted to derive the velocity by using the accumulated pulses
as observations. Specifically, we assume a constant acceleration
rate of the vehicle forward motion, namely,



_k_ ( ) _j_ = _w_ _k_ ( ) − _j_ 1 _p_ ( **y** _k_ | **x** _k_ − ( ) _j_ )



_k_ ( ) _j_ = _w_ _k_ ( ) − _j_ 1 _p_ **y** _k_ | **x** _k_ − _j_



_w_ _k_ = _w_ _k_ − 1 _p_



**y** _k_ **x**



=



− _p_ **y** **x** −



( ) _j_
( ) _j_ _w_ _k_



(45)



( ) _j_
( ) _j_ _w_ _k_

_k_  _M_



( ) _j_ _w_ _k_

_w_ 






### 



( ) _j_



( ) _j_
###  w k

_j_ = 1



_w_



1



=



in which ← denotes replacement, and _M_ is the number of

models.


And, the pdf of each residual is computed as



− _k_ ( ) _j_ ) = 1 1/2 exp − 1 **e** ( ) _k_ _j T_ ( **S** ( ) _k_ _j_ ) − 1 **e** ( ) _k_ _j_ 
 det 2 (  **S** ( ) _k_ _j_ )   2 



| **x** − _k_ ( ) _j_ ) = 1 1/2 exp − 1 **e** ( ) _k_ _j T_ ( **S** ( ) _k_ _j_ ) − 1 **e** ( ) _k_ _j_

 det 2  **S** ( ) _j_   2



− ( ) _j_

( **y** _k_ | **x** _k_ )



( ) _j_

(  **S** _k_ )



_p_ ( **y** _k_ | **x** − _k_ ( ) _j_ ) = 1/2 exp − **e** ( ) _k_ _j T_ ( **S** ( ) _k_ _j_ ) **e** ( ) _k_ _j_

 det 2 (  **S** ( ) _k_ _j_ )   2



−

**y** _k_ | **x** _k_ ) = 1/2 exp − **e** _k_ ( **S** _k_ ) **e**

 det 2  **S** ( ) _j_   2



( **S** ( ) _k_ _j_ )







 _ds dt_   0 1 0  _s_  0
 _ds dt_  =  0 0 1  _s_ +  0
 _ds dt_   0 0 0  _s_  1



_ds dt_   0 1 0  _s_  0
_ds dt_  =  0 0 1  _s_ +  0 _w_
_ds dt_   0 0 0  _s_  1


### + k =  w k ( ) j x ˆ + k ( ) j

_j_ = 1


### 



0 1 0  _s_ 0



0 0 1  _s_ + 0
0 0 0  _s_ 1



(41)



(46)

( ) _j_ ( ) _j_
where **e** _k_ and **S** _k_ are respectively the residual and the


corresponding covariance matrix of the _j_ -th model.

The state and covariance matrix estimated from the MMAE

method are computed by


_M_



+ ˆ +



ˆ + ˆ

**x** = _w_ **x**



=



_w_



( ) _j_ ˆ + ( ) _j_



= 1



_y_ _k_ = _s_ _k_ + _e_ _k_ (42)


where _w_ is the dynamic model error and _e_ _k_ is the accumulated

pulse measurement error. Note that the error characteristics of
the estimated pulse velocity is influenced by the vehicle
motions that have not been modeled in (41).

Upon obtaining the pulse velocity information, the complete
measurement model is constructed as



where **x** ˆ + _k_ ( ) _j_ and **P** _k_ + ( ) _j_ are the estimated state and covariance


matrix in terms of the _j_ -th model, respectively. Here,
superscripts ‘ － ’ and ‘ ＋ ’ denote the predicted and updated

values, respectively.


### k + =  jM = 1 w k ( ) j  ( x ˆ k + ( ) j − x ˆ k + )( x ˆ k + ( ) j − x ˆ k + ) T + P k + ( ) j



(47)


### =  w k ( ) j  ( x ˆ k + ( ) j − x ˆ k + )( x ˆ k + ( ) j − x ˆ k + ) T + P k + ( ) j 


### 



( ) _j_ ˆ + ( ) _j_ ˆ + ˆ + ( ) _j_ ˆ + + ( ) _j_



+ ˆ + ˆ + ˆ + ˆ + +



ˆ ˆ ˆ ˆ



**P** = _w_ **x** − **x** **x** − **x** + **P**



_w_


##### ( x ˆ k + ( ) j − x ˆ k + )( x ˆ k + ( ) j − x ˆ k + )



1



=



ˆ + ( ) _j_
**x** _k_ and



+ ( ) _j_

_k_



where



 _s_ _m_ _b_ _n_ _b_
#####  = diag (  K 1 1  ) C b ( C v n + ω eb 

 **y** _nhc_ 



_m_ _b_ _n_ _b_ _b_
#####  diag (  K 1 1  ) C b ( C v n + ω eb  l )

_nhc_ 


#####  diag (  K 1 1  ) C bm ( C v n n + ω eb  l ) (43)

**y** _nhc_ 



The adapted model parameter is calculated by


_M_


### p ˆ k =  w k ( ) j p ( ) j (48)

=



ˆ
### p k = 

= 1


### k =  w k ( ) j p ( ) j

_j_ = 1



_w_



( ) _j_ ( ) _j_



The corresponding measurement matrix is



=  **M** _k_ 
 **H** _nhc_ 



**H** _s_ =  **M** _k_  (44)
**H**



The MMAE method performs well as long as one model uses
the correct or nearly correct parameters [37]. As a result, the
theoretical analysis and empirical knowledge could assist the
design of the model set for practitioners.


V. S IMULATION R ESULTS


This section conducts simulations to verify the feasibility and
effectiveness of proposed methods. The vehicle is equipped



_k_
_s_ = 



_nhc_



where the pulse velocity measurement matrix **M** has been _k_

developed in (34).


with a navigation-grade IMU, which includes a triad of

gyroscopes (bias 0.005 / h, noise 0.001 / sqrt(h) ) and


accelerometers (bias 30 g , noise 5 g / sqrt(Hz)  ). The

odometer scale factor is 59.8 p/m. The IMU mounting angles
are 3 deg in the yaw direction and 2 deg in the pitch direction.


_b_ _T_

The lever arm is set to **l** =  1,0.5,0.8  m. The vehicle goes


forward with four kinds of moving patterns: constant
acceleration or deceleration, turns, constant velocity, and
varying acceleration or deceleration. The simulation time is
5000 seconds and the IMU update interval _T_ = 0.02s. The
trajectory is illustrated in Fig. 3(a). It can be seen that five turns
are conducted and the route is ended with a long straight line.
Periodic acceleration/deceleration are performed when the
vehicle drives forward. Fig. 3 (b) shows the
acceleration/deceleration history in the first two periods, i.e.,
240 seconds. Specifically, in addition to the acceleration and
deceleration, the vehicle moves forward with constant speeds
during the intervals 0~10s, 20~80s, and 90~120s of each period.
Note that a sine function is applied to simulate the varying
acceleration/deceleration, and the initial pulse round-off error

 _[p]_ 0 is set as zero.


Figure 3: The vehicle trajectory and acceleration history. (a) A trajectory of
about 76 km with five turns. (b) Acceleration and deceleration profile in the
first 240 seconds. The subfigure shows the sine-form acceleration/deceleration
in detail.


We first examine the accumulated pulse error and the pulse
increment error under different moving patterns. As shown in
the first row of Fig. 4, the distribution of accumulated pulse
errors is not strictly uniform in contrast to Lemma 1. When the
vehicle moves with constant speeds (0~10s, 20~80s, 90~120s),
two arbitrary consecutive accumulated pulse errors are roughly
related with a constant. In the middle row of Fig. 4, it can be
seen that the pulse increment error is neither normally nor
uniformly distributed. With uniform speeds, the pulse
increment errors are situated at − 0.2 and 0.8 due to the

correlation between two consecutive errors as discussed in

Lemma 1 and Lemma 2. It should be stressed that in the context

of practical vehicle movement the error characteristics of
accumulated pulses and incremental pulses will be much more
complicated than what we have observed in Fig. 4.

The accuracy of the pulse velocity obtained by the



7


preliminary Kalman filter is also examined. The third row of
Fig. 4 shows that satisfactory accuracy can be achieved other
than the time when varying acceleration and deceleration are
experienced. These large errors are caused by the inaccurate
modeling of pulse in (41), in which the varying acceleration rate
is not considered. It also indicates that the pulse velocity errors
are almost surely smaller than 0.5 p/s during the time with
constant acceleration rates. However, varying acceleration and
deceleration are common in normal vehicle movement. Large
pulse velocity errors will be encountered frequently in practice,
and of course the error characteristics also depend on the
vehicle motions. In addition, we also notice that the pulse
velocity error is also influenced by the magnitude of the
odometer scale factor. The encoder with higher resolution tends
to generate larger pulse velocity errors during the time with
changing acceleration and deceleration. This is because the
magnitude of pulse velocity becomes larger with higher
odometer resolution, and the estimation error will be
accordingly enlarged when varying acceleration and
deceleration are experienced.


Figure 4: Error characteristics of three types of pulse measurements. Top row:
accumulated pulse errors; middle row: pulse increment errors; bottom row:
pulse velocity obtained from the Kalman filter. Note that the bottom right figure
only shows the pulse velocity errors smaller than 2 p/s.


As shown in Fig. 5, the position estimation errors of three
measurement types are about 0.01% of the travelled distance,
which are satisfactory for this application and much better than
the acceptable maximum error ratio 0.1%. In contrast, the pulse
velocity type slightly outperforms the other two types. However,
the pulse velocity type significantly relies on the detection of
large measurement errors, which is fulfilled by setting a
threshold on the EKF innovation. Subsequently, the standard
deviation is appropriately enlarged in the Kalman filter.
According to Fig. 4, the initial standard deviation is set to 0.5


and the innovation threshold is set to 1.5. Measurements out of

the innovation threshold are treated with a larger standard
deviation of 5. By contrast, the measurement errors of the pulse
accumulation and pulse increment are relatively smaller and the
standard deviation is set to 1 for both of them. Note that the

standard deviation of the measurement in the navigation filter
should be compatible with the resolution of the odometer. For
example, the standard deviation should be set as larger values
while using the odometer with higher resolutions.


Figure 5: Horizontal position estimate errors.


The system parameter estimation results are shown in Fig. 67. As shown in Fig. 6, the results are similar for three
measurement types; however, the odometer scale factor and
mounting angles are slightly more accurate using the pulse
accumulation measurements. The lever arm results in Fig. 7
reveal that the pulse velocity measurement performs the best
whereas the pulse increment method is biased in the forward
lever arm estimate. We found that this was caused by the
negligence of the correlation in pulse increment measurement
errors, which can be fixed by using the Stochastic Cloning
Kalman filter (SCKF) [33]. The position estimation accuracy of
SCKF is nearly equivalent to EKF, therefore, we still adopted
it in the current work. The estimated IMU parameters are shown
in Fig. 8. The results are similar for three measurement types,
and the accelerometer bias is apparently more observable than
the gyroscope bias.


Figure 6: Odometer scale factor and mounting angle errors.



8


Figure 7: Lever arm errors.


Figure 8: Gyroscope and accelerometer biases errors.


In order to highlight the effectiveness of MMAE, noises with
different magnitude of standard deviations are added to the true
measurements. As the theoretical analysis shows, the ideal
standard deviation for pulse accumulation and increment errors
is sqrt(1/12) ≈ 0.3p and sqrt(1/6) ≈ 0.41p. Therefore, the noises
with standard deviations 0.5p (0~1000s), 2p (1000~3000s), and
5p (3000~5000s) are added to the accumulated and incremental
pulse measurements. In contrast, the magnitude of pulse
velocity errors is larger than the other two types of errors. The
noises with standard deviations 0.5p/s (0~1000s), 5p/s
(1000~3000s), and 20p/s (3000~5000s) are added to the pulse
velocity measurements. Figs. 9-11 show the results after using
the MMAE method, in which the ideal model sets are applied.
However, the standard methods use the smallest standard
deviation with a reasonable assumption that the measurement
information is reliable. In general, the prior knowledge of the
measurement errors is hard to access. It can be seen that larger


measurement error will deteriorate the estimation performance
in standard methods, whereas the MMAE technique can
adaptively select the most appropriate standard deviation (as
observed in the lower subfigures) and effectively suppress the
error accumulation.


Figure 9: Pulse accumulation measurements: comparison of standard method
and MMAE.


Figure 10: Pulse increment measurements: comparison of standard method and
MMAE.


Figure 11: Pulse velocity measurements: comparison of standard method and
MMAE.



9


VI. F IELD T EST R ESULTS


Land vehicle experiments were conducted to test the longtime and long-distance performance of proposed methods. The
vehicle was equipped with a navigation-grade IMU set and an
odometer with a scale factor about 53 p/m. The bias stability

and random walk for gyroscopes are normally 0.01 / h and


0.002 / sqrt(h), respectively. For accelerometers, the bias


stability is 50 g , and the random walk is 10 g / sqrt(Hz)  .

The sampling frequency of IMU is 100Hz and the 2-sample
algorithm was exploited in the navigation solution. Besides, the
odometer pulses generated in each _T_ = 0.02s were stored as
measurements. The pulse accumulation measurements were the
direct summation of all pulses from the very start. After that,
the pulse velocity measurements were obtained through the
preliminary Kalman filter proposed in Section III.

In order to corroborate the effectiveness of proposed methods,
we conducted two runs on the same route, as shown in Fig. 12.
In each experiment, the vehicle was kept still for 200~500
seconds for the initial alignment.

The reference data were obtained using the INS/OD/GPS
integrated navigation. The position accuracy of GPS was about
2m (1σ) and the accuracy of the reference position was better
than 0.5m (1σ). As the height error of this system is ready to be
aided with an atmospheric pressure altimeter [8], a reason that
the height accuracy is usually not listed for commercialized
products [35], the system performance is mainly evaluated by
the horizontal position accuracy.


Figure 12: Field tests last about 7 hours with the distance about 490km


_A._ _Online Calibration and Navigation_


We at first examine the methods proposed in Section III.
Suppose no prior information about the system parameters is
available. The odometer scale factor, lever arm, mounting
angles, and IMU biases were all initialized as zeroes in the
following navigation algorithms. The Kalman filter update
interval is 1s for three types of measurements. In order to avoid
the adverse effect of abnormal measurements caused by
possible wheel slipping and skidding, we routinely conducted
the variance relaxation when abnormal innovations were

detected. More details about using three types of measurements
are given as follows:


_1)_ _Pulse accumulation measurement_

As shown in Lemma 1, the theoretical measurement error of
accumulated pulse should be uniformly distributed with
variance 1/12. In simulations, small measurement variance
could be used. In field tests, larger standard deviations such as
0.5 or 1 are favored. Moreover, we also found that smaller NHC
variance was preferred for accumulated pulses, which puts
more strict constraints on the vehicle’s orientation.


_2)_ _Pulse increment measurement_

In field tests, the vehicle’s speed was mostly 60~100 km/h
and more than one thousand incremental pulses were generated
in 1s. Therefore, the standard deviation of the measurement
error was set to 2 to account for other systematic errors.
_3)_ _Pulse velocity measurement_

The pulse velocity could be estimated from the accumulated
pulses by the preliminary Kalman filter and used as the
measurement. The simulation result indicated that large pulse
velocity error would be generated once varying acceleration
and deceleration were experienced. As a remedy for this
drawback, a threshold was set on the innovation and a larger
standard deviation was used to cope with these inaccurate
measurements. It was also conducive to avoid the adverse effect

of abnormal measurements induced by the slipping and
skidding.

Navigation results of three measurement models are shown
in Figs. 13-18. Fig. 13 gives the estimated biases for gyroscopes
and accelerometers of three methods in the first run. It indicates

that the upward biases are more unstable and larger than those
in other directions. Fig. 14 provides the estimation results of the
scale factor and two mounting angles. Results are similar for
three methods in two runs except that the mounting angle _θ_ in
the first run is more unstable, and two mounting angles were
slightly different in two runs. In Fig. 15, the lever arm
estimation results of three methods are inconsistent to each

other; however, the system performance is not significantly
affected by this inconsistency. We found that the lever arm can
be regarded as a kind of ‘error buffer’ to account for the
unconsidered uncertainties of the measurement errors. This

observation is a good support for online calibration of the
involved parameters first advocated by our group [13].


Figure 13: Estimation results of gyroscopes and accelerometers for the first run
(Results of the second run are similar).

The position estimation errors are shown in Figs. 16-17. It
can be seen that pulse velocity measurements yield the best
accuracy than the other two kinds of measurements do. The
relative horizontal position errors are mostly lower than 0.2 ‰

of the travelled distance. In contrast, the relative position errors
of the pulse accumulation and increment measurements are
approximately 0.2-0.4 ‰ of the travelled distance. As for the



10


orientation estimation accuracy, three methods generate similar
results in Fig. 18.


Figure 14: Estimation results of odometer scale factor and mounting angles.
The left column is for the first run, and the right column is for the second run.


Figure 15: Estimation results of the lever arm. The left column is for the first
run, and the right column is for the second run.


Figure 16: The absolute position estimation errors for three methods. The top is
for the first run, and the bottom is for the second run.


Figure 17: The relative position errors of three methods. The top is for the first
run, and the bottom is for the second run.


Figure 18: Yaw angle estimation errors of three methods for two runs.


_B._ _Results of MMAE_


The difficulty of using the MMAE resides in designing the
parameter models. In this work, the standard deviations (stds)
of three kinds of the odometer measurement errors are

respectively designed in the MMAE, and the theoretical
analyses provided in Section II lead to convenient selection of
possible stds. The interacting multiple model (IMM) estimation
method [27], [36] was also tested but was inferior to the MMAE
method for the current problem. It agrees with the
recommendation in [37] that the MMAE is more stable in
parameter adaptation, and thus more preferred in the selection
of suitable error stds.


_1)_ _MMAE on pulse accumulation measurement_

According to the error statistics of the pulse accumulation
measurements, the MMAE models here included stds {0.5, 0.6,
0.7, 0.8, 0.9, 1}. Position estimation results are compared in
Figs. 19-20. It can be seen that the improvements of MMAE
over the standard pulse accumulation method are significant,
especially for the long-distance stability of position errors. Fig.
21 gives the adapted stds of MMAE in the two runs.



11


Figure 19: The position estimation errors by MMAE on the pulse accumulation
measurement. The top is for the first run, and the bottom is for the second run.


Figure 20: Relative errors by MMAE on the pulse accumulation measurement.
The top is for the first run, and the bottom is for the second run.


Figure 21: Adapted odometer pulse increment error stds for two runs.

_2)_ _MMAE on pulse increment measurement_

The ideal error characteristics of the incremental pulse
measurement have been given in Lemma 2. However, including
larger measurement stds for incremental pulses was found to be
more helpful in the experiments. In our tests, the bank of models


was assigned with stds from the set {0.5, 1, 2}. Results of
MMAE are shown in Figs. 22-23. It can be seen that horizontal
position errors are obviously ameliorated. As shown in Fig. 24,
the MMAE method frequently adjusts to select the most
suitable stds. Most of the time, the optimal std is small, which
means that the pulse increment measurement error is acceptable.


Figure 22: The position estimation errors by MMAE on the pulse increment
measurement. The top is for the first run, and the bottom is for the second run.


Figure 23: Relative errors by MMAE on the pulse increment measurement. The
top is for the first run, and the bottom is for the second run.


Figure 24: Adapted odometer pulse increments error stds for two runs.



12


_3)_ _MMAE on pulse velocity measurement_


Varying acceleration and deceleration are inevitable in
practical driving. In addressing large measurement errors, the
aforementioned variance relaxation method is quite ad hoc. In
contrast, the MMAE approach provides a more delicate
treatment of this problem. The bank of stds was designed as {1,
2, 3, 5}, in view of the above observation that high-accuracy
pulse velocity information could be obtained most of the time.
Results presented in Figs. 25-26 show the improvement on the
horizontal position over the original EKF method. Fig. 27 gives
the adapted stds, which indicates that the pulse velocity
measurements are accurate in most cases.


Figure 25: The position estimation errors by MMAE on the pulse velocity
measurement. The top is for the first run, and the bottom is for the second run.


Figure 26: Relative errors by MMAE on the pulse velocity measurement. The
top is for the first run, and the bottom is for the second run.


Figure 27: Adapted odometer pulse velocity error stds for two runs.


_C._ _Detailed Measures for Performance Evaluation_


In Fig. 28, we also compared the position estimation results
of three measurements after using the MMAE. It can be seen
that the long-distance position accuracy of pulse accumulation
measurement is slightly better than the others. In order to
further quantitatively assess the performance of the proposed
methods, three measures are presented here. The results with
the measures defined below are given in Table II. Note that the
absolute error is in meter and the relative error is the ratio of the

position error w.r.t. the travelled distance.


Figure 28: Comparison of position errors after using MMAE. The top is for the
first run, and the bottom is for the second run.

_1)_ _Mean position error (Mean20)_

We observed that the position error often becomes stable after
20km. The criterion _Mean20_ is thus defined as the average of
the positon errors after 20km. The criterion reflects the overall
performance, and the mean absolute error and the mean relative
error are both given.


_2)_ _Gradient (Gra20)_

A straight line is used to fit the position errors after 20km. The
criterion _Gra20_ is defined as the slope of the line. This criterion
indicates the stability of errors. Specifically, both the absolute



13


error and the relative error are computed. The smaller the slope,
the better the estimation error stability.


_3)_ _Maximum (Max20)_

This measure is defined as the maximum position error after
20km. Note that this measure is only computed with the
absolute error, since the relative error ratio at 20km is always
the largest.

TABLE II

P ERFORMANCE M EASURES OF PROPOSED METHODS

Test Methods Mean20 (m, ‰ ) Gra20 (m, ‰ ) Max20(m)

1 PA 48.05 0.202 0.156 -1.77e-4 88.67

2 PA 62.98 0.252 0.230 -6.94e-5 128.7

1 PI 49.64 0.209 0.151 -1.90e-4 90.69

2 PI 66.20 0.252 0.264 1.19 e-4 138.7

1 PV **34.55** **0.168** **0.112** **-4.47e-4** **72.58**

2 PV **46.91** **0.190** **0.201** **-8.27e-5** **111.4**

1 PA_M **22.03** 0.154 **-6e-4** **-9.25e-4** **51.28**
2 PA_M **19.86** 0.119 **0.019** **-5.63e-4** **49.84**
1 PI_M 26.48 **0.127** 0.068 -3.17e-4 59.86
2 PI_M 26.17 **0.118** 0.096 -2.12e-4 72.47
1 PV_M 23.60 0.132 0.053 -5.44e-4 54.57
2 PV_M 26.59 0.132 0.088 -3.75e-4 69.23

PA: Pulse accumulation. PI: Pulse increment. PV: Pulse velocity. The suffix
‘M’ denotes the MMAE-aided versions. For Mean20 and Gra20, the left column
was computed with absolute errors, and the right column was computed with
relative errors.

Here we adopt the absolute mean and the stability to assess
the algorithms. Among three types of measurements, Table II
indicates that the performance of the standard pulse velocity
measurement is about 39% better in mean, and 28% better in
stability. But aided by MMAE, the pulse accumulation
measurement slightly outperforms the other two types of
measurements about 23% in mean, whereas it is more stable by
over 7 times. This indicates that the contribution of MMAE is
more significant to the pulse accumulation measurement than
the other two measurements.


In summary, the properties of three measurements are finally
concluded in Table III, which might be conducive to their
practical applications. The error property is corresponding to
the theoretical analyses in Section III. Considering more
computations are required for the MMAE-aided EKF, we
regard the standard EKF versions as ‘fast’ and name the
MMAE-aided versions as ‘effective’. Moreover, the pulse
velocity measurement with standard EKF and the pulse
accumulation measurement with MMAE-EKF are both denoted

as ‘recommended’.


TABLE III

S UMMARY OF THREE M EASUREMENTS

Methods Error Property Standard EKF MMAE-EKF

Effective
PA Motion-dependent fast & Recommended

PI Motion-dependent fast Effective

& Correlated


fast
PV Motion-dependent & Recommended Effective


PA: Pulse accumulation. PI: Pulse increment. PV: Pulse velocity.


VII. C ONCLUSION


In this article, the INS and odometer integrated navigation
algorithms were investigated, focusing on rigorous error
analysis of the odometer pulse and the countermeasures.


Specifically, three types of measurements were formulated
based on the pulse accumulation, pulse increment, and pulsederived velocity, respectively. In addition, the multiple model
estimation method was applied to further improve the
performance by accounting for the motion-dependent
measurement errors. Field tests were repeated on the same route
about 490km for two times. The average position errors of three
types of measurements are all better than 0.25‰ of travelled
distance. Moreover, results of simulations and field tests show
that the pulse velocity measurement performs the best in
standard EKF realizations. After incorporating the MMAE
approach, the average position errors of three types of
measurements are all better than 0.15‰ of travelled distance,
and the pulse accumulation measurement is more privileged in
the sense of error stability, despite more computation-intensive.

The delicate manipulation of odometer pulses proposed in this
paper is hopefully beneficial to other wheeled applications,
such as the land robotics navigation and the pipeline survey, etc.


A PPENDIX A


The pulse velocity error in (27) is simplified by only
considering the error of each state.



Finally, the Jacobian matrix of the pulse velocity model w.r.t.
the error state is


_T_
**F** _p_ =  **M** _k_,0  (60)


A PPENDIX B


This appendix gives detailed derivation of the velocity
integration in (31). According to the velocity integration
method proposed in [38], the terms related to attitude are
rewritten as


##### M k (10:12) =  s T = − K e C 1 T bm ( l b 

 **b**






##### k (10:12) = s T = − K e C 1 T bm ( l b  )

 **b**

_g_



14


(55)







 _s_ _T_ _m_ _b_ _n_ _b_ _b_
##### M k (16) =  K = e C 1 b ( C v n I + ω eb  l ) (56) M k (17) =  s = K e 1 T M 3 ( )  D M 2 ( )  ( C v bn nI + ω beb  l b )


(57)


 _s_ _T_ _b_ _n_ _b_ _b_
##### M k (18) =  = K e 1 D M 3 ( )  M 2 ( )  ( C v n I + ω eb  l )  (58)



  _s_ _T_ _m_ _b_
##### M k (19: 21) = bT = K e C 1 b ( ω eb  )

  **l**



(59)







= − _K_ **e C** 1 _T_ _bm_  **C** _bn_ ( **v** _n_ + ) **l** _b_  **C** _bn_ ( **ω** _ien_  ) 



**e C** _m_ **C** **v** _n_ + **l**  **C** **ω**



 _n_



_s_ = − _K_



_T_ _m_ _b_ _n_ _b_ _b_ _n_ _n_

**e C** 1 _b_ **C** _n_ **v** + **l**  **C** _n_ **ω** _ie_  



1



_n_ _b_ _b_ _n_

( **v** + ) **l**  **C** _n_ ( **ω** _ie_  )



**e C C** 1 _T_ _bm_ _bn_  **v** _nI_ − _K_ **e C** 1 _T_ _bm_ ( **l** _b_  ) **b** _g_



_k_ _k_







**e C C** _m_  **v** _n_ − _K_ **e C** _m_ **l**  **b**



_K_ **e C C** _m_  **v** _n_ − _K_



+ **v** − 



1 _b_ _n_ _I_ 1



_b_

( **l**  )



( ) _k_
( ) _k_



 0 − sin _L_ 0 

_T_ _m_ _b_ _b_  

+ _K_ **e C** 1 _b_ ( **l**  ) **C** _n_  _ie_  0 cos _L_ 0 
 0 0 0 



**C** _bn_ ( ) _t_ **v** _n_ ( ) _t_ = **C** _b tb t_ ( ) **C** _b tn t_ ( ) _k_ **C** _n tn t_ ( ) _k_ **v** _n_ ( ) _t_ (61)



( ) _t_ **v** _n_ ( ) _t_ = **C** _b tb t_ ( ) ( ) _k_



= **C** _b tb t_ ( ) ( ) _k_ **C** _b tn t_ ( )( ) _kk_ **C** _n tn t_ ( ) ( ) _k_ **v** _n_ ( ) _t_



_k_ _k_ _k_ _k_



=



_k_ _k_



 0 − sin _L_

_T_ _m_ _b_ _b_ 

_K_ **e C** **l**  **C**  0 cos _L_



_T_ _m_ _b_ _b_

1 _b_ **l**  **C** _n_  _ie_



0 − sin _L_ 0

0 cos _L_ 0

0 0 0



**e C** 1 _bm_ **l**  **C**  _ie_ 0 cos _L_ 0  **p**



(49)



_b_ _n_ _b_ _b_ _n_ _n_
##### ( C n ( ) t ω ie )  l = C n ( ) t ( ω ie  ) C b ( ) t



_n_ _n_ _n_

**C** _t_ **ω**  **l** = **C** _t_ **ω**  **C** _t_ **l**



_b_ _n_ _b_ _b_ _n_ _n_ _b_
_n_ ( ) _t_ **ω** _ie_  **l** = **C** _n_ ( ) _t_ **ω** _ie_  **C** _b_ ( ) _t_ **l**



_t_ **ω**  **l** = _t_ **ω**  _t_



=



1



_b_

( **l**  )



 0 cos _L_ 0 



**C** **C** _k_ **C** _k_ **ω** _n_  **C** **C** _k_ **C** _k_ **l**


##### n tn t ( ) ( ) k ( ω ien  ) C n tn t ( ) ( ) k



( ) _k_
( ) _k_



_b t_ ( ) _k_
_b t_ ( )



( ) _k_
( ) _k_


##### b tb t ( ) C b tn t ( ) k C n tn t ( ) k ( ω ien  ) C n tn t ( ) C b tn t ( ) k C b tb t ( ) k l b



_b t_ ( )
_b t_ ( ) _k_



_k_ _k_ _k_ _k_











_M_



_K_



**e** **M**  **D** **C v** _n_ + **ω**  **l**



_T_ _b_ _n_ _b_ _b_

1 **M** 3 ( )  **D** _M_ ( )  **C v** _n_ _I_ + **ω** _eb_  **l**



1



+ **e** + **ω** 



**M**  **D**



3



_b_ _n_ _b_ _b_

( )  **D** _M_ 2 ( )  ( **C v** _n_ _I_ + **ω** _eb_  **l** )







2







2



(62)
And, we have







_K_



**e** **D**  **M** **C v** _n_ + **ω**  **l**



_T_ _b_ _n_ _b_ _b_

1 **D** _M_ ( )  **M** 2 ( )  **C v** _n_ _I_ + **ω** _eb_  **l**



1



+ **e** + **ω** 



**D**  **M**



_M_



3



 **C v** _n_ _nI_ + **ω** _eb_  **l** 







_b_ _n_ _b_ _b_

( )  **M** 2 ( )  ( **C v** _n_ _I_ + **ω** _eb_  **l** )


### C b tb t ( ) ( ) k = I −  t ω b


### b tb t ( ) ( ) k = I −  tt ω bib


### ( ) ( ) k = I − (  tt k ω bib dt )



= − **ω** 



_dt_



1



_K_



**e C ω** _m_  **l** + **e C** _m_ **C v** _n_ + **ω**



_T_ _m_ _b_ _b_ _T_ _m_ _b_ _n_ _b_

**e C ω** 1 _b_ _eb_  **l** + **e C** 1 _b_ **C v** _n_ _I_ + **ω** _eb_



1



+  + + **ω** 



_k_ _t_ _k_







_b_ _n_ _b_ _b_

( **C v** _n_ _I_ + **ω** _eb_  **l** )  _K_



_eb_



(63)



in which, the mounting matrix is denoted as

**C** _bm_ [=] **M** 3 ( )  **M** 2 ( )  (50)


And, the derivatives of the elementary rotation matrix are given

as



**C** _n tn t_ ( ) ( ) _k_ + **I** ( _t_ − _t_ _k_ ) **ω** _inn_  (64)


where **a** , **b**  are computed with two samples of gyroscopes.



2

 **I** −  ( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ ) **b**  
 2 



( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ )



2



_t_ − _t_ _k_ **a**  + ( _t_ − _t_ _k_ ) **b** 



_k_



**I** − **a** + _t_ − _t_ **b**



2



_k_



 − sin  0 − cos    − sin  cos  0 
 0 0 0 , **D** _M_ 3 ( )  = − cos  − sin  0 
 cos  0 − sin   0 0 0 



**b** = 3  **θ** 1 − **θ**



= 3  **θ** 1 −



 − sin  0 − cos    − sin  cos 

**D** _M_ 2 ( )  =  0 0 0 , **D** _M_ 3 ( )  = − cos  − sin 

 cos  0 − sin   0 0



 − sin  0 − cos    − sin  cos  0

=  0 0 0 , **D** _M_ 3 ( )  = − cos  − sin  0

 cos 0 − sin   0 0 0



3



4



(  **θ** 2 − **θ** 1 )

2



2 ( )  =  0 0 0 , **D** _M_ 3 ( ) 



**a** = 4 (  **θ** 2 − **θ**



= 4 (  **θ** 2 −







_T_



_M_, _M_



(65)



1 2



_T_



(51)
Therefore, the partial derivatives can be computed as follows



Substitute (63), (64) into (61), the integration of (61) is
computed as






#### M k (1:3) =  nT s = − K e C 1 T bm  C bn ( v n + ) l b  C bn ( ω ien  ) 


### 



_t_ _k_ + 1 _b t_ ( ) _b t_ ( ) _k_ _n t_ ( ) _k_ _n_
_t_ **C** _b t_ ( ) _k_ **C** _n t_ ( ) _k_ **C** _n t_ ( ) **v**



**C** **C** _k_ **C** _k_ **v**


#### k (1:3) = nT s = − K e C 1 T bm  C bn ( v n + ) l b  C bn ( ω ien  )



_k_ + 1 _b t_ _b t_ _k_ _n t_ _k_



( ) _k_ _n_

**v**

( ) ( )



( ) _k_
( ) _k_



_t dt_



_b t_ ( )
_b t_ ( ) _k_







+ 1



+



_t_ _k_ _k_ _k_



 _s_ _T_ _m_ _b_
**M** _k_ (4: 6) = _nT_ = _K_ **e C C** 1 _b_ _n_
 **v**



(52)


(53)



_k_ + 1 _b t_ ( ) _k_ _n_
###  t C n t ( ) k v ( ) t dt + 


### tt k + 1 C b tn t ( )( ) kk v n ( ) t dt +  tt k + 1 ( t − t k ) C b tn t ( )( ) kk ω inn  v n



_k_ + 1 _b t_ _k_ _n_ _k_ + 1 _b t_ _k_



+ +



+ 1 _k_ + 1



**C** _k_ **v** _n_ _t dt_ + _t_ − _t_ **C** _k_ **ω** _n_  **v**


### ( )( ) kk v n ( ) t dt +  t k + 1 ( t − t k ) C b tn t ( )( ) kk ω inn  v n ( )



2



_t dt_ + _t_ − _t_ **C** _k_ **ω** _n_  **v** _n_ _t dt_



= **v** + _t_ − _t_ **ω** 



_t_ _k_ _k_ _t_ _k_ _k_



(66)



 0 − sin _L_ 0 
##### =  s T = K e C 1 T bm ( l b  ) C bn  ie  0 cos L 0 

 **p**  0 0 0 



_tt_ _k_ + 1  − _k_ **a**  + ( _t_ − _t_ _k_ ) **b**    **C** _b tn t_ ( )( ) _kk_ **v** _n_



_k_ + 1 _k_ _b t_ _k_



2



 0 − sin _L_ 0
##### (7 :9) =  s T = K e C 1 T bm ( l b  ) C bn  ie  0 cos L 0

 **p**  0 0 0


### 



_k_ + 1 _k_ _b t_ _k_



+ 1



( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ ) **b**    **C** _b tn t_ ( )( ) _kk_ **v** _n_ ( )



_t_ − _t_ _k_ **a** + _t_ − _t_ **b**   **C** _b t_ ( ) _k_ **v** _n_ _t dt_



**a** + _t_ − _t_ **b**  **C** _k_ **v**



+



 _s_ _T_ _m_ _b_ _b_
##### T = K e C 1 b ( l  ) C n 





3



 



_T_ _m_ _b_

1 _b_ **l** 
##### ( )



_T_ _m_ _b_ _b_
##### k (7 :9) = T = K e C 1 b ( l  ) C n  ie



_t_ _k_ 2 _k_



**M** _k_ (7 :9) =  **p** _T_ = _K_ **e C** 1 _b_ **l**  **C**



2



+ 1



( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ ) 2 **b**    **C** _b tn t_ ( )( ) _kk_ **ω** _inn_  **v** _n_ ( )



_t_ − _t_ _k_ **a** + _t_ − _t_ 2 **b**   **C** _b t_ ( ) _k_ **ω** _n_  **v** _n_ _t dt_



**a** + _t_ − _t_ **b**  **C** _k_ **ω** _n_  **v**



2



+



(54)



2
### −  tt kk + 1  ( t − 2 t k ) a  + ( t − t k ) b    C b tn t ( )( ) kk v n ( )


3
### −  tt kk + 1  ( t − 2 t k ) a  + ( t − t k ) 2 b    C b tn t ( )( ) kk ω inn 


### 



_tt_ _k_ + 1  − _k_ **a**  + ( _t_ − _t_ _k_ ) 2 **b**    **C** _b tn t_ ( )( ) _kk_ **ω** _inn_  **v** _n_



 



_t_ _k_ 2 _k_


15



Suppose the velocity in  _t t_ _k_, + _k_ 1  changes linearly, i.e.,

**v** _n_ ( ) _t_ = **v** _n_ ( ) _t_ _k_ + _t_ − _t_ _k_ ( **v** _n_ ( _t_ _k_ +1 ) − **v** _n_ ( ) _t_ _k_ ) (67)
_T_


The integrations in (66) are further approximated as



_T_  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_ − _T_ 3  **θ** +  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_



_t_ _k_ + 1 _b_ _n_ _b_ _b_
_t_ **C** _n_ ( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_  **l**



_t_ _k_ + 1 _b_ _n_ _b_
###  t C n ( ) t v ( ) t + ω eb ( ) t  l



_k_ +



+ 1



_n_ _b_

( ) _t_ **v** ( ) _t_ + **ω** _eb_ ( ) _t_



_t_ **v** _n_ _t_ + **ω** _t_  **l** _dt_



+



+ **ω** _t_ 



_k_



_T_ _b t_ ( _k_ ) _n_ _n_

**C** **v** _t_ + **v** _t_



**C** _k_ **v** _n_ _t_ + **v** _n_ _t_ +  **θ** +  **θ**  **l**



 **C** _k_ **v** _n_ _t_ + **v** _n_ _t_ +  **θ** +  **θ** 



2



_b tn t_ ( _k_ ) ( **v** _n_ ( _t_ _k_ +1 ) + **v** _n_ ( ) _t_ _k_ ) ( +  **θ** 1 +  **θ** 2 )  **l** _b_



_b t_ ( _k_ ) _n_ _n_
_n t_ ( _k_ ) ( **v** ( _t_ _k_ +1 ) + **v** ( ) _t_ _k_ ) ( +  **θ** 1 +  **θ** 2 )



_k_


_k_



+1 _k_ 1 2



+



_t_ _k_ + 1 _b t_ ( ) _b t_ ( _k_ ) _n t_ ( _k_ ) _n_
_t_ **C** _b t_ ( _k_ ) **C** _n t_ ( _k_ ) **C** _n t_ ( ) **v**



_t_ _k_ + 1 _b t_ ( ) _b t_ ( _k_ ) _n t_ ( _k_ )
###  t C b t ( k ) C n t ( k ) C n t ( ) v



_n t_ ( _k_ ) _n_
_n t_ ( ) **v** ( )



_b t_ ( _k_ )
_n t_ ( _k_ )



_k_ + 1 _b t_ _b t_ _k_ _n t_ _k_



_t dt_



1 _n t_ _k_ 1 2 _n t_ _k_ + 1



+ 1



( )
( _k_ )



+



−  **θ**  **C** _k_ **v** _n_ _t_ − 3  **θ** +  **θ** 



3  **θ** 1  **C** _n t_ ( _kk_ ) **v** _n_ ( ) _t_ _k_ − 6 ( 3



**θ**  **C** _k_ **v** _n_ _t_ − 3  **θ** +  **θ**  **C** _k_ **v**



_b tn t_ ( _k_ ) **v** _n_ ( ) _t_ _k_ − ( 3  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( _k_ ) **v** _n_ ( _t_ _k_



(( _kk_ )) **v** _n_ ( ) _t_ _k_ − ( 3  **θ** 1 +  **θ** 2 )  **C** _b tn t_ (( _kk_ )) **v** _n_ ( _t_ _k_ + 1 )



_kk_ ) **v** ( ) _t_ _k_ − ( 3  **θ** 1 +  **θ** 2 )  **C** _n t_ ( _kk_



_k_ _k_
_k_



1 2



(( _kk_ )) **l** _b_ − ( 5  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( )( ) _kk_



( 5

6



2



_T_ **C** _b t_ ( _k_ ) **v** _n_ _t_ + **v** _n_ _t_ + _T_ **C** _b t_ ( ) _k_ **ω** _n_  **v** _n_ _t_



( _k_ )
( _k_ )


##### (( kk )) ( v n ( t k +1 ) + v n ( ) t k ) + C b tn t ( )( kk ) ω inn  v n ( ) t k



− _T_ **C** _k_ **ω** _n_  **C** _k_ **l** − 5  **θ** +  **θ**  **C** _k_ **ω** _n_ 



_T_ **C** _b t_ ( ) _k_ **ω** _n_  **C** _n t_ ( _k_ ) **l** _b_ − _T_



**C** _k_ **ω** _n_  **C** _k_ **l** − 5  **θ** +  **θ**  **C** _k_ **ω** _n_  **C** _k_ **l**



_b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( _k_ ) **l** _b_ − ( 5  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( _k_ ) **l** _b_



_b t_ ( ) _k_
_n t_ ( _k_ )



_kk_ ) **ω** _ie_  **C** _b t_ ( _kk_ ) **l** − ( 5  **θ** 1 +  **θ** 2 )  **C** _n t_ ( ) _kk_ **ω** _ie_  **C** _b t_ ( _kk_


##### b tn t ( k ) ( v n ( t k +1 ) + v n ( ) t k ) + C b tn t ( ) k ω inn  v n t k



**C** _k_ **v** _n_ _t_ + **v** _n_ _t_ + **C** _k_ **ω** _n_  **v**



_kk_ ) **v** ( _t_ _k_ +1 ) + **v** ( ) _t_ _k_ + **C** _n t_ ( _kk_



 **v** _t_ + **v** _t_ + **ω** 



+1



2 _k_ 6



2



_T_ **C** _b t_ ( _k_ ) **ω** _n_  **v** _n_ _t_ − _T_  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_



_b tn t_ (( _kk_ )) **ω** _inn_  **v** _n_ ( _t_ _k_ +1 ) −  **θ** 1  **C** _b tn t_ (( ) _kk_ ) **v** _n_ ( ) _t_ _k_



_b tn t_ ( _k_ ) **ω** _inn_  **v** _n_ ( _t_ _k_ +1 ) −  **θ** 1  **C** _b tn t_ ( _k_ ) **v** _n_ _t_ _k_



**C** _k_ **ω** _n_  **v** _n_ _t_ −  **θ**  **C** _k_ **v**



+ **C** _k_ **ω** _n_  **v** _n_ _t_ −  **θ** 



_k_ _k_



+1 1



3 _k_ 3



_k_ _k_



(72)


A PPENDIX C


The Jacobian matrix **M** has been given in (60). Therefore, _k_


**H** in (35) is derived by integrating the elements of _k_ **M** as _k_



**p** _t_ _k_  **p**



_t_ _k_ + 1 


=
###  t k 


### 



_t_ _T_



_T_ 3  **θ** +  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_



+



( 3  **θ** 1 +  **θ** 2 )  **C** _b tn t_ (( _kk_ )) **v** _n_ ( _t_ _k_ + 1 )



− 3  **θ** +  **θ** 



_b t_ _n_



_n t_ _k_



_k_


_k_



( 3

6



**θ** +  **θ**  **C** _k_ **v**



1 2 _n t_ _k_ + 1



2



_T_ 9  **θ** − **θ**  **C** _b t_ ( _k_ ) **ω** _n_  **v** _n_ _t_



( 9  **θ** 1 − **θ** 2 )  **C** _b tn t_ (( _kk_ )) **ω** _inn_  **v** _n_ ( ) _t_ _k_



− 9  **θ** − **θ**  **C** _k_ **ω** _n_ 



( 9

60



**θ** − **θ**  **C** _k_ **ω** _n_  **v**



1 2



_b tn t_ ( _k_ ) **ω** _inn_  **v** _n_ _t_ _k_



_k_


_k_



2



_T_ 7  **θ** +  3 **θ**  **C** _b t_ ( _k_ ) **ω** _n_  **v** _n_ _t_



+



( 7  **θ** 1 +  3 **θ** 2 )  **C** _b tn t_ (( _kk_ )) **ω** _inn_  **v** _n_ ( _t_ _k_ + 1 )



_t_ _k_ + 1 


=
###  t k 


###  tt



_t_ _nT_



**θ** +  3 **θ**  **C** _k_ **ω** _n_  **v**



_k_ + 1 



− 7  **θ** +  3 **θ**  **C** _k_ **ω** _n_ 



( 7  **θ** 1 3

20



_b tn t_ ( _k_ ) **ω** _inn_  **v** _n_ ( _t_ _k_



_k_



_t_



_k_ +



+ 1



1 2 _n t_ _in_ _k_ + 1



_t_ _k_ + 1 _s_

_M_ = ~~_d_~~ _t_



_k_



_k_



Similarly, the integration of (62) is approximated as



(68)


(69)



 _t_ _k_   _nT_
(73)


### = − K e C 1 T bm   tt kk + 1 C bn ( v n  ) dt + l b   tt kk + 1 C bn dt ( ω ien  ) 



_T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _t_ _k_ + 1 _b_
### e C 1 b   t C n ( v  ) dt + l   t C n dt ( ω



_T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _t_ _k_ + 1 _b_ _n_
### e C 1 b   t C n ( v  ) dt + l   t C n dt ( ω ie



_n_ _b_ _k_ + 1 _b_ _n_
### ( v  ) dt + l   C n dt ( ω ie  )



_k_ + 1 _k_ +



+ +


#### tt k + 1 ( C b tb t ( ) ( k ) C b tn t ( )( kk ) C n tn t ( ( ) k ) ω ien  C n tn t ( ) ( k ) C b tn t (( kk )) C b tb t ( ( ) k ) ) l b


### 


#### ( C b tb t ( ) ( k ) C b tn t ( )( kk ) C n tn t ( ( ) k ) ω ien  C n tn t ( ) ( k ) C b tn t (( kk )) C b tb t ( ( ) k ) )



( _k_ )
( )



( ) _k_
( _k_ )



( _k_ )
( _k_ )



_k_ + 1 _b t_ _b t_ _k_ _n t_ _k_ _n_ _n t_ _n t_ _k_ _b t_ _k_



_dt_



+ 1



**C** **C** _k_ **C** _k_ **ω** _n_  **C** **C** _k_ **C** _k_ **l**



_b t_ ( )
_b t_ ( _k_ )



+



_K_ **e C** _m_ **C** **v** _n_  _dt_ + **l**  **C** _dt_



_T_ _m_ _k_ + 1 _b_ _n_ _b_ _k_ + 1

**e C** 1 _b_ **C** _n_ **v**  _dt_ + **l** 



_k_ _k_







( )
( _k_ )



_t_ _k_ _k_ _k_ _k_ _k_



3
### =  tt kk + 1  I −  ( t − 2 t k ) a  + ( t − t k ) 2 b   

   



3



_k_ + 1 _k_



_t_ _k_ + 1  _s_ _T_ _m_ _t_ _k_ + 1 _b_
### M v =  t k  v nT d t = K e C 1 b  t k C n dt



_t_ _k_ + 1  _s_ _T_ _m_ _t_ _k_ + 1 _b_
### v =  t k  v nT d t = K e C 1 b  t k C n dt (74)



+ 1 _T_ _m_ _k_ + 1

~~_d_~~ _t_ = _K_ **e C** 1 _b_



_t_ _k_ + 1 − _k_ 2 _b t_



_k_ _k_


###  t



2



_k_ + 1 _k_ _b t_ _k_



1



**I** − **a** + _t_ − _t_ **b**  **C**



( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ ) 2 **b**    **C** _b tn t_ (( _kk_ ))



_t_ − _t_ _k_ **a** + _t_ − _t_



2



+



_t_  _k_  _n t_ ( _k_



 



_t_ _k_ 2 _k_



_t_ _k_ + 1 _s_

_M_ = ~~_d_~~ _t_



_t_



_k_ +



+ 1










+


##### ( I + ( t − t k ) ω inn  ) ( ω ien  ) ( I − ( t − t k ) ω inn  ) C b tn t (( kk ))



 0 − sin _L_ 0 
### = K e C 1 T bm ( l b  )  tt kk + 1 C bn dt  ie  00 cos0 L 00 



_L_



_k_ ) **ω** _inn_  **ω** _ien_  **I** − ( _t_ − _t_ _k_ ) **ω** _inn_  **C** _b tn t_ _k_



**I** + _t_ − _t_ **ω** _n_  **ω** _n_  **I** − _t_ − _t_ **ω** _n_  **C**



_k_


_k_



_k_



_t_ − _t_ **ω**  **ω**  **I** − _t_ − _t_



 + _t_ − _t_ **ω**  **ω**  − _t_ − _t_ **ω** 



(75)



3

 **I** +  ( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ ) 2 **b**   
  2  
   



3



( _t_ − _t_ _k_ ) **a**  + ( _t_ − _t_ _k_ )



0 − sin _L_ 0


0 cos _L_ 0


0 0 0



_k_



_t_ − _t_ _k_ **a** + _t_ − _t_ 2 **b**   **l** _b_ _dt_



_T_ _m_ _b_ _t_ _k_ + 1 _b_
### e C 1 b ( l  )  t C n dt  ie



2



_k_ +



+



+ 1



_k_ **a**  + ( _t_ − _t_ _k_ ) **b**    **l** _b_



_K_ **e C** _m_ **l**  **C** _dt_  0 cos _L_



**e C** _m_ **l**  **C**



**I** + **a** + _t_ − _t_ **b**  **l**



+  2



1



_b_
##### ( l  )


###  t







 



In view of the fact that **ω** and _ien_ **ω** are both in the order of _inn_

10 [-5] . Therefore, their multiplication can be omitted, and (69) is
approximated as


### M b =  tt kk + 1  b s T d t = − K e C 1 T bm ( l b  ) T (76)



_t_ _k_ + 1  _s_ _T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### M K =  t k  K d t = e C 1 b  t k C v n + ω eb  l dt



_t_ _k_ + 1  _s_ _T_ _m_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### =  t k  K d t = e C 1 b  t k C v n + ω eb  l dt (77)



_tt_ _k_ + 1 _s_ _T_ ~~_d_~~ _t_ = − _K_ **e C** 1 _T_ _bm_ ( **l** _b_



_k_ + 1 _k_



+ 1 _T_ _m_ _k_ + 1

~~_d_~~ _t_ = **e C** 1 _b_



In view of the fact that



**ω** and _ien_



_k_ +



+ 1



1



_b_

( **l**  )



_k_



_g_


##### tt k + 1 C b tb t ( ) ( ) k C b tn t ( )( ) kk C n tn t ( ) ( ) k ( ω ien  ) C n tn t ( ) ( ) k C b tn t ( )( ) kk C b tb t ( ) ( ) k l b


###  t k + 1 C b tb t ( ) ( ) k C b tn t ( )( ) kk C n tn t ( ) ( ) k ( ω ien  ) C n tn t ( ) ( ) k C b tn t ( )( ) kk C b tb t ( ) ( ) k l


##### ( ) ( ) k ( ω ien  ) C n tn t ( ) ( ) k



( ) _k_
( ) _k_



( ) _k_
( )



_b t_ ( ) _k_
_n t_ ( ) _k_



_k_ + 1 _b t_ _b t_ _k_ _n t_ _k_ _n_ _n t_ _n t_ _k_ _b t_ _k_



_dt_



_k_ _k_



+ 1



( )
( ) _k_



+ **C** _b t_ **C** _k_ **C** _n t_ _k_ **ω** _n_ 



_t_ _k_ _k_ _k_ _k_ _k_



2



_T_  **C** _b t_ ( ) _k_ **ω** _n_  **C** _n t_ ( ) _k_ **l** _b_ + _T_



( ) _k_
( ) _k_



( ) _k_

**l**

( ) _k_



2



( ) _k_
( ) _k_



_b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( ) _k_ **l** _b_ + **C** _b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( ) _k_ **ω** _bib_  **l** _b_



+ 1 _T_ _k_ + 1
~~_d_~~ _t_ = _K_ **e** 1 **M** 3 ( )  **D** _M_ ( ) 



( )  **D** _M_ 2 ( ) 



**C** _k_ **ω** _n_  **C** _k_ **l** + **C** _k_ **ω** _n_  **C** _k_ **ω**  **l**



( ) _kk_ **ω** _ie_  **C** _b t_ ( ) _kk_ **l** + **C** _n t_ ( ) _kk_ **ω** _ie_  **C** _b t_ _kk_



  **ω**  + **ω**  **ω** 



_k_ + 1 _k_ +



( ) _k_
( ) _k_



_k_ _k_



_T_



( 5  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( )( ) _kk_



(70)



( 5

6



**θ** +  **θ**  **C** _k_ **ω** _n_  **C** _k_ **l**



− 5  **θ** +  **θ**  **C** _k_ **ω** _n_ 



( ) _k_
( ) _k_



_t_ _k_ + 1  _s_ _T_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### M  =  t k  d t = K e 1 M 3 ( )  D M 2 ( )   t k C v n + ω eb  l dt

(78)



1 2



_b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( ) _k_ **l** _b_



( ) _kk_ **ω** _ie_  **C** _b t_ _kk_



3



_T_



( 7  **θ** 1 +  3 **θ** 2 )  **C** _b tn t_ ( )( ) _kk_



**θ** +  3 **θ**  **C** _k_ **ω** _n_  **C** _k_ **a**  **l**



( ) _k_
( ) _k_



_t_ _k_ + 1   _s_ _T_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### M  =  t k   d t = K e 1 D M 3 ( )  M 2 ( )   t k C v n + ω eb  l dt



_t_ _k_ + 1 _s_ _T_ _t_ _k_ + 1 _b_ _n_ _b_ _b_
### t d t = K e 1 D M 3 ( )  M 2 ( )   t C v n + ω eb  l



+ 1 _T_ _k_ + 1
~~_d_~~ _t_ = _K_ **e** 1 **D** _M_ ( )  **M** 2 ( ) 



3 ( )  **M** 2 ( ) 



− 7  **θ** +  3 **θ**  **C** _k_ **ω** _n_  **C** _k_ **a** 



( 7  **θ** 1 3

40



_k_ _k_



_k_ + 1 _k_ +



1 2



_b tn t_ ( ) _k_ **ω** _ien_  **C** _b tn t_ ( ) _k_ **a**   **l** _b_



_kk_ **ω** _ie_  **C** _b t_ _kk_







2



_T_



( 3  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( )( ) _kk_



**ω** _ien_  **C** _b tn t_ _k_ **b**   **l** _b_



(79)



− 3  **θ** +  **θ** 



_b t_ _k_

_n t_



_k_


_k_



( 3

6



**θ** 1 +  **θ** 2 )  **C** _b tn t_ ( )( ) _kk_ **ω** _ien_  **C** _b tn t_ ( )( ) _kk_



_k_



+ 1



_k_



1 2



The integration of the middle term in (31) is approximated as



_t_ _k_ + 1  _s_ _T_ _m_ _b_
### M l =  t k  l bT d t = K e C 1 b ( ω eb  ) T



_t_ _k_ + 1  _s_ _T_ _m_ _b_
### l =  t k  l bT d t = K e C 1 b ( ω eb  ) T (80)



_t_ _k_ + 1 _s_ _T_ _m_ _b_
##### t bT d t = K e C 1 b ( ω eb



1



_b_
##### ( ω eb  )



_k_



_t_ _k_ + 1 _b_ _b_ _b_
###  t ω ib ( ) t  l dt  ( θ 1 +  θ 2 )  l (71)



New integrations involved in computing the above elements
are computed as



_k_



+ 1



_b_

( ) _t_  **l** _dt_  ( **θ** 1 +  **θ** 2 )



1 2



_k_



Since the integration interval _T_ =0.02s or more smaller, small
terms are further omitted and the integration of (31) are finally
approximated as



_T_ _b t_ ( _k_ ) _n_ _n_

**C** **v** _t_ + **v** _t_


### tt k + 1 C bn ( v n  ) dt =  tt k + T C b tb t ( ) ( k ) C b tn t ( )( kk ) C n tn t ( ( ) k ) ( v n



_k_ + 1 _t_ _k_ +


###  tt k + 1 C bn ( v n  ) dt =  tt k + C b tb t ( ) ( k ) C b tn t ( )( kk ) C n tn t ( ( ) k ) ( v



( _k_ ) **v** _n_ 
##### ( ) ( )



( ) _k_
( _k_ )



_k_ + 1 _b_ _n_ _k_ _b t_ _b t_ _k_ _n t_ _k_



1


### ( v n  ) dt =  t k C b tb t ( ) ( k )



_dt_ = **C** **C** _k_ **C** _k_ **v** _n_  _dt_



 = **v** 



_t_ _k_ _t_ _k_ _k_ _k_



**C** _k_ **v** _n_ _t_ + **v**



 **v** _t_ + **v** _t_ 



2



_b t_ ( _k_ ) _n_ _n_
##### n t ( v ( t k +1 ) + v t k



( _k_ ) _n_ _n_
##### ( k ) ( v ( t k +1 ) + v ( ) t k )



_k_


_k_



+1



_T_  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_



(81)



_b t_ _n_



**θ**  **C** _k_ **v**



+  **θ**  **C** _k_ **v** _n_ _t_ 



_n t_ _k_


##### b tn t (( kk )) ( v n ( ) t k  )



_k_


_k_



3



1



_T_ 3  **θ** +  **θ**  **C** _b t_ ( _k_ ) **v** _n_ _t_



+


##### ( 3  θ 1 +  θ 2 )  C b tn t (( kk )) ( v n ( t k + 1 )  )



+ 3  **θ** +  **θ**  **C** _k_ **v** _n_ _t_ 



( 3

6



**θ** +  **θ**  **C** _k_ **v**



_b t_ _n_



_k_


_k_



_n t_ _k_



1 2 _n t_ _k_ + 1


### tt k + 1 C bn dt =  tt k + 1 C b tb t ( ) ( k ) C b tn t (( kk )) C n tn t ( ( ) k


###  t kk + 1 C bn dt =  t kk + 1 C b tb t ( ) ( k ) C b tn t (( kk )) C n tn t ( ( ) k ) dt

 _T_ **C** _b t_ ( _k_ ) − _T_ 5  **θ** +  **θ** 



( _k_ )
( _k_ )



_k_ + 1 _b_ _k_ + 1 _b t_ _b t_ _k_ _n t_ _k_



+ 1 _b_ _k_ + 1
=



( )
( _k_ )



_dt_ = **C** **C** _k_ **C** _k_ _dt_



_t_ _k_ _t_ _k_ _k_ _k_



( _k_ )
( )



(82)



16


[19] H. Zhao, L. Miao, H. Shao. “Adaptive Two-stage Kalman Filter for

SINS/Odometer Integrated Navigation Systems,” _Journal of Navigation_,
vol. 1, no. 2, pp. 1-20, 2016.

[20] S. Li, F. Huang, S. Qiu, C. Fan, “SINS/Odometer integrated navigation

method based on adaptive strong tracking filter,” Journal of Chinese
Inertial Technology, vol. 26 no. 2, 2018.

[21] Y. Jiang, P. Ma, and H. Baoyin, “Residual-Normalized Strong Tracking

Filter for Tracking a Noncooperative Maneuvering Spacecraft,” _Journal_
_of Guidance, Control, and Dynamics_ vol. 42 no. 10, pp. 2304-2309, 2019.

[22] M. Brossard and S. Bonnabel, "Learning Wheel Odometry and IMU

Errors for Localization," _2019 International Conference on Robotics and_
_Automation (ICRA)_, Montreal, QC, Canada, 2019, pp. 291-297.

[23] J. Hidalgo-Carrió, D. Hennes, J. Schwendner and F. Kirchner, "Gaussian

process estimation of odometry errors for localization and mapping,"
_2017 IEEE International Conference on Robotics and Automation (ICRA)_,
Singapore, 2017, pp. 5696-5701.

[24] J. Borenstein and Liqiang Feng, "Measurement and correction of

systematic odometry errors in mobile robots," in IEEE Transactions on
Robotics and Automation, vol. 12, no. 6, pp. 869-880, December. 1996.

[25] Y. Bar-Shalom, T. Kirubarajan, X. Li “Estimation with Applications to

Tracking and Navigation.” John Wiley & Sons, Inc. New York, NY, USA,
2002, pp. 441-477.

[26] D. T. Magill, “ Optimal Adaptive Estimation of Sampled Stochastic


Processes, ” IEEE Transactions on Automatic Control, vol. 10, no. 4, pp.

434 – 439, 1965.

[27] Y. Bar-Shalom, K. C. Chang and H. A. P. Blom, "Tracking a maneuvering

target using input estimation versus the interacting multiple model
algorithm," in _IEEE Transactions on Aerospace and Electronic Systems_,
vol. 25, no. 2, pp. 296-300, March 1989.

[28] T. Kobayashi and D. L, Simon, “Application of a bank of Kalman filters

for aircraft engine fault diagnostics,” ASME Turbo Expo 2003, collocated
with the 2003 International Joint Power Generation Conference,
American Society of Mechanical Engineers, pp. 461–470, 2003.

[29] Q. Lam and J. L., Crassidis, “Evaluation of a Multiple Model Adaptive

Estimation for Space Vehicle’s Enhanced Navigation Solution,” AIAA
Guidance, Navigation, and Control Conference, Hitlon Head, SC, Aug.
2007, AIAA-02-6816.

[30] Y. Wu, M. Wu, X. Hu, D. Hu. “Self-Calibration for Land Navigation

Using Inertial Sensors and Odometer: Observability Analysis,” in _AIAA_
_Guidance, Navigation, and Control Conference_, Chicago, Illinois, 10-13,
August, 2009

[31] Y. Wu, C. Goodall, N. El-sheimy, “Self-calibration for IMU/Odometer

Land Navigation: Simulation and Test Results,” in _Proceedings of the_
_ION International Technical Meeting_, San Diego, CA, USA, 25–27
January 2010.

[32] Groves, Paul, “Principles of GNSS, Inertial, and Multisensor Integrated

Navigation Systems,” 2nd ed, Artech House, 2013, ch. 14, pp. 584–590.

[33] A. I. Mourikis, S. I. Roumeliotis and J. W. Burdick, "SC-KF Mobile

Robot Localization: A Stochastic Cloning Kalman Filter for Processing
Relative-State Measurements," in IEEE Transactions on Robotics, vol. 23,
no. 4, pp. 717-730, Aug. 2007.

[34] K. J. Wu, C. X. Guo, G. Georgiou and S. I. Roumeliotis, "VINS on

wheels," _2017 IEEE International Conference on Robotics and_
_Automation (ICRA)_, Singapore, 2017, pp. 5155-5162.

[35] Safran Electronics & Defense Coperation. “Land Inertial Navigation

Systems: Highly reliable navigation and precision strikes under any
conditions,” Available: https://www.safran-electronicsdefense.com/file/download/brochure_land_inertial-2018_0.pdf.

[36] John L. Crassidis and John L. Junkins, “Optimal Estimation of Dynamic

Systems,” 2nd ed, CRC Press, Boca Raton, Florida, 2012, pp. 249-252.

[37] H. Musoff and P. Zarchan, “Fundamentals of Kalman Filtering: A

Practical Approach,” 4th ed, Published by American Institute of
Aeronautics and Astronautics, Inc, Reston, Virginia, USA, 2015, pp. 777815.

[38] Y. Wu and X. Pan, "Velocity/Position Integration Formula Part I:

Application to In-Flight Coarse Alignment," in _IEEE Transactions on_
_Aerospace and Electronic Systems_, vol. 49, no. 2, pp. 1006-1023, April
2013.



_T_ **C** _b t_ ( _k_ ) − _T_



(( _kk_ )) − ( 5  **θ** 1 +  **θ** 2 )  **C** _b tn t_ (( _kk_ ))



_b tn t_ ( _k_ ) − ( 5  **θ** 1 +  **θ** 2 )  **C** _b tn t_ ( _k_



**C** _k_ − 5  **θ** +  **θ**  **C**



( 5  **θ** 1 +  **θ** 2

6



_kk_ ) − ( 5  **θ** 1 +  **θ** 2 )  **C** _n t_ ( _kk_



Therefore,



_T_



**H** _k_ =  _M_ , _M_ **v**, _M_ **p**, _M_ **b**, **0** 1 3 , _M_ _K_, _M_ , _M_ , _M_ **l**  (83)



, **v**,, **b**, 1 3 , _K_,, ,



R EFERENCES


[1] G. Dissanayake, S. Sukkarieh, E. Nebot and H. Durrant-Whyte, "The
aiding of a low-cost strapdown inertial measurement unit using vehicle
model constraints for land vehicle applications," in _IEEE Transactions on_
_Robotics and Automation_, vol. 17, no. 5, pp. 731-747, October. 2001.

[2] L. Chang, H. He and F. Qin, "In-Motion Initial Alignment for OdometerAided Strapdown Inertial Navigation System Based on Attitude
Estimation," in _IEEE Sensors Journal_, vol. 17, no. 3, pp. 766-773, 1,
February. 2017.

[3] J. Gao, K. Li and Y. Chen, "Study on Integration of FOG Single-Axis
Rotational INS and Odometer for Land Vehicle," in _IEEE Sensors Journal_,
vol. 18, no. 2, pp. 752-763, 15 Jan.15, 2018.

[4] S. Hao, S. Wang, R. Malekian, B. Zhang, W. Liu and Z. Li, "A Geometry
Surveying Model and Instrument of a Scraper Conveyor in Unmanned
Longwall Mining Faces," in _IEEE Access_, vol. 5, pp. 4095-4103, 2017.

[5] J. Georgy, T. Karamat, U. Iqbal and A. Noureldin, “Enhanced MEMSIMU/odometer/GPS integration using mixture particle filter,” _GPS Solut,_
vol. 15, pp. 239-252, 2011.

[6] S. Wang, B. Zhang, S. Wang and S. Ge, "Dynamic Precise Positioning
Method of Shearer Based on Closing Path Optimal Estimation Model," in
_IEEE Transactions on Automation Science and Engineering_, vol. 16, no.
3, pp. 1468-1475, July 2019.

[7] Q. Chen, Q. Zhang, X. Niu and Y. Wang, "Positioning Accuracy of a
Pipeline Surveying System Based on MEMS IMU and Odometer: Case
Study," in _IEEE Access_, vol. 7, pp. 104453-104461, 2019.

[8] Q. Fu, Y. Liu, Z. Liu, S. Li and B. Guan, "High-Accuracy SINS/LDV
Integration for Long-Distance Land Navigation," in _IEEE/ASME_
_Transactions on Mechatronics_, vol. 23, no. 6, pp. 2952-2962, Dec. 2018.

[9] M. Wang, W. Wu, X. He, Y. Li and X. Pan, "Consistent ST-EKF for Long
Distance Land Vehicle Navigation Based on SINS/OD Integration," in
_IEEE Transactions on Vehicular Technology_, vol. 68, no. 11, pp. 1052510534, Nov. 2019.

[10] Q. Wang, M. Fu, Z. Deng and H. Ma, "A comparison of loosely-coupled

mode and tightly-coupled mode for INS/VMS," at _American Control_
_Conference_, Montreal, QC, pp. 6346-6351, 2012.

[11] J. Zhou, X. Nie, J. Lin, “A novel laser Doppler velocimeter and its

integrated navigation system with strapdown inertial navigation,” _Optics_
_& Laser Technology_, vol. 64, pp 319-323, 2014.

[12] C. Gao, Q. Wang, G. Wei and X. Long, "A Highly Accurate Calibration

Method for Terrestrial Laser Doppler Velocimeter," in _IEEE Transactions_
_on Instrumentation and Measurement_, vol. 66, no. 8, pp. 1994-2003,
August 2017.

[13] Y. Wu, “Versatile land navigation using inertial sensors and odometry:

Self-calibration, in-motion alignment and positioning,” in _Proc. Inertial_
_Sensors Syst.-Symp_ . _Gyro Technol._ (ISS-SGT), pp. 1-19, Karlsruhe,
Germany, 16-17, September. 2014.

[14] L. Jetto, S. Longhi and G. Venturini, "Development and experimental

validation of an adaptive extended Kalman filter for the localization of
mobile robots," in _IEEE Transactions on Robotics and Automation_, vol.
15, no. 2, pp. 219-229, April 1999.

[15] A. H. Mohamed K. P. Schwarz, "Adaptive Kalman filtering for

INS/GPS," _J. Geodesy_, vol. 73 no. 4 pp. 193-203 1999.

[16] Y. Wang, S. Sun, and L. Li, “Adaptively Robust Unscented Kalman Filter

for Tracking a Maneuvering Vehicle,” _Journal of Guidance, Control, and_
_Dynamics_, vol. 37, no. 5, pp. 1696–1701, 2014.

[17] Y. Yang, H. He, G. Xu, “Adaptively robust filtering for kinematic

geodetic positioning,” _Journal of Geodesy_, vol. 75, pp. 109–116, 2001.

[18] D. Zhou P. M. Frank, "Strong tracking Kalman filtering of varying time
varying stochastic systems with coloured noise: Application to parameter
estimation and empirical robustness analysis," _Int. J. Control_ vol. 65 no.
2, pp. 295-307, 1996.


