# LiBeamsNet: AUV Velocity Vector Estimation in Situations of Limited DVL Beam Measurements

Nadav Cohen _[∗]_ and Itzik Klein

_The Hatter Department of Marine Technologies_
_Charney School of Marine Sciences, University of Haifa_
Haifa, Israel



_**Abstract**_ **—Autonomous underwater vehicles (AUVs) are em-**
**ployed for marine applications and can operate in deep under-**
**water environments beyond human reach. A standard solution**
**for the autonomous navigation problem can be obtained by**
**fusing the inertial navigation system and the Doppler velocity**
**log sensor (DVL). The latter measures four beam velocities to**
**estimate the vehicle’s velocity vector. In real-world scenarios,**
**the DVL may receive less than three beam velocities if the**
**AUV operates in complex underwater environments. In such**
**conditions, the vehicle’s velocity vector could not be estimated**
**leading to a navigation solution drift and in some situations**
**the AUV is required to abort the mission and return to the**
**surface. To circumvent such a situation, in this paper we propose**
**a deep learning framework, LiBeamsNet, that utilizes the inertial**
**data and the partial beam velocities to regress the missing**
**beams in two missing beams scenarios. Once all the beams are**
**obtained, the vehicle’s velocity vector can be estimated. The**
**approach performance was validated by sea experiments in the**
**Mediterranean Sea. The results show up to 7.2 % speed error**
**in the vehicle’s velocity vector estimation in a scenario that**
**otherwise could not provide an estimate.**
_**Index Terms**_ **—Autonomous underwater vehicle (AUV), Inertial**
**navigation system (INS), Doppler velocity log (DVL), Deep**
**Learning**


I. I NTRODUCTION


The primary purpose of the autonomous underwater vehicle
(AUV) is to perform scientific tasks in the great depths of the
ocean. In order to do so, the AUV has to operate autonomously
in the underwater environment. Thus, it contains several sensors collecting data to enable autonomous navigation [1].
The inertial navigation system (INS) provides the navigation
solution utilizing inertial measurements from its three-axis
accelerometer and a three-axis gyroscope; providing the specific force and angular velocity vectors, respectively [2], [3].
The navigation solution gives the AUV’s position, velocity,
and orientation. Although this information is sufficient for autonomous navigation, the INS cannot be used as a standalone
solution due to its nature to accumulate error over time [4],

[5]. To that end, a Doppler velocity log (DVL) is typically
used in the AUV to overcome this problem.
The DVL is based on the Doppler effect, while the bottomlock refers to a situation where four beams are transacted to

the seafloor and reflected back to the sensor. The DVL can
achieve a typical velocity measurement accuracy of 0.2% of


_∗_ Corresponding author: N. Cohen (email: ncohe140@campus.haifa.ac.il).



the current velocity and is, therefore, considered an accurate
sensor [6]. In most situations, an accurate navigation solution
can be obtained by performing a fusion between the INS and
the DVL for error accumulation avoidance [7]–[9]. However,
if the process noise covariance of the filter is not determined
properly, the navigation solution may drift. To circumvent
such situations both model and learning adaptive filter solution
exists in the literature [10], [11]. As the DVL is the aiding
sensor to the navigation solution, it is crucial to obtain continuous DVL data flow. However, in real-world scenarios, the
DVL may receive only partial beam measurements in different
situations. These situations include sea creatures blocking the
acoustics beams, trenches on the seafloor, and extreme pitch
and roll maneuvers (such as diving) [12], [13]. The minimum
amount of measured beams for obtaining an AUV velocity
estimate is three. If there are fewer, an AUV velocity vector
cannot be derived, which results in an error accumulation of
the navigation solution. Usually, in this situation, the AUV
will abort the mission and will be forced to surface.

To cope with such situations, several solutions were suggested
in the literature. In [14] additional data and the current partial
beams measurements were employed to create virtual beams
enabling the estimation of the AUV velocity. In [15], the
partial beams were used directly in the INS/DVL sensor fusion
in a tightly coupled (TC) approach. Furthermore, a data-driven
method was used to compensate for a situation of one missing
beam using past DVL measurements and Long short-term
memory (LSTM) model and outperformed the model-based
approach [16]. Recently, the INS/DVL performance using a
tightly coupled approach in situations of partial DVL beam
measurement, was improved using a learning virtual beam
aided solution [17].
In situations of complete DVL measurement, we proposed
a deep learning approach, named BeamsNet, to estimate the
AUV velocity vector and replace the model-based approach

[18]. We demonstrated our approach’s ability to outperform
the model-based approach using a dataset collected from
sea experiments made with an AUV. Leveraging from that
work, in this paper, a deep learning approach, LiBeamsNet
(LImited Beams NETwork), is proposed to compensate for
a situation of two missing DVL beams. Our network uses
inertial readings and the current partial beams as input and
provides the two missing beams. Once all the beams are


obtained, they can be used to estimate the AUV velocity
vector, which otherwise would not be available. To evaluate
the suggested approach performance, sea experiments were
conducted in the Mediterranean Sea with the University of
Haifa’s Snapir AUV. Approximately four and a half hours
of recorded accelerometers, gyroscopes, and DVL data was
collected and used to train, validate, and test the network.
The rest of the paper is organized as follows: Section II
describes the DVL equations and error models. Section III
introduces the proposed approach for compensating for the
missing beams and the network architecture. In Section IV,
an analysis of the results is shown, and the conclusions are
discussed in Section V.


II. DVL V ELOCITY C ALCULATIONS


The purpose of the DVL sensor is to supply the AUV
velocity vector. To do so, the DVL transmits four acoustic
beams in different directions to the seafloor, and once they are
reflected back to the sensor, the beam velocity is obtained due
to the frequency shift. The DVL’s transducers are commonly
configured in a ‘ _×_ ’ shape configuration, known in the literature
as the ”Janus Doppler configuration” [19], as shown in Figure
1.


Fig. 1. DVL transmits acoustic beams in the ”Janus Doppler configuration”.


The beam velocity measurements are the AUV velocity vector
projected to the DVL’s transactors’ direction. Therefore, by
looking at the geometry of the problem, the direction of each
beam in the DVL’s body frame can be expressed as [15]:


_**b**_ _ı_ ˙ = �cos _ψ_ _ı_ ˙ sin _θ_ sin _ψ_ _ı_ ˙ sin _θ_ cos _θ_ [�] 1 _×_ 3 (1)


where ˙ _ı_ = 1 _,_ 2 _,_ 3 _,_ 4 represents the beam number and _ψ_ and _θ_
are the heading and pitch angles relative to the body frame,
respectively [14]. The pitch angle is fixed, and the heading
angle can be expressed by [16]:



hence, the relation between the AUV velocity in body frame,
_**v**_ _[b]_ _b_ [, to the beam velocity measurements,] _**[ υ]**_ _[beam]_ [, can be written,]
using the transformation matrix **H**, as:





 4 _×_ 3



_**υ**_ _beam_ = **H** _**v**_ _[b]_ _b_ _[,]_ **H** =



_**b**_ 1

 _**b**_ 2

_**b**_ 3

 _**b**_ 4



(3)



_ψ_ _ı_ ˙ = (˙ _ı −_ 1) _·_ _[π]_



(2)
4 [[] _[rad]_ []] _[,]_ [ ˙] _[ı]_ [ = 1] _[,]_ [ 2] _[,]_ [ 3] _[,]_ [ 4]




_[π]_

2 [+] _[ π]_ 4



Due to limitations of the sensor, the DVL is subject to
errors, and therefore a beam error model is derived. As a
consequence, a bias, scale factor, and zero-mean Gaussian
processing noise are added to the beam velocity measurements
from (3), yielding


_**y**_ = **H** ( _**v**_ _[b]_ _b_ _[·]_ [ (1 +] _**[ s]**_ _[DV L]_ [)) +] _**[ b]**_ _[DV L]_ [+] _**[ n]**_ (4)


where


_•_ _**b**_ _DV L_ is the 4 _×_ 1 bias vector

_•_ _**s**_ _DV L_ is the 4 _×_ 1 scale factor vector

_•_ _**n**_ is the zero white mean Gaussian processing noise

_•_ _**y**_ is the beam velocity measurements

In order to get a good estimate of the AUV velocity vector,
the beam measurements need to be filtered and transformed.
To that end, a linear least squares (LS) filter is used:


ˆ 2
_**v**_ _[b]_ _b_ [= argmin] _||_ _**y**_ _−_ **H** _**v**_ _[b]_ _b_ _[||]_ (5)
_**v**_ _[b]_ _b_


The solution for this filter is the pseudo inverse of matrix **H**
times the beam’s velocity measurement _**y**_, and it does the two
operations. It filters the additive noise and bias and transforms
the vector from the beams coordinate frame to the AUV body
frame. The solution for this estimator ˆ _**v**_ _[b]_ _b_ [can be seen below]

_**v**_ ˆ _[b]_ _b_ [= (] **[H]** _[T]_ **[ H]** [)] _[−]_ [1] **[H]** _[T]_ _**[ y]**_ (6)


III. C OMPENSATING FOR S ITUATIONS OF L IMITED B EAM

M EASUREMENTS


At least three beam measurements are required to estimate
the AUV velocity vector using (6) [19]. That, in a cost of
accuracy, the DVL algorithm can compensate for one missing
beam. Here, we focus on the case of two missing beams.
In such scenarios the velocity solution by (6) cannot be
calculated. Specifically, we assume beams two and four are
not available, as can be seen in Figure 2. However, one can
easily adjust our approach to handle any combination of two
missing beams.
In [18],BeamsNet framework showed promising results in
situations of complete DVL measurements. Therefore, we
utilize the same network structure with several modifications
to handle missing beams scenarios and present LiBeamsNet.
To that end, instead of using all four beams as input to the
network, now only the current partial beam measurements are
required together with the inertial sensor data (specific force
and angular velocity measurements). In addition, the current
network regresses the two missing beams instead of regressing
the AUV velocity vector directly as in BeamsNet. LiBeamsNet
network architecture is presented in Figure 3. The inertial data


Fig. 2. A scenario with only two available DVL beams.


from the accelerometer and gyroscope passes through a onedimensional convolutional layer consisting of six filters of size
2 _×_ 1. By doing so, features are extracted from the data and then
flattened, combined, and passed through a dropout layer with
_p_ = 0 _._ 2. After a sequence of fully connected layers, the current
partial beam measurements are combined and moved through
the last fully connected layer that produces the 2 _×_ 1 vector,
which is the regressed missing beams. The architecture and the
activation functions after each layer are presented in figure
3. The network trained over 50 epochs, mini-batch size of
32, 0.01 learning rate, and RMSprop optimizer. Once all four


Fig. 3. LiBeamsNet network architecture.


required beams are obtained (two measured and two regressed
using LiBeamsNet), the AUV velocity calculations can be
made using the model-based approach or using BeamsNet. In
this paper, we use the model base approach. A block diagram
of our method can be seen in Figure 4.


IV. A NALYSIS AND R ESULTS


Our LiBeamsNet framework was validated using sea experiment data recorded by the ”Snapir” AUV, which is A18D, ECA GROUP mid-size AUV. ”Snapir”,presented in Figure 5, has a length of 5.5 [m], a diameter of 0.5 [m], 24



hours’ endurance, and a depth rating of 3000 [m]. ”Snapir”
is equipped with Teledyne RD Instruments, Navigator DVL

[21], and iXblue Phins Subsea IMU [22]. The train and
validation sets were created by collecting inertial data, and
DVL data from nine different missions in the Mediterranean

Sea, varied in their length, maneuvers, and depth, performed
by the AUV with a total time duration of 13,886 seconds.
Since the DVL samples were taken at 1Hz and the inertial data
at 100Hz, 13,886 and 1,388,600 measurements, respectively,
are available in the dataset. An additional dataset was created

using ”Snapir” AUV on a different day with different sea
conditions. This dataset is used as our test set to examine

the generalization of our proposed approach. It contains 2001
DVL measurements and 200,100 IMU measurements. All of
[the data can be found on https://github.com/ansfl/BeamsNet.](https://github.com/ansfl/BeamsNet)
In an ideal situation, the AUV will carry two DVL sensors.
One would be the ground truth, and the other the unit under
test. Since it was not the case, to create the unit under test
DVL data, the error model, (4) was implemented with scale
factor, bias, and STD of the zero-mean white Gaussian noise of
0.7%, 0.0001[m/s], and 0.042[m/s], respectively. Once the data
was created, only beams one and three were used to mimic a
situation of partial beam measurements. The matrices which
were chosen to evaluate the suggested framework: 1) root
mean squared error (RMSE) 2) mean absolute error (MAE)
3) the coefficient of determination ( _R_ [2] ), and 4) the variance
account for (VAF). The RMSE and MAE express the velocity
error in units of [ _m/s_ ], while the _R_ [2] and VAF are unitless.
Those matrices are defined as follows:



_N_
_R_ [2] ( _**x**_ _ı_ ˙ _,_ ˆ _**x**_ _ı_ ˙ ) = 1 _−_ � _ıN_ ˙=1 [(] _**[x]**_ _[ı]_ [˙] _[ −]_ _**[x]**_ [ˆ] _[ı]_ [˙] [)] [2] (9)

˙
~~�~~ _ı_ =1 [(] _**[x]**_ _[ı]_ [˙] _[ −]_ _**[x]**_ [¯] _[ı]_ [˙] [)] [2]

_V AF_ ( _**x**_ _ı_ ˙ _,_ ˆ _**x**_ _ı_ ˙ ) = [1 _−_ _[var]_ _var_ [(] _**[x]**_ _[ı]_ [˙] ( _[ −]_ _**x**_ _ı_ ˙ ) _**[x]**_ [ˆ] _[ı]_ [˙] [)] ] _×_ 100 (10)


where N is the number of samples, _**x**_ _ı_ ˙ is the ground truth
velocity vector norm of the DVL, ˆ _**x**_ _ı_ ˙ is the predicted velocity
vector norm of the AUV, generated after regressing the two
missing beams by the network, ¯ _**x**_ _ı_ ˙ is the mean of the ground
truth velocity vector norm of the DVL, and _var_ stands for
variance. Note that if the VAF is 100, the _R_ [2] is 1, and the
RMSE and MAE are 0, the model is considered outstanding

[23]. In addition, the mean of the ground truth velocity vector
norm was calculated to evaluate the magnitude of the speed

error.

Results for the validation and test datasets are given in Table I.
A speed average of 1 _._ 14[ _m/s_ ] and 1 _._ 34[ _m/s_ ] were computed
for the validation and test sets, respectively. These values were
used as references to the calculated errors. The results indicate

that LiBeamsNet approach performs well in regressing the
missing beams and estimating the velocity vector. Looking



_RMSE_ ( _**x**_ _ı_ ˙ _,_ ˆ _**x**_ _ı_ ˙ ) =



_N_
~~�~~ _ı_ ˙=1 [(] _**[x]**_ _[ı]_ [˙] _[ −]_ _**[x]**_ [ˆ] _[ı]_ [˙] [)] [2] (7)
� _N_



_N_
_MAE_ ( _**x**_ _ı_ ˙ _,_ ˆ _**x**_ _ı_ ˙ ) = � _ı_ ˙=1 _[|]_ _**[x]**_ _[ı]_ [˙] _[ −]_ _**[x]**_ [ˆ] _[ı]_ [˙] _[|]_ (8)

_N_


Fig. 4. A block diagram showing the flow of information in LiBeamsNet framework.


TABLE I
E STIMATED AUV SPEED RMSE, MAE, _R_ [2], AND VAF AFTER THE BEAMS
COMPENSATION USING L I B EAMS N ET ON BOTH THE VALIDATION AND

TEST SETS


|Evaluation Metrics|Validation Set|Test Set|
|---|---|---|
|RMSE [_m/s_]|0.03|0.08|
|RMSE [%]|2.5|7.2|
|MAE [_m/s_]|0.01|0.03|
|MAE [%]<br>|1.54|3.32|
|_R_~~2~~|0.99|0.98|
|VAF|99.73|99.01|



Fig. 5. ”Snapir” AUV being dropped into a mission in the Mediterranean
Sea.


at the validation set results, we can see that the RMSE and
the MAE are close to 0 and yield 2.5 % and 1.54 % speed
errors, respectively. The _R_ [2] and VAF metrics suggest that the
proposed deep learning approach has good statistical performance. Furthermore, the suggested approach was evaluated on
a test set in order to examine the network’s robustness. The

network yields 7.2 % and 3.32 % speed error with respect to
the RMSE and MAE metrics, respectively. The _R_ [2] and VAF
criteria also show good statistical performance. However, the
test set did not perform as well as the validation set, indicating
overfitting or lack of robustness.


V. C ONCLUSIONS


This paper suggested LiBeamsNet, a deep-learning approach to compensate for a case of two missing beams in the
DVL reading using inertial data. Specifically, when beams two
and four are missing, and the DVL cannot provide the AUV
velocity estimation. The network input is the current beams
and the inertial data. The network processes them through a
multi-headed 1DCNN neural network, and outputs the two
missing beams. Once they were obtained, all four beams were
plugged into the model-based approach to estimate the AUV
velocity vector that otherwise would not be available. To



evaluate the approach, sea experiments were conducted in the
Mediterranean Sea using ”Snapir” AUV on two different dates
and sea conditions to obtain both train and validation sets from

one experiment and a test set unfamiliar to the network from
the other experiment.
The results show that the suggested approach can regress the
missing beams with good accuracy, resulting in up to 7.2 %
speed error. Nevertheless, there are differences between the
validation and test sets’ performance which could indicate
overfitting and the need to train over more data.
Using our approach, the DVL can compensate for limited
beam measurements, estimate the AUV velocity, and allow it
to complete its mission. Although evaluated for one scenario
of two missing beams (beams 2 and 4), the proposed approach
can be applied for any set of two missing beams and can be
easily adjusted to handle situations of three missing beams.


A CKNOWLEDGMENTS


N.C. is supported by the Maurice Hatter Foundation.


R EFERENCES


[1] S. K. Jain, S. Mohammad, S. Bora, and M. Singh, “A review paper on:
autonomous underwater vehicle,” _International Journal of Scientific &_
_Engineering Research_, vol. 6, no. 2, p. 38, 2015.

[2] D. Titterton, J. L. Weston, and J. Weston, _Strapdown inertial navigation_
_technology_, vol. 17. IET, 2004.

[3] P. D. Groves, “Principles of GNSS, inertial, and multisensor integrated
navigation systems,” _IEEE Aerospace and Electronic Systems Magazine_,
vol. 30, no. 2, pp. 26–27, 2015.

[4] J. L. Farrell, _GNSS aided navigation & tracking: inertially augmented_
_or autonomous_ . American Literary Press Baltimore, Maryland, 2007.

[5] E.-H. Shin and N. El-Sheimy, “Accuracy improvement of low cost
INS/GPS for land applications,” in _Proceedings of the 2002 national_
_technical meeting of the institute of navigation_, pp. 146–157, 2002.

[6] D. Wang, X. Xu, Y. Yao, T. Zhang, and Y. Zhu, “A novel SINS/DVL
tightly integrated navigation method for complex environment,” _IEEE_
_Transactions on Instrumentation and Measurement_, vol. 69, no. 7,
pp. 5183–5196, 2019.

[7] Z. Yonggang, D. Yan, and L. Ning, “A tightly integrated SINS/DVL
navigation method for autonomous underwater vehicle,” in _2013 In-_
_ternational Conference on Computational and Information Sciences_,
pp. 1107–1110, IEEE, 2013.

[8] Y. Yao, X. Xu, L. Hou, K. Deng, and X. Xu, “A simple and precise
correction method for DVL measurements under the dynamic environment,” _IEEE Transactions on Vehicular Technology_, vol. 69, no. 10,
pp. 10750–10758, 2020.

[9] I. Klein and R. Diamant, “Observability analysis of DVL/PS aided INS
for a maneuvering AUV,” _Sensors_, vol. 15, no. 10, pp. 26818–26837,
2015.

[10] B. Or and I. Klein, “A Hybrid Model and Learning-Based Adaptive
Navigation Filter,” _accepted to IEEE Transactions on Instrumentation_
_and Measurement_, 2022.

[11] B. Or and I. Klein, “A Hybrid Adaptive Velocity Aided Navigation Filter
with Application to Autonomous Underwater Vehicles,” _IEEE Oceans_,
2022.

[12] R. Eliav and I. Klein, “INS/Partial DVL measurements fusion with
correlated process and measurement noise,” _Multidisciplinary Digital_
_Publishing Institute Proceedings_, vol. 4, no. 1, p. 34, 2018.

[13] I. Klein and Y. Lipman, “Continuous INS/DVL fusion in situations of
DVL outages,” in _2020 IEEE/OES Autonomous Underwater Vehicles_
_Symposium (AUV)_, pp. 1–6, IEEE, 2020.

[14] A. Tal, I. Klein, and R. Katz, “Inertial navigation system/Doppler velocity log (INS/DVL) fusion with partial DVL measurements,” _Sensors_,
vol. 17, no. 2, p. 415, 2017.

[15] P. Liu, B. Wang, Z. Deng, and M. Fu, “INS/DVL/PS tightly coupled
underwater navigation method with limited DVL measurements,” _IEEE_
_Sensors Journal_, vol. 18, no. 7, pp. 2994–3002, 2018.

[16] M. Yona and I. Klein, “Compensating for Partial Doppler Velocity
Log Outages by Using Deep-Learning Approaches,” in _2021 IEEE_
_International Symposium on Robotic and Sensors Environments (ROSE)_,
pp. 1–5, IEEE, 2021.

[17] Y. Yao, X. Xu, X. Xu, and I. Klein, “Virtual beam aided SINS/DVL
tightly coupled integration method with partial DVL measurements,”
_IEEE Transactions on Vehicular Technology_, 2022.

[18] N. Cohen and I. Klein, “BeamsNet: A data-driven approach enhancing
Doppler velocity log measurements for autonomous underwater vehicle
navigation,” _Engineering Applications of Artificial Intelligence_, vol. 114,
p. 105216, 2022.

[19] N. A. Brokloff, “Matrix algorithm for doppler sonar navigation,” in
_Proceedings of OCEANS’94_, vol. 3, pp. III–378, IEEE, 1994.

[20] B. Braginsky, A. Baruch, and H. Guterman, “Correction of DVL Error
Caused by Seafloor Gradient,” _IEEE Sensors Journal_, vol. 20, no. 19,
pp. 11652–11659, 2020.

[[21] Teledyne, “Teledyne Marine RD Instruments DVL.” Available: http://](http://www.teledynemarine.com/dvls)
[www.teledynemarine.com/dvls. Accessed: 2022-05-01.](http://www.teledynemarine.com/dvls)

[[22] iXblue, “iXblue Phins Subsea INS.” Available: https://www.ixblue.com/](https://www.ixblue.com/store/phins-subsea/)
[store/phins-subsea/. Accessed: 2022-05-01.](https://www.ixblue.com/store/phins-subsea/)

[23] D. J. Armaghani and P. G. Asteris, “A comparative study of ANN
and ANFIS models for the prediction of cement-based mortar materials
compressive strength,” _Neural Computing and Applications_, vol. 33,
no. 9, pp. 4501–4532, 2021.


